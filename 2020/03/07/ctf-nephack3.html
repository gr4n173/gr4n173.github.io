<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>CTF: Nephack 3.0 | gr4n173</title>
<meta name="generator" content="Jekyll v3.8.6" />
<meta property="og:title" content="CTF: Nephack 3.0" />
<meta name="author" content="gr4n173>" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Here I will explain one of the challenge from NepHack 3.0 CTF ." />
<meta property="og:description" content="Here I will explain one of the challenge from NepHack 3.0 CTF ." />
<link rel="canonical" href="http://localhost:4000/2020/03/07/ctf-nephack3.html" />
<meta property="og:url" content="http://localhost:4000/2020/03/07/ctf-nephack3.html" />
<meta property="og:site_name" content="gr4n173" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-03-07T00:00:00+05:45" />
<script type="application/ld+json">
{"mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/2020/03/07/ctf-nephack3.html"},"@type":"BlogPosting","url":"http://localhost:4000/2020/03/07/ctf-nephack3.html","author":{"@type":"Person","name":"gr4n173>"},"headline":"CTF: Nephack 3.0","dateModified":"2020-03-07T00:00:00+05:45","datePublished":"2020-03-07T00:00:00+05:45","description":"Here I will explain one of the challenge from NepHack 3.0 CTF .","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css">
  <link rel="icon" type="image/png" href="/public/images/blackflag.png" /><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="gr4n173" /></head>
<body><div class="site-header">
  <div class="wrapper">
    <a class="site-title" rel="author" href="/">gr4n173<b class="command_prompt"></b><b class="blinking_cursor">_</b></a>
    <span class="social_links">
        <a class="color-cyan-hover" href="https://twitter.com/"><i class="fab fa-twitter"></i></a><a class="color-red-hover" href="https://gr4n173.github.io"><i class="fab fa-itch-io"></i></a><a class="color-purple-hover" href="https://github.com/gr4n173"><i class="fab fa-github"></i></a><a class="color-blue-hover" href="https://www.facebook.com/profile.php?id=100038644863435"><i class="fab fa-facebook"></i></a><a class="color-cyan-hover" href="https://discordapp.com/users/680705408297730058"><i class="fab fa-discord"></i></a><a class="color-red-hover" href="mailto:me.gr4n173@protonmail.com"><i class="fab fa-mailchimp"></i></a><a class="color-cyan-hover" href="https://www.hackthebox.eu/home/users/profile/60443"><i class="fab fa-itch-io"></i></a>
    </span>
  </div>
</div>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <div class="author-box">

<img src="https://gravatar.com/avatar/6691d16a4bf77dcf1f54ee766349682a?s=256" class="author-avatar" />


Hi there, I am a nerd guy who loves everything in between Internet and Security . I reach out to people and teach about CyberSecurity. I like to play with electronics in my spare time so that I can automate my lifestyle . CTF | HTB | Reverse Engineering.

</div>

<div class="post">
  <h1 class="post-title">CTF: Nephack 3.0</h1>
  
  <div class="post-tags">
      
      <a class="tag" href="/tag/linux/">linux</a>
      
      <a class="tag" href="/tag/nephack3/">nephack3</a>
      
      <a class="tag" href="/tag/ctf/">ctf</a>
      
      <a class="tag" href="/tag/binaryexploitation/">binaryexploitation</a>
      
      <a class="tag" href="/tag/gdb/">gdb</a>
      
      <a class="tag" href="/tag/pwnables/">pwnables</a>
      
  </div>
  
  <div class="post-date">Published on 07 Mar 2020</div>
  
  <div class="post-description">Here I will explain one of the challenge from NepHack 3.0 CTF .</div>
  
  <h3 id="introduction">Introduction</h3>

<p>Actually NepHack is one of the Biggest Hacking Competition of Nepal after <a href="https://threatcon.io/">threatcon</a> which is especially CTF (Jeopardy type) competition which is held annually every year in K.U.( Kathmandu University), Dhulikhel, Nepal. But unfortunately this year due to some internal problem of K.U NepHack 3.0 was held in premises of <a href="https://cynicaltechnology.com/">Cynical Technology</a> .</p>

<p>Event happened at Jan 25–26,2020 but unfortunately I wasn’t able to attend due to my work . Luckily they decided to went live for 48 hours to play online(nephack.io)after 2 days of the event and I would like to thank Cynical Technology for it.</p>

<p>During that live session, I was able to secure first position but at last hour i.e. 10:00 pm I was downgraded to 2nd position by team caphilates but the score was equal. I would like to Congratulate team caphilates for winning the NepHack 3.0 online.</p>

<p><img src="/public/images/score_board.png" alt="Score_board" /></p>

<p>Here I would like to especially focus on the Pwnable challenges and talking about my background,I am active at Hack The Box( HTB) since 6 months. You can see my profile here <a href="https://www.hackthebox.eu/profile/60443">gr4n173</a>.</p>

<h3 id="pwnable-challenges">PWNABLE-»CHALLENGES</h3>

<p><img src="/public/images/challenges_pwn.png" alt="challenge" /></p>

<p>I was able to solve two challenges only: Shadow and Duffer. Among them I liked Duffer box because it was related to Buffer-overflow.</p>

<p>It was the time when our team decided to organize CTF outside the Valley. We created many challenges for CTF and event was successfully conducted you can see details here <a href="https://www.facebook.com/events/424450345158496/?active_tab=discussion">VECTORCTF(CoTS)</a>. Among them I had created one of the challenges related to bof and luckily same challenge was in NepHack 3.0 which was of 496 points named Duffer.</p>

<p><img src="/public/images/duffer.png" alt="duffer" /></p>

<p>They have given ssh.log file on</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@gr4n173:~$cat ssh.log
</code></pre></div></div>

<p>I got <code class="highlighter-rouge">ssh.log</code>. part file there I can see the ssh login attempt log file by different user . I got the credentials from one of the members <em>maskop9</em> from winning team(me0w) during live event . Credential is hacker/cynical1 with local IP <code class="highlighter-rouge">192.168.10.189</code>. Since IP given was local IP, I wasn’t able to ssh into that user so I had to figure out other ways and I noticed I had a shell from shadow challenge which was of <code class="highlighter-rouge">phindrella</code> user and I am going to publish next Writeup where I will explain how I got <code class="highlighter-rouge">phindrella</code> user and it’s shell.</p>

<p>Then, I tried with that credentials as</p>

<p><img src="/public/images/shell.png" alt="shell" /></p>

<p>Fig:-<em>Into hacker shell</em></p>

<p>I am able to login hacker shell and since I was in tty shell I had to spawn that shell so I used</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@gr4n173:~$python -c ""import pty;pty.spawn(‘/bin/bash’)"
</code></pre></div></div>

<p>As challenge have given a description about the location at /hom/pax and I got two files.</p>

<p><img src="/public/images/docker1.png" alt="docker1" /></p>

<p>Fig:- <em>hacker_shell</em></p>

<p>one is vuln executable and other is flag.txt which doesn’t have permission to read .Since vuln file is ELF file so I generally read that file with gdb but my bad organizer doesn’t have gdb installed in that shell. So first I have to download that file to my localhost for that I used scp</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@gr4n173:~$scp hacker@iZa2dh0wn9s9aolc3csaudZ:/home/pax /root/Downloads/
</code></pre></div></div>

<p>this way I was able to download to my localhost and I had given the execute permission to that file.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@gr4n173:~$chmod +x vuln
</code></pre></div></div>

<p>I had gdb install so used this command to read vuln file</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@gr4n173:~$gdb -q vuln
</code></pre></div></div>

<p><img src="/public/images/gdb_shell.png" alt="gdb" /></p>

<p>Fig:- <em>vuln run normally</em></p>

<p>nothing happened there and I entered many random text and I got <code class="highlighter-rouge">segmented fault</code>.</p>

<p><img src="/public/images/sigfault.png" alt="sigfault" /></p>

<p>Now, I had to find the offset after which <code class="highlighter-rouge">SIGSEGV</code> fault occurred. I mostly use one of my favorite method to find offset as</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@root:$ /usr/share/metasploit framework/tools/exploit/./pattern_create.rb -l 100
Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2A

root@root:$ /usr/share/metasploit-framework/tools/exploit/./pattern_offset.rb -q 0x0000555555554830
[*] Exact match at offset 40
This way I got the offset. Then, I had to find the function where flag is located. For that I searched every functions and got this
</code></pre></div></div>

<p><img src="/public/images/function_shell.png" alt="function" /></p>

<p>fig:-<em>Functions names</em></p>

<p>there I got <code class="highlighter-rouge">fLog()</code> function as noticeable and had to find the address of this function as</p>

<p><img src="/public/images/address_log.png" alt="address" /></p>

<p>Fig:- <em>Address of fLog</em></p>

<p>Since that is the address before running the file and after running I got this</p>

<p><img src="/public/images/fLog_function.png" alt="address" /></p>

<p>Fig:-<em>Address of fLog after running file</em></p>

<p>Since all the address should be used in <code class="highlighter-rouge">Little Endian</code> format. There is small story about <code class="highlighter-rouge">Little Endian</code> if you are interested you can read from <a href="https://www.ling.upenn.edu/courses/Spring_2003/ling538/Lecnotes/ADfn1.htm">here</a></p>

<p>Address is <code class="highlighter-rouge">0x8a4755555555</code> in Little Endian format and</p>

<blockquote>
  <p>offset = 40</p>

  <p>address to call = 8a4755555555</p>
</blockquote>

<p>So my final payload was:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@gr4n173:~$python -c “print(‘A’*40 + ‘\x8a\x47\x55\x55\x55\x55’)” | ./vuln
</code></pre></div></div>

<p><img src="/public/images/final_one.png" alt="flag" /></p>

<p>Fig:- <em>Flag</em></p>

<p>This way I got the flag as <code class="highlighter-rouge">cynical_flag{hacker_kto_mah}</code> and got 495 points.</p>

<p>I wanted to thank all readers for being with me through my post and I will be posting other walkthrough of NepHack 3.0 challenges soon.
At last, I would like to acknowledge brother <a href="https://twitter.com/maskop9">@maskop9</a> for helping through out the competition and other helping hands along with the organizer Cynical Technology for awesome platform seems like they too have bugbounty platform as bugv.io :)</p>


</div>


<div class="comments">
<div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'gr4n173'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>


</div>




<div class="related">
  <h2>related posts</h2>
  <ul class="related-posts">
    
      <li>
        <h3>
          <a href="/2020/04/07/virseccon-ctf-steganography.html">
           VirSecCon CTF: Steganography Challenges
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/2020/04/06/virseccon.html">
          CTF: VirSecCon2020
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/2020/04/04/htb-registry.html">
          Hack The Box: Registry
          </a>
        </h3>
      </li>
    
  </ul>
</div>




  
  <h2>all tags</h2>
  <div class="tag-cloud"><a href="/tag/.chm/" class="set-1">.chm</a> <a href="/tag/invoke/" class="set-1">Invoke</a> <a href="/tag/powershell/" class="set-1">Powershell</a> <a href="/tag/re/" class="set-1">RE</a> <a href="/tag/smb/" class="set-1">SMB</a> <a href="/tag/vscctf/" class="set-2">VSCCTF</a> <a href="/tag/virseccon/" class="set-2">VirSecCon</a> <a href="/tag/binaryexploitation/" class="set-1">binaryexploitation</a> <a href="/tag/boltcms/" class="set-1">boltcms</a> <a href="/tag/csrftorce/" class="set-1">csrftorce</a> <a href="/tag/ctf/" class="set-4">ctf</a> <a href="/tag/ffuf/" class="set-1">ffuf</a> <a href="/tag/ftp/" class="set-2">ftp</a> <a href="/tag/fuzz/" class="set-1">fuzz</a> <a href="/tag/gdb/" class="set-1">gdb</a> <a href="/tag/htb/" class="set-5">htb</a> <a href="/tag/introduction/" class="set-1">introduction</a> <a href="/tag/ipv6/" class="set-1">ipv6</a> <a href="/tag/linux/" class="set-4">linux</a> <a href="/tag/linxu/" class="set-1">linxu</a> <a href="/tag/lkm/" class="set-1">lkm</a> <a href="/tag/nc.exe/" class="set-1">nc.exe</a> <a href="/tag/nephack3/" class="set-1">nephack3</a> <a href="/tag/nishang/" class="set-1">nishang</a> <a href="/tag/oauth2/" class="set-1">oauth2</a> <a href="/tag/pcap/" class="set-1">pcap</a> <a href="/tag/port-forward/" class="set-1">port-forward</a> <a href="/tag/postgres/" class="set-1">postgres</a> <a href="/tag/pwnables/" class="set-1">pwnables</a> <a href="/tag/rce/" class="set-1">rce</a> <a href="/tag/restic-server/" class="set-1">restic-server</a> <a href="/tag/rsync/" class="set-1">rsync</a> <a href="/tag/server/" class="set-1">server</a> <a href="/tag/sqli/" class="set-2">sqli</a> <a href="/tag/steganography/" class="set-1">steganography</a> <a href="/tag/webshell/" class="set-1">webshell</a> <a href="/tag/welcome/" class="set-1">welcome</a> <a href="/tag/whois/" class="set-1">whois</a> <a href="/tag/windows/" class="set-1">windows</a></div>
  




      </div>
    </main><footer class="site-footer">
  <div class="wrapper">
	  <center><script src="https://www.hackthebox.eu/badge/60443"></script> </center><div class="toggleWrapper">
    <input type="checkbox" class="dn" id="theme-toggle" onclick="modeSwitcher()" checked />
    <label for="theme-toggle" class="toggle">
    <span class="toggle__handler">
      <span class="crater crater--1"></span>
      <span class="crater crater--2"></span>
      <span class="crater crater--3"></span>
    </span>
        <span class="star star--1"></span>
        <span class="star star--2"></span>
        <span class="star star--3"></span>
        <span class="star star--4"></span>
        <span class="star star--5"></span>
        <span class="star star--6"></span>
    </label>
</div>
<script type="text/javascript">
const theme = localStorage.getItem('theme');
if (theme === 'undefined') {
   theme = "dark";
}
if (theme === "dark") {
	document.documentElement.setAttribute('data-theme', 'dark');
} else {
    document.documentElement.setAttribute('data-theme', 'light');
}
const userPrefers = getComputedStyle(document.documentElement).getPropertyValue('content');

function activateDarkTheme() {
    document.getElementById('theme-toggle').checked = true;
    document.documentElement.setAttribute('data-theme', 'dark');
    document.documentElement.classList.add('theme--dark');
    document.documentElement.classList.remove('theme--light');
	document.getElementById("theme-toggle").className = 'light';
	window.localStorage.setItem('theme', 'dark');
}

function activateLightTheme() {
    document.getElementById('theme-toggle').checked = false;
    document.documentElement.setAttribute('data-theme', 'light');
    document.documentElement.classList.add('theme--light');
    document.documentElement.classList.remove('theme--dark');
	document.getElementById("theme-toggle").className = 'dark';
	window.localStorage.setItem('theme', 'light');
}

if (theme === "dark") {
    activateDarkTheme();
} else if (theme === "light") {
    activateLightTheme();
} else if  (userPrefers === "light") {
    activateDarkTheme();
} else {
    activateDarkTheme();
}

function modeSwitcher() {
	let currentMode = document.documentElement.getAttribute('data-theme');
	if (currentMode === "dark") {
	    activateLightTheme();
	} else {
	    activateDarkTheme();
	}
}
</script></div>
  </div>
</footer>


<script>
      window.FontAwesomeConfig = {
        searchPseudoElements: true
      }
    </script>
  </body>

</html>
