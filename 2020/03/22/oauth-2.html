<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>OAuth 2 | gr4n173</title>
<meta name="generator" content="Jekyll v3.8.6" />
<meta property="og:title" content="OAuth 2" />
<meta name="author" content="gr4n173>" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Here I will explain detail about the OAuth 2 ." />
<meta property="og:description" content="Here I will explain detail about the OAuth 2 ." />
<link rel="canonical" href="http://localhost:4000/2020/03/22/oauth-2.html" />
<meta property="og:url" content="http://localhost:4000/2020/03/22/oauth-2.html" />
<meta property="og:site_name" content="gr4n173" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-03-22T00:00:00+05:45" />
<script type="application/ld+json">
{"mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/2020/03/22/oauth-2.html"},"@type":"BlogPosting","url":"http://localhost:4000/2020/03/22/oauth-2.html","author":{"@type":"Person","name":"gr4n173>"},"headline":"OAuth 2","dateModified":"2020-03-22T00:00:00+05:45","datePublished":"2020-03-22T00:00:00+05:45","description":"Here I will explain detail about the OAuth 2 .","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css">
  <link rel="icon" type="image/png" href="/public/images/blackflag.png" /><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="gr4n173" /></head>
<body><div class="site-header">
  <div class="wrapper">
    <a class="site-title" rel="author" href="/">gr4n173<b class="command_prompt"></b><b class="blinking_cursor">_</b></a>
    <span class="social_links">
        <a class="color-cyan-hover" href="https://twitter.com/"><i class="fab fa-twitter"></i></a><a class="color-red-hover" href="https://gr4n173.github.io"><i class="fab fa-itch-io"></i></a><a class="color-purple-hover" href="https://github.com/gr4n173"><i class="fab fa-github"></i></a><a class="color-blue-hover" href="https://www.facebook.com/profile.php?id=100038644863435"><i class="fab fa-facebook"></i></a><a class="color-cyan-hover" href="https://discordapp.com/users/680705408297730058"><i class="fab fa-discord"></i></a><a class="color-red-hover" href="mailto:me.gr4n173@protonmail.com"><i class="fab fa-mailchimp"></i></a>
    </span>
  </div>
</div>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <div class="author-box">

<img src="https://gravatar.com/avatar/6691d16a4bf77dcf1f54ee766349682a?s=256" class="author-avatar" />


Hi there, I am a nerd guy who loves everything in between Internet and Security . I reach out to people and teach about CyberSecurity. I like to play with electronics in my spare time so that I can automate my lifestyle . CTF | HTB | Reverse Engineering.

</div>

<div class="post">
  <h1 class="post-title">OAuth 2</h1>
  
  <div class="post-tags">
      
      <a class="tag" href="/tag/oauth2/">oauth2</a>
      
      <a class="tag" href="/tag/server/">server</a>
      
  </div>
  
  <div class="post-date">Published on 22 Mar 2020</div>
  
  <div class="post-description">Here I will explain detail about the OAuth 2 .</div>
  
  <hr />

<h3 id="introduction">Introduction</h3>

<p>OAuth 2 is an authorization framework that enables applications to obtain limited access to user accounts on HTTP Service like Google, Facebook, GitHub etc. In other sense, it is a protocol that allow a user to grant the access to their resources on one site, to another site without having to expose their credentials.</p>

<p>Let’s dive deep into OAuth 2 with the actual work flow involved in it. Basically there are four roles involved in it.</p>

<p><strong>OAuth 2 Roles:-</strong></p>

<ul>
  <li>Resource Owner</li>
  <li>Client</li>
  <li>Resource Server</li>
  <li>Authorization Server</li>
</ul>

<p><strong>Resource Owner: User</strong></p>

<p>An entity capable of granting the access to the protected resources. It is actually a <em>user</em> who authorize the access to their <em>application</em>. Typically this is an end-user.</p>

<p><strong>Client: Application</strong></p>

<p>An client is the <em>application</em> which wants to access the user’s account. To access the protected account it must be authorized by user and authorization must be valid with the Authorization server i.e API .</p>

<p><strong>Resource/Authorization Server: API</strong></p>

<p>Resource Server is hosting the protected resources of certain user where as Authorization Server verify the identity of <em>user</em> and providing the access_token to the <em>application</em> for authorization.</p>

<h3 id="workflow-of-oauth-2">Workflow of OAuth 2</h3>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> +--------+                               +---------------+
 |        |--(1)- Authorization Request -&gt;|   Resource    |
 |        |                               |     Owner     |
 |        |&lt;-(2)-- Authorization Grant ---|               |
 |        |                               +---------------+
 |        |
 |        |                               +---------------+
 |        |--(3)-- Authorization Grant --&gt;| Authorization |
 | Client |                               |     Server    |
 |        |&lt;-(4)----- Access Token -------|               |
 |        |                               +---------------+
 |        |
 |        |                               +---------------+
 |        |--(5)----- Access Token ------&gt;|    Resource   |
 |        |                               |     Server    |
 |        |&lt;-(6)--- Protected Resource ---|               |
 +--------+                               +---------------+
</code></pre></div></div>

<p>Let’s take an example to explain the real work flow involved in OAuth 2.</p>

<ol>
  <li>
    <p>Authorization Request<br />
I have taken a new user ‘test’ and request the resource owner <strong>qtc</strong> user.</p>
  </li>
  <li>
    <p>Authorization Grant<br />
By exploiting the contact form user <em>test</em> will grant authorization by user <em>qtc</em> using the <strong>code</strong>.</p>
  </li>
  <li>
    <p>Authorization Grant<br />
Now I am into user <strong>qtc</strong> and requesting access-token presenting an authorization grant to the authorization server.</p>
  </li>
  <li>
    <p>Access Token<br />
Authorization server authenticates the client(<strong>application</strong>) that I have used and validates the authorization grant, and if valid , issues an access token that to user which will be invalid after 600 sec.</p>
  </li>
  <li>
    <p>Access Token<br />
Now client (<strong>application</strong>) request the protected resources using above <em>access_token</em> and will be authenticated by server.</p>
  </li>
  <li>
    <p>Protected Resources  <br />
After verifying the <strong>access_token</strong> and <strong>sessionid</strong> of that user Resource server will provide the protected resources.</p>
  </li>
</ol>

<p>Firstly, let’s talk about the basic topic involved in OAuth 2.</p>

<h4 id="authorization-grant">Authorization Grant</h4>
<p>Authorization grant is a credentials representing the resource owner’s authorization used by the client to obtain an access token. There are four types of grant:- implicit, authorization code, resource owner password credentials and client credentials.</p>

<h4 id="authorization-code">Authorization Code</h4>
<p>The authorization code is obtained by using an authorization server as an intermediary between the client and resource owner.  Instead of requesting authorization directly from the resource owner, the client directs the resource owner to an authorization server which in turn directs the resource owner back to the client with the authorization code.</p>

<h4 id="client-credentials">Client Credentials</h4>
<p>Client credentials can be used as authorization grant  when authorization scope is limited to the protected resources under the control of the client. It is used as authorization grant typically when the client is acting on its own behalf(the client is the resource owner) or requesting to access the protected resources.</p>

<h4 id="access-token">Access token</h4>
<p>Access token are the credentials with the combination of strings used to access protected resources.</p>

<h4 id="client-registration">Client Registration</h4>
<p>Before initiating the protocol, the client registers with the authorization server. The means through which the client registers with the authorization server are beyond the scope of this specification but typically involve end-user interaction with an HTML registration form. When supported by the authorization server, registration can rely on other means for establishing trust and obtaining the required client properties (e.g., redirection URI, client type).</p>

<ol>
  <li>Client Type<br />
Basically there are two client type based on their ability to authenticate securely with authorization with authorization server.
    <ul>
      <li>Confidential Type
   	- Here application is capable of maintaining the confidentiality of their credentials or capable of secure client authentication using other means.</li>
      <li>Public Type
        <ul>
          <li>Here application is incapable of maintaining the confidentiality of their credentials or incapable of secure client authentication using any other means.</li>
        </ul>
      </li>
    </ul>
  </li>
  <li>Redirection URI <br />
It redirects the user-agent of service after an authorization code is granted. For e.g I used my local server to see the response from the request I send in a certain field like contact form(vulnerable field) and finally got the <strong>sessionid</strong>.</li>
</ol>

<p>Below you can see the real work flow involve in Oauth2 and it’s really Oouch…</p>

<p><img src="/public/images/oauth2.jpg" alt="work_flow" /></p>


</div>


<div class="comments">
<div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'gr4n173'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>


</div>




<div class="related">
  <h2>related posts</h2>
  <ul class="related-posts">
    
      <li>
        <h3>
          <a href="/2020/04/06/virseccon.html">
          VirSecCon CTF
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/2020/04/06/virseccon-ctf-steganography.html">
           VirSecCon CTF: Stegagraphy Challenges
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/2020/04/04/htb-registry.html">
          Hack The Box: Registry
          </a>
        </h3>
      </li>
    
  </ul>
</div>




  
  <h2>all tags</h2>
  <div class="tag-cloud"><a href="/tag/.chm/" class="set-1">.chm</a> <a href="/tag/ctf/" class="set-1">CTF</a> <a href="/tag/invoke/" class="set-1">Invoke</a> <a href="/tag/powershell/" class="set-1">Powershell</a> <a href="/tag/re/" class="set-1">RE</a> <a href="/tag/smb/" class="set-1">SMB</a> <a href="/tag/vsc/" class="set-1">VSC</a> <a href="/tag/virseccon/" class="set-1">VirSecCon</a> <a href="/tag/binary_exploitation/" class="set-1">binary_exploitation</a> <a href="/tag/binaryexploitation/" class="set-1">binaryexploitation</a> <a href="/tag/boltcms/" class="set-1">boltcms</a> <a href="/tag/cryptography/" class="set-1">cryptography</a> <a href="/tag/csrftorce/" class="set-1">csrftorce</a> <a href="/tag/ctf/" class="set-2">ctf</a> <a href="/tag/ffuf/" class="set-1">ffuf</a> <a href="/tag/forensics/" class="set-1">forensics</a> <a href="/tag/ftp/" class="set-2">ftp</a> <a href="/tag/fuzz/" class="set-1">fuzz</a> <a href="/tag/gdb/" class="set-1">gdb</a> <a href="/tag/htb/" class="set-5">htb</a> <a href="/tag/introduction/" class="set-1">introduction</a> <a href="/tag/ipv6/" class="set-1">ipv6</a> <a href="/tag/linux/" class="set-4">linux</a> <a href="/tag/linxu/" class="set-1">linxu</a> <a href="/tag/lkm/" class="set-1">lkm</a> <a href="/tag/miscellaneous/" class="set-1">miscellaneous</a> <a href="/tag/nc.exe/" class="set-1">nc.exe</a> <a href="/tag/nephack3/" class="set-1">nephack3</a> <a href="/tag/nishang/" class="set-1">nishang</a> <a href="/tag/oauth2/" class="set-1">oauth2</a> <a href="/tag/pcap/" class="set-1">pcap</a> <a href="/tag/port-forward/" class="set-1">port-forward</a> <a href="/tag/postgres/" class="set-1">postgres</a> <a href="/tag/pwnables/" class="set-1">pwnables</a> <a href="/tag/rce/" class="set-1">rce</a> <a href="/tag/restic-server/" class="set-1">restic-server</a> <a href="/tag/rsync/" class="set-1">rsync</a> <a href="/tag/scripting/" class="set-1">scripting</a> <a href="/tag/server/" class="set-1">server</a> <a href="/tag/sqli/" class="set-2">sqli</a> <a href="/tag/steganography/" class="set-2">steganography</a> <a href="/tag/virseccon/" class="set-1">virseccon</a> <a href="/tag/web/" class="set-1">web</a> <a href="/tag/webshell/" class="set-1">webshell</a> <a href="/tag/welcome/" class="set-1">welcome</a> <a href="/tag/whois/" class="set-1">whois</a> <a href="/tag/windows/" class="set-1">windows</a></div>
  




      </div>
    </main><footer class="site-footer">
  <div class="wrapper">
	  <center><script src="https://www.hackthebox.eu/badge/60443"></script> </center><div class="toggleWrapper">
    <input type="checkbox" class="dn" id="theme-toggle" onclick="modeSwitcher()" checked />
    <label for="theme-toggle" class="toggle">
    <span class="toggle__handler">
      <span class="crater crater--1"></span>
      <span class="crater crater--2"></span>
      <span class="crater crater--3"></span>
    </span>
        <span class="star star--1"></span>
        <span class="star star--2"></span>
        <span class="star star--3"></span>
        <span class="star star--4"></span>
        <span class="star star--5"></span>
        <span class="star star--6"></span>
    </label>
</div>
<script type="text/javascript">
const theme = localStorage.getItem('theme');
if (theme === 'undefined') {
   theme = "dark";
}
if (theme === "dark") {
	document.documentElement.setAttribute('data-theme', 'dark');
} else {
    document.documentElement.setAttribute('data-theme', 'light');
}
const userPrefers = getComputedStyle(document.documentElement).getPropertyValue('content');

function activateDarkTheme() {
    document.getElementById('theme-toggle').checked = true;
    document.documentElement.setAttribute('data-theme', 'dark');
    document.documentElement.classList.add('theme--dark');
    document.documentElement.classList.remove('theme--light');
	document.getElementById("theme-toggle").className = 'light';
	window.localStorage.setItem('theme', 'dark');
}

function activateLightTheme() {
    document.getElementById('theme-toggle').checked = false;
    document.documentElement.setAttribute('data-theme', 'light');
    document.documentElement.classList.add('theme--light');
    document.documentElement.classList.remove('theme--dark');
	document.getElementById("theme-toggle").className = 'dark';
	window.localStorage.setItem('theme', 'light');
}

if (theme === "dark") {
    activateDarkTheme();
} else if (theme === "light") {
    activateLightTheme();
} else if  (userPrefers === "light") {
    activateDarkTheme();
} else {
    activateDarkTheme();
}

function modeSwitcher() {
	let currentMode = document.documentElement.getAttribute('data-theme');
	if (currentMode === "dark") {
	    activateLightTheme();
	} else {
	    activateDarkTheme();
	}
}
</script></div>
  </div>
</footer>


<script>
      window.FontAwesomeConfig = {
        searchPseudoElements: true
      }
    </script>
  </body>

</html>
