<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>VirSecCon CTF: Scripting Challenges | gr4n173</title>
<meta name="generator" content="Jekyll v3.8.6" />
<meta property="og:title" content="VirSecCon CTF: Scripting Challenges" />
<meta name="author" content="gr4n173>" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="I will explain about all the challenges that I solved from scriting category." />
<meta property="og:description" content="I will explain about all the challenges that I solved from scriting category." />
<link rel="canonical" href="http://localhost:4000/2020/04/13/virseccon-ctf-scripting.html" />
<meta property="og:url" content="http://localhost:4000/2020/04/13/virseccon-ctf-scripting.html" />
<meta property="og:site_name" content="gr4n173" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-04-13T00:00:00+05:45" />
<script type="application/ld+json">
{"@type":"BlogPosting","headline":"VirSecCon CTF: Scripting Challenges","dateModified":"2020-04-13T00:00:00+05:45","datePublished":"2020-04-13T00:00:00+05:45","url":"http://localhost:4000/2020/04/13/virseccon-ctf-scripting.html","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/2020/04/13/virseccon-ctf-scripting.html"},"author":{"@type":"Person","name":"gr4n173>"},"description":"I will explain about all the challenges that I solved from scriting category.","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css">
  <link rel="icon" type="image/png" href="/public/images/blackflag.png" /><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="gr4n173" /></head>
<body><div class="site-header">
  <div class="wrapper">
    <a class="site-title" rel="author" href="/">gr4n173<b class="command_prompt"></b><b class="blinking_cursor">_</b></a>
    <span class="social_links">
        <a class="color-cyan-hover" href="https://twitter.com/"><i class="fab fa-twitter"></i></a><a class="color-red-hover" href="https://gr4n173.github.io"><i class="fab fa-itch-io"></i></a><a class="color-purple-hover" href="https://github.com/gr4n173"><i class="fab fa-github"></i></a><a class="color-blue-hover" href="https://www.facebook.com/profile.php?id=100038644863435"><i class="fab fa-facebook"></i></a><a class="color-cyan-hover" href="https://discordapp.com/users/680705408297730058"><i class="fab fa-discord"></i></a><a class="color-red-hover" href="mailto:me.gr4n173@protonmail.com"><i class="fab fa-mailchimp"></i></a><a class="color-cyan-hover" href="https://www.hackthebox.eu/home/users/profile/60443"><i class="fab fa-itch-io"></i></a>
    </span>
  </div>
</div>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <div class="author-box">

<img src="https://gravatar.com/avatar/6691d16a4bf77dcf1f54ee766349682a?s=256" class="author-avatar" />


Hi there, I am a nerd guy who loves everything in between Internet and Security . I reach out to people and teach about CyberSecurity. I like to play with electronics in my spare time so that I can automate my lifestyle . CTF | HTB | Reverse Engineering.

</div>

<div class="post">
  <h1 class="post-title"> VirSecCon CTF: Scripting Challenges</h1>
  
  <div class="post-tags">
      
      <a class="tag" href="/tag/virseccon/">virseccon</a>
      
      <a class="tag" href="/tag/ctf/">ctf</a>
      
      <a class="tag" href="/tag/scripting/">scripting</a>
      
      <a class="tag" href="/tag/python/">python</a>
      
      <a class="tag" href="/tag/selenium/">selenium</a>
      
      <a class="tag" href="/tag/pwn/">pwn</a>
      
  </div>
  
  <div class="post-date">Published on 13 Apr 2020</div>
  
  <div class="post-description"> I will explain about all the challenges that I solved from scriting category. </div>
  
  <h1 id="introduction">Introduction</h1>

<p>Scripting is a programming language for a special run-time that automates the execution of tasks; tasks could alternatively be executed one-by-one by a human operator. We people think there is no any difference in between coding and scripting but there is a saying :-</p>

<p>” All scripting is coding, but not all coding is scripting. “</p>

<p>During VirSecCon CTF there was also Scripting Category which helped me to make my scripting to get the flag. Here I used python scripting and solved the challenges.</p>

<h3 id="1-2048">1. 2048</h3>

<h4 id="description-75">Description [75]</h4>
<p>cGx6aGVscG1l=&gt; plzhelpme (base64 decode)</p>

<p>File: <a href="/public/files/ctf/2048.zip">2048.zip</a></p>

<p>Solution: As challenge is zipped, I unzipped that file and got the 2048 file .</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@gr4n173:# cat 2048
Vm0wd2QyUXlVWGxWV0d4V1YwZDRWMVl3WkRSV01WbDNXa1JTVjAxV2JETlhhMUpUVmpBeFYySkVU
bGhoTVVwVVZtcEJlRll5U2tWVQpiR2hvVFZWd1ZWWnRjRUpsUmxsNVUydFdWUXBpUjJodlZGWldk
MVpXV25SalJVcHNVbXhzTlZVeWRGZFdVWEJwVWpKb2RsWkdXbGRrCk1WcFhWMjVTYWxKVmNITlZi
WGh6VGxaVmVXUkdaRmRWV0VKd1ZXcEtiMlJzV2tkWGJHUnJDazFXY0ZoV01qVlRZV3hLVm1OSVRs
WmkKV0doNlZHeGFWbVZYVWtkYVJtUldWMFZLZDFaWGNFdGlNbEp6VjJ0a1dHSkhVbkpEYXpGWFkw
Wm9WMDFxVmxSWlYzaExWbTFPU1ZScwpXbWtLVjBkb05sWkhlR0ZXYlZaWVZXdGtZVkp0VWxkV01G
WkxaREZhV0dORmRHbE5iRXA2VmpKMGExZEhTa2hWYmtwRVlYcEdXRmt3CldtOVdNREZ4Vm14U1ds
WXphRXhXYlRGUFUxWlNjd3BYYld0TFZqQmtiMDVzV2tobFIwWlhZbFphV1ZaWGRHdFpWa3AwVld4
a1YwMUcKV2t4YVJFWmhWMGRPUm1SSGJFNWlSWEEyVm1wS01HRXhaRWhUYTJoV1ltdHdSVmxZY0Vk
WFJtdDNDbGR0T1ZkTlJFWjRWbTE0VTFkcwpXWHBoUlhoWFlsUkdVRlV4V2xOamQzQllZbGQwVEZa
cVFtdGlNRFZ6VjJ0b2JGSXdXbGhaYkZwaFYxWmFXR1JIZEZwV2EzQXdWbGQ0CmExWXdNVWNLVjJ0
NFlWSkZXbWhXTUdSUFVtMVNTR0pGTldsU1dFRXlWbTF3UzAxSFJYaGFSV2hVWVRKb1YxbHRkSGRT
Vm14WlkwVmsKV0ZKdGRETkRiR1IwVDFaa1RsSkZXalJXYlRFMFZURmtjd3BYV0hCb1VsaG9XRmxz
VWtkVlJsVjRWMnhPYW1RelFsbFpiR1F3VkVaYQpjVkZ0ZEdsTlJGWjZWakowYjJKR1NY........==
</code></pre></div></div>
<p>this indicate the file ASCII text and I tried encoding all many times and I got the flag after 32 decoding. This way I got the 75 points.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@gr4n173:~# cat 2048(32)
LCSC{i_hope_you_didnt_use_asciitohex.com}
</code></pre></div></div>

<h3 id="2-quick-run">2. Quick Run</h3>

<h4 id="description-75-1">Description [75]</h4>
<p>You gotta go fast!</p>

<p>Download the file below.</p>

<p>File: <a href="/public/files/ctf/quick_run.zip">quick_run.zip</a></p>

<p>Solution: As I unzipped that file I got 31 QR-code images so I wrote a simple script in python to decode this image for that I used <code class="highlighter-rouge">pyzbar</code> module <code class="highlighter-rouge">Python Imaging Library(PIL)</code> .</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@gr4n173:~#cat bardecode.py
from PIL import Image
from pyzbar.pyzbar import decode
#!/bin/python3
res = []
for i in range(0,34):
        img = Image.open("quick_run/"+str(i)+".png")
        data = decode(img)
        res.append(data[0].data)
        img.close()
        print(chr(int(data[0].data)))
</code></pre></div></div>
<p>Then I run the script and got the flag with 75 points added.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@gr4n173:~# python3 bardecode.py
L                                                                                                                                                     
L                                                                                                                                                     
S                                                                                                                                                     
{                                                                                                                                                     
z
b
a
r
i
m
g
_
m
a
k
e
s
_
q
r
c
o
d
e
s
_
e
a
s
y
}
</code></pre></div></div>

<h3 id="3-pincode">3. Pincode</h3>

<h4 id="description-75-2">Description [75]</h4>
<p>This service needs a 4 digit pincode to authenticate… can you help me figure it out!??</p>

<p>Connect with:</p>

<p><code class="highlighter-rouge">nc jh2i.com 50031</code></p>

<p>Solution: As the server require 4 digit pincode so only way to enter the digit is from 0000 to 9999 so I wrote a simple script in python.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>roo@gr4n173:~# cat pincode.py
from __future__ import print_function
from pwn import *

pin = 0
while pin &lt; 9999:
    print(pin,end="")
    r = remote('jh2i.com', 50031)
    r.recvuntil(":")
    r.send(str("%04d" % (pin)))
    hashi = r.recvline()
    print(hashi)
    
    r.close()
    if("INCORRECT!" not in hashi):
        break
    pin+=1
</code></pre></div></div>
<p>After 37 step I got the flag and 75 points was added.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>......                                                                                             
[*] Closed connection to jh2i.com port 50031

37[+] Opening connection to jh2i.com on port 50031: Done  
CORRECT! Here is your flag: LLS{for_i_in_0000_to_9999}                                                                                                
                                                                                                                                                      
[*] Closed connection to jh2i.com port 50031 
</code></pre></div></div>

<h3 id="4-loopback">4. Loopback</h3>
<h4 id="description-100">Description [100]</h4>
<p>Hello? Hello? Oh hello! Oh hello!</p>

<p>Download the file below.</p>

<p>File: <a href="/public/files/ctf/loopback.zip">lookback.zip</a></p>

<p>Solution: As I unzipped that file I got the loopback.pcap file so I used the tshark tool to analyze the <code class="highlighter-rouge">.pcap</code> file and wrote a simple python script to analyze the raw file and finally I got the flag.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@gr4n173:~#tshark -r loopback.pcap -T fields -e data &gt; raw.txt

</code></pre></div></div>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@gr4n17:~#cat loopback.py
#!/bin/python3
#python loopback.py &gt; result.txt
from __future__ import print_function
import binascii
import sys
import string
data = open("raw.txt",'r').read().splitlines()

chars = string.ascii_letters + string.digits + string.punctuation

res = ''
i=0
for a in data:
    decoded = a.decode("hex")[8:].strip()
    try:
        if(decoded[0] in chars):
            res+=decoded[0]
        i+=1
    except IndexError as identifier:
        pass

print(res)
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Flag
	 LLSS{icmp_is_the_protocol_for_me}

</code></pre></div></div>

<h3 id="5-grammer">5. Grammer</h3>

<h4 id="description-125">Description [125]</h4>
<p>It’s only one letter away!</p>

<p>Connect with:</p>

<p><code class="highlighter-rouge">nc jh2i.com 50012</code></p>

<p>Solution: As the	server ask for flag I made a simple python script to brute-force the correct flag containing alphabet and symbols.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@gr4n173:~#cat grammer.py
from __future__ import print_function
from pwn import *
import string
flag = "LLS{"
r = remote('jh2i.com', 50012)

chars = string.ascii_letters + string.digits + string.punctuation
print(chars)
is_first = True
while("}" not in flag):
    print("FLAG = ",flag)
    #print("TRY.. ",end="")
    if is_first :
        r.recvuntil("&gt;")
    for char in chars:
        is_first = False
        print(char,end="")
        r.send(flag + char)
        lines = r.recvuntil('&gt;').split("\n")
        #print(lines)
        if("CORRECT" in lines[-3]):
            #print(" OK ",end="")
            flag+=char
            break
        else:
            #print(" FALSE ",end="")
            pass
    print("")

print("FINAL FLAG = ",flag)
</code></pre></div></div>
<p>After running my script I got the flag and 125 points was added.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>........
abcdefghijklm                                                                                                                                         
FLAG =  LLS{bruteforce_with_a_hamm                                                                                                                    
abcde                                                                                                                                                 
FLAG =  LLS{bruteforce_with_a_hamme                                                                                                                   
abcdefghijklmnopqr                                                                                                                                    
FLAG =  LLS{bruteforce_with_a_hammer                                                                                                                  
abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!"#$%&amp;'()*+,-./:;&lt;=&gt;?@[\]^_`{|}                                                         
FINAL FLAG =  LLS{bruteforce_with_a_hammer}                                                                                                           
[*] Closed connection to jh2i.com port 50012
</code></pre></div></div>

<h3 id="6-calc-ul8r">6. CALC-UL8R</h3>

<h4 id="description-150">Description [150]</h4>
<p>Texas Instruments latest new product: you!</p>

<p>Connect with:</p>

<p><code class="highlighter-rouge">nc jh2i.com 50003</code></p>

<p>Solution:- As the challenge name was calculator so I had to enter the answer. But each time I enter the answer question changes randomly so I used the selelnium with a website <a href="https://www.mathpapa.com/">mathhapa.com</a>. To solve this I wrote a simple python script.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>from __future__ import print_function
from pwn import *
from selenium import webdriver
from selenium.webdriver.common.keys import Keys
from selenium.webdriver.chrome.options import Options  
import urllib

url = "https://www.mathpapa.com/algebra-calculator.html?q="
chrome_options = Options()  
chrome_options.add_argument("--headless")  
driver = webdriver.Chrome("/home/bikram/bbek/ctfscripting/chromedriver")
#nc jh2i.com 50003
r = remote('jh2i.com', 50003)
r.recvline()
r.recvline()
r.recvline()
r.recvline()
r.recvline()
r.recvline()
r.recvline()
while True:
    soal = r.recvline()
    print(soal)
    resp = r.recvuntil("= ")
    driver.get(url + urllib.quote(soal.replace("e","x")));
    driver.implicitly_wait(30)
    elements = driver.find_elements_by_css_selector("div#solout3 div.vspacediv fmath mn")
    text = 0
    i=0
    for element in elements:
        if(text==0):
            text = float(element.text)
        else:
            text /= float(element.text)
    if(text.is_integer()):
        text = str(int(text))
    else:
        text = str(float(text))
    r.send(text)
    print("ANSWER",text)
    print(r.recvline())
    

driver.close()   
</code></pre></div></div>

<p>At last this script lend me the flag:-</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>LLS{sympy_to_solve_equations}
</code></pre></div></div>

<p>This way I solved 6 challenges from scripting. Follow my blog to see more writeup of other catageory and I was able to solve more challenge from <code class="highlighter-rouge">Web</code> Challenges which writeup is comming soon. Stay tuned.</p>

<p>#Stay_safe</p>

<p>#COVID-19</p>

</div>


<div class="comments">
<div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'gr4n173'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>


</div>




<div class="related">
  <h2>related posts</h2>
  <ul class="related-posts">
    
      <li>
        <h3>
          <a href="/2020/04/07/virseccon-ctf-steganography.html">
           VirSecCon CTF: Steganography Challenges
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/2020/04/06/virseccon.html">
          CTF: VirSecCon2020
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/2020/04/04/htb-registry.html">
          Hack The Box: Registry
          </a>
        </h3>
      </li>
    
  </ul>
</div>




  
  <h2>all tags</h2>
  <div class="tag-cloud"><a href="/tag/.chm/" class="set-1">.chm</a> <a href="/tag/invoke/" class="set-1">Invoke</a> <a href="/tag/powershell/" class="set-1">Powershell</a> <a href="/tag/re/" class="set-1">RE</a> <a href="/tag/smb/" class="set-1">SMB</a> <a href="/tag/vscctf/" class="set-2">VSCCTF</a> <a href="/tag/virseccon/" class="set-2">VirSecCon</a> <a href="/tag/binaryexploitation/" class="set-1">binaryexploitation</a> <a href="/tag/boltcms/" class="set-1">boltcms</a> <a href="/tag/csrftorce/" class="set-1">csrftorce</a> <a href="/tag/ctf/" class="set-5">ctf</a> <a href="/tag/ffuf/" class="set-1">ffuf</a> <a href="/tag/ftp/" class="set-2">ftp</a> <a href="/tag/fuzz/" class="set-1">fuzz</a> <a href="/tag/gdb/" class="set-1">gdb</a> <a href="/tag/htb/" class="set-5">htb</a> <a href="/tag/introduction/" class="set-1">introduction</a> <a href="/tag/ipv6/" class="set-1">ipv6</a> <a href="/tag/linux/" class="set-4">linux</a> <a href="/tag/linxu/" class="set-1">linxu</a> <a href="/tag/lkm/" class="set-1">lkm</a> <a href="/tag/nc.exe/" class="set-1">nc.exe</a> <a href="/tag/nephack3/" class="set-1">nephack3</a> <a href="/tag/nishang/" class="set-1">nishang</a> <a href="/tag/oauth2/" class="set-1">oauth2</a> <a href="/tag/pcap/" class="set-1">pcap</a> <a href="/tag/port-forward/" class="set-1">port-forward</a> <a href="/tag/postgres/" class="set-1">postgres</a> <a href="/tag/pwn/" class="set-1">pwn</a> <a href="/tag/pwnables/" class="set-1">pwnables</a> <a href="/tag/python/" class="set-1">python</a> <a href="/tag/rce/" class="set-1">rce</a> <a href="/tag/restic-server/" class="set-1">restic-server</a> <a href="/tag/rsync/" class="set-1">rsync</a> <a href="/tag/scripting/" class="set-1">scripting</a> <a href="/tag/selenium/" class="set-1">selenium</a> <a href="/tag/server/" class="set-1">server</a> <a href="/tag/sqli/" class="set-2">sqli</a> <a href="/tag/steganography/" class="set-1">steganography</a> <a href="/tag/virseccon/" class="set-1">virseccon</a> <a href="/tag/webshell/" class="set-1">webshell</a> <a href="/tag/welcome/" class="set-1">welcome</a> <a href="/tag/whois/" class="set-1">whois</a> <a href="/tag/windows/" class="set-1">windows</a></div>
  




      </div>
    </main><footer class="site-footer">
  <div class="wrapper">
	  <center><script src="https://www.hackthebox.eu/badge/60443"></script> </center><div class="toggleWrapper">
    <input type="checkbox" class="dn" id="theme-toggle" onclick="modeSwitcher()" checked />
    <label for="theme-toggle" class="toggle">
    <span class="toggle__handler">
      <span class="crater crater--1"></span>
      <span class="crater crater--2"></span>
      <span class="crater crater--3"></span>
    </span>
        <span class="star star--1"></span>
        <span class="star star--2"></span>
        <span class="star star--3"></span>
        <span class="star star--4"></span>
        <span class="star star--5"></span>
        <span class="star star--6"></span>
    </label>
</div>
<script type="text/javascript">
const theme = localStorage.getItem('theme');
if (theme === 'undefined') {
   theme = "dark";
}
if (theme === "dark") {
	document.documentElement.setAttribute('data-theme', 'dark');
} else {
    document.documentElement.setAttribute('data-theme', 'light');
}
const userPrefers = getComputedStyle(document.documentElement).getPropertyValue('content');

function activateDarkTheme() {
    document.getElementById('theme-toggle').checked = true;
    document.documentElement.setAttribute('data-theme', 'dark');
    document.documentElement.classList.add('theme--dark');
    document.documentElement.classList.remove('theme--light');
	document.getElementById("theme-toggle").className = 'light';
	window.localStorage.setItem('theme', 'dark');
}

function activateLightTheme() {
    document.getElementById('theme-toggle').checked = false;
    document.documentElement.setAttribute('data-theme', 'light');
    document.documentElement.classList.add('theme--light');
    document.documentElement.classList.remove('theme--dark');
	document.getElementById("theme-toggle").className = 'dark';
	window.localStorage.setItem('theme', 'light');
}

if (theme === "dark") {
    activateDarkTheme();
} else if (theme === "light") {
    activateLightTheme();
} else if  (userPrefers === "light") {
    activateDarkTheme();
} else {
    activateDarkTheme();
}

function modeSwitcher() {
	let currentMode = document.documentElement.getAttribute('data-theme');
	if (currentMode === "dark") {
	    activateLightTheme();
	} else {
	    activateDarkTheme();
	}
}
</script></div>
  </div>
</footer>


<script>
      window.FontAwesomeConfig = {
        searchPseudoElements: true
      }
    </script>
  </body>

</html>
